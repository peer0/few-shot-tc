current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../codecomplex_java

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  5
train_df samples: 3911
train_labeled_df samples: 35
train_unlabeled_df samples: 3876
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  1e-05

line 257 => epoch 0
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.157464 f1_test 0.038869 acc_val 0.159509 f1_val 0.039374 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:16
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 1
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 5 acc_test 0.157464 f1_test 0.068941 acc_val 0.147239 f1_val 0.064672 acc_train 0.142857 f1_train 0.065271 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:03
acc_train_cw [0.0, 0.0, 0.6, 0.4, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 2
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.153374 f1_test 0.060883 acc_val 0.145194 f1_val 0.052661 acc_train 0.171429 f1_train 0.069388 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:47
acc_train_cw [0.0, 0.0, 0.2, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 3
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 15 acc_test 0.143149 f1_test 0.036101 acc_val 0.143149 f1_val 0.036101 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:36
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 4
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 20 acc_test 0.153374 f1_test 0.081026 acc_val 0.149284 f1_val 0.072545 acc_train 0.285714 f1_train 0.170238 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:25
acc_train_cw [0.0, 0.0, 0.6, 1.0, 0.0, 0.0, 0.4]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 5
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 25 acc_test 0.161554 f1_test 0.096445 acc_val 0.134969 f1_val 0.080019 acc_train 0.342857 f1_train 0.206710 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:25
acc_train_cw [0.0, 0.0, 0.4, 1.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 6
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 30 acc_test 0.132924 f1_test 0.058239 acc_val 0.126789 f1_val 0.058290 acc_train 0.371429 f1_train 0.348498 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:15
acc_train_cw [0.0, 0.4, 0.2, 0.8, 0.2, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 7
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 35 acc_test 0.169734 f1_test 0.118540 acc_val 0.130879 f1_val 0.089008 acc_train 0.485714 f1_train 0.471051 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:20
acc_train_cw [0.0, 0.8, 0.2, 0.8, 0.4, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 8
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 40 acc_test 0.171779 f1_test 0.117687 acc_val 0.134969 f1_val 0.092849 acc_train 0.514286 f1_train 0.468141 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:10
acc_train_cw [0.0, 0.8, 0.0, 0.8, 0.6, 0.4, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 9
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 45 acc_test 0.184049 f1_test 0.137237 acc_val 0.128834 f1_val 0.099376 acc_train 0.457143 f1_train 0.419045 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:08:10
acc_train_cw [0.0, 0.8, 0.0, 0.6, 0.4, 0.4, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 10
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 50 acc_test 0.171779 f1_test 0.136881 acc_val 0.126789 f1_val 0.113168 acc_train 0.514286 f1_train 0.471769 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:09:12
acc_train_cw [0.0, 0.8, 0.2, 0.6, 0.6, 0.4, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  50
Best model at step:  0
**조기종료됨**
종료된 epoch시점 :  11 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:09:44 (h:mm:ss)
Load model from ./experiment/few_shot/output/codecomplex_java_codebert-base_5_0.7_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240327-001841/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.1574642126789366 
best_test_f1:  0.038869257950530034
Save best record in:  ./experiment/few_shot/log/20240327-001841/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
