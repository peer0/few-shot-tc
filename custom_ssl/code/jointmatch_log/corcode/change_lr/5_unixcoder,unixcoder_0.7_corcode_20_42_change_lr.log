current work directory:  /home/imsuhan22/few-shot-tc/custom_ssl/code

bs for corcod =>  5
Data set -> jointmatch
save_name: 5_['unixcoder', 'unixcoder']_[1e-05, 2e-06]_0.7_jointmatch_20_[42]_{'corcode'}

data_path:  ../data/jointmatch/corcode

There are 1 GPU(s) available.
We will use the GPU- 0 Quadro RTX 8000

**line 107 모델 =>  ['microsoft/unixcoder-base', 'microsoft/unixcoder-base']
**tokenizer type =  ['microsoft/unixcoder-base', 'microsoft/unixcoder-base'] 

n_labeled_per_class:  5
train_df samples: 739
train_labeled_df samples: 25
train_unlabeled_df samples: 714
Check n_smaples_per_class in the original training set:  OrderedDict([(1, 121), (2, 44), (3, 306), (4, 114), (5, 154)])
Check n_smaples_per_class in the labeled training set:  OrderedDict([(1, 5), (2, 5), (3, 5), (4, 5), (5, 5)])
Check n_smaples_per_class in the unlabeled training set:  OrderedDict([(1, 116), (2, 39), (3, 301), (4, 109), (5, 149)])
n_classes:  5

net_arch:  microsoft/unixcoder-base 
lr:  1e-05 
lr_linear:  0.001 


net_arch:  microsoft/unixcoder-base 
lr:  2e-06 
lr_linear:  0.001 

**pseudo_label ->  [0.1663, 0.252, 0.282, 0.1759, 0.1238] **
max =  0.282 | max_idx =  2
**pseudo_label ->  [0.2722, 0.1401, 0.1483, 0.2638, 0.1757] **
max =  0.2722 | max_idx =  0
**pseudo_label ->  [0.2201, 0.2117, 0.1516, 0.1296, 0.2871] **
max =  0.2871 | max_idx =  4
**pseudo_label ->  [0.2546, 0.0935, 0.1302, 0.3083, 0.2135] **
max =  0.3083 | max_idx =  3
**pseudo_label ->  [0.1605, 0.1424, 0.2677, 0.2488, 0.1806] **
max =  0.2677 | max_idx =  2
acc_train_cw(현재 train의 class별 acc) [0.2, 0.8, 0.2, 0.0, 0.8]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan]
loss for labeled data =>  tensor(1.8400, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.8346, device='cuda:0', grad_fn=<NllLossBackward0>)
Save model to ./experiment/jointmatch/output/
Step 5, Time: 0:02:06
Train F1: 0.3214, Val F1: 0.2116, Test F1: 0.1855
Epoch 1/20, Train Acc: 0.4000, Val Acc: 0.2449, Test Acc: 0.2105, Test F1(macro): 0.1855, Total Pseudo-Labels: 0, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.1191, 0.1802, 0.2253, 0.2229, 0.2525] **
max =  0.2525 | max_idx =  4
**pseudo_label ->  [0.1154, 0.1977, 0.2613, 0.2097, 0.2159] **
max =  0.2613 | max_idx =  2
**pseudo_label ->  [0.254, 0.1716, 0.2013, 0.2613, 0.1118] **
max =  0.2613 | max_idx =  3
**pseudo_label ->  [0.1318, 0.1501, 0.3113, 0.1426, 0.2642] **
max =  0.3113 | max_idx =  2
**pseudo_label ->  [0.2072, 0.1863, 0.2682, 0.1499, 0.1885] **
max =  0.2682 | max_idx =  2
acc_train_cw(현재 train의 class별 acc) [0.0, 0.4, 1.0, 1.0, 0.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 1, 0, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 1, 0, 0]
psl_acc(PSL 평가에서의 정확도):  1.0 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, 1.0, nan, nan]
loss for labeled data =>  tensor(1.3347, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.5990, device='cuda:0', grad_fn=<NllLossBackward0>)
Save model to ./experiment/jointmatch/output/
Step 10, Time: 0:04:07
Train F1: 0.4012, Val F1: 0.3146, Test F1: 0.2455
Epoch 2/20, Train Acc: 0.4800, Val Acc: 0.5102, Test Acc: 0.4211, Test F1(macro): 0.2455, Total Pseudo-Labels: 0, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.1671, 0.087, 0.3157, 0.2879, 0.1423] **
max =  0.3157 | max_idx =  2
**pseudo_label ->  [0.2686, 0.1454, 0.1003, 0.1246, 0.3612] **
max =  0.3612 | max_idx =  4
**pseudo_label ->  [0.1442, 0.252, 0.249, 0.1992, 0.1555] **
max =  0.252 | max_idx =  1
**pseudo_label ->  [0.1657, 0.314, 0.1455, 0.1429, 0.2319] **
max =  0.314 | max_idx =  1
**pseudo_label ->  [0.078, 0.1087, 0.0921, 0.567, 0.1541] **
max =  0.567 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [1.0, 0.4, 0.0, 0.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan]
loss for labeled data =>  tensor(0.8294, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.3635, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 15, Time: 0:05:52
Train F1: 0.3472, Val F1: 0.2212, Test F1: 0.2092
Epoch 3/20, Train Acc: 0.4800, Val Acc: 0.2551, Test Acc: 0.2842, Test F1(macro): 0.2092, Total Pseudo-Labels: 0, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.104, 0.3923, 0.0518, 0.344, 0.108] **
max =  0.3923 | max_idx =  1
**pseudo_label ->  [0.199, 0.2949, 0.1225, 0.1207, 0.2629] **
max =  0.2949 | max_idx =  1
**pseudo_label ->  [0.3349, 0.2453, 0.1639, 0.119, 0.1369] **
max =  0.3349 | max_idx =  0
**pseudo_label ->  [0.101, 0.4309, 0.1057, 0.1923, 0.1701] **
max =  0.4309 | max_idx =  1
**pseudo_label ->  [0.1918, 0.3938, 0.2071, 0.0806, 0.1267] **
max =  0.3938 | max_idx =  1
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 5, 351, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 4, 64, 0]
psl_acc(PSL 평가에서의 정확도):  0.191 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, 0.800000011920929, 0.18233618140220642, nan]
loss for labeled data =>  tensor(0.8040, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.3547, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 20, Time: 0:07:37
Train F1: 0.0667, Val F1: 0.0500, Test F1: 0.0752
Epoch 4/20, Train Acc: 0.2000, Val Acc: 0.1429, Test Acc: 0.2316, Test F1(macro): 0.0752, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.0766, 0.0718, 0.058, 0.7503, 0.0433] **
max =  0.7503 | max_idx =  3
**pseudo_label ->  [0.0206, 0.0424, 0.0351, 0.8822, 0.0197] **
max =  0.8822 | max_idx =  3
**pseudo_label ->  [0.0095, 0.0329, 0.0245, 0.901, 0.0321] **
max =  0.901 | max_idx =  3
**pseudo_label ->  [0.0291, 0.0336, 0.0466, 0.8579, 0.0329] **
max =  0.8579 | max_idx =  3
**pseudo_label ->  [0.1344, 0.0625, 0.1127, 0.6536, 0.0368] **
max =  0.6536 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 670, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 106, 0]
psl_acc(PSL 평가에서의 정확도):  0.158 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, 0.1582089513540268, nan]
loss for labeled data =>  tensor(1.7178, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(2.7860, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 25, Time: 0:09:25
Train F1: 0.0667, Val F1: 0.0500, Test F1: 0.0752
Epoch 5/20, Train Acc: 0.2000, Val Acc: 0.1429, Test Acc: 0.2316, Test F1(macro): 0.0752, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 2, Train Data Number: 25

**pseudo_label ->  [0.0508, 0.0157, 0.0108, 0.9059, 0.0167] **
max =  0.9059 | max_idx =  3
**pseudo_label ->  [0.0507, 0.0124, 0.005, 0.9259, 0.0059] **
max =  0.9259 | max_idx =  3
**pseudo_label ->  [0.0184, 0.0576, 0.0108, 0.8978, 0.0153] **
max =  0.8978 | max_idx =  3
**pseudo_label ->  [0.0426, 0.0108, 0.0044, 0.9266, 0.0156] **
max =  0.9266 | max_idx =  3
**pseudo_label ->  [0.015, 0.017, 0.005, 0.9299, 0.0331] **
max =  0.9299 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 669, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 100, 0]
psl_acc(PSL 평가에서의 정확도):  0.149 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, 0.1494768261909485, nan]
loss for labeled data =>  tensor(2.3505, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(2.6137, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 30, Time: 0:11:09
Train F1: 0.0667, Val F1: 0.0500, Test F1: 0.0752
Epoch 6/20, Train Acc: 0.2000, Val Acc: 0.1429, Test Acc: 0.2316, Test F1(macro): 0.0752, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.0177, 0.2015, 0.0192, 0.5607, 0.2009] **
max =  0.5607 | max_idx =  3
**pseudo_label ->  [0.0242, 0.0157, 0.033, 0.9138, 0.0132] **
max =  0.9138 | max_idx =  3
**pseudo_label ->  [0.0292, 0.0246, 0.0489, 0.8825, 0.0147] **
max =  0.8825 | max_idx =  3
**pseudo_label ->  [0.0267, 0.0196, 0.0278, 0.9146, 0.0113] **
max =  0.9146 | max_idx =  3
**pseudo_label ->  [0.0197, 0.0383, 0.0381, 0.8796, 0.0244] **
max =  0.8796 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 639, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 98, 0]
psl_acc(PSL 평가에서의 정확도):  0.153 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, 0.1533646285533905, nan]
loss for labeled data =>  tensor(1.2399, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(2.4701, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 35, Time: 0:12:55
Train F1: 0.0667, Val F1: 0.0500, Test F1: 0.0752
Epoch 7/20, Train Acc: 0.2000, Val Acc: 0.1429, Test Acc: 0.2316, Test F1(macro): 0.0752, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.027, 0.0107, 0.0238, 0.9333, 0.0053] **
max =  0.9333 | max_idx =  3
**pseudo_label ->  [0.0054, 0.02, 0.0072, 0.9166, 0.0508] **
max =  0.9166 | max_idx =  3
**pseudo_label ->  [0.0112, 0.0156, 0.0451, 0.9086, 0.0195] **
max =  0.9086 | max_idx =  3
**pseudo_label ->  [0.0158, 0.0627, 0.0115, 0.8953, 0.0147] **
max =  0.8953 | max_idx =  3
**pseudo_label ->  [0.0136, 0.3758, 0.0195, 0.2947, 0.2964] **
max =  0.3758 | max_idx =  1
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 1, 1, 645, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 1, 0, 104, 0]
psl_acc(PSL 평가에서의 정확도):  0.164 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 1.0, 0.0, 0.16124030947685242, nan]
loss for labeled data =>  tensor(0.8565, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(2.1148, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 40, Time: 0:14:42
Train F1: 0.0667, Val F1: 0.0500, Test F1: 0.0752
Epoch 8/20, Train Acc: 0.2000, Val Acc: 0.1429, Test Acc: 0.2316, Test F1(macro): 0.0752, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.0073, 0.0052, 0.0514, 0.9234, 0.0126] **
max =  0.9234 | max_idx =  3
**pseudo_label ->  [0.0078, 0.0068, 0.0251, 0.9493, 0.0111] **
max =  0.9493 | max_idx =  3
**pseudo_label ->  [0.0198, 0.0131, 0.0308, 0.9297, 0.0067] **
max =  0.9297 | max_idx =  3
**pseudo_label ->  [0.0204, 0.0228, 0.0133, 0.9354, 0.0082] **
max =  0.9354 | max_idx =  3
**pseudo_label ->  [0.0099, 0.0071, 0.0084, 0.9489, 0.0257] **
max =  0.9489 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.0, 0.2, 0.4, 1.0, 0.6]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 0, 3, 639, 0]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 0, 1, 102, 0]
psl_acc(PSL 평가에서의 정확도):  0.16 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, nan, 0.3333333432674408, 0.15962441265583038, nan]
loss for labeled data =>  tensor(0.3783, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(2.0242, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 45, Time: 0:16:30
Train F1: 0.4143, Val F1: 0.0593, Test F1: 0.0933
Epoch 9/20, Train Acc: 0.4400, Val Acc: 0.1531, Test Acc: 0.2421, Test F1(macro): 0.0933, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.0278, 0.0088, 0.0209, 0.9349, 0.0077] **
max =  0.9349 | max_idx =  3
**pseudo_label ->  [0.0044, 0.0097, 0.0055, 0.9746, 0.0058] **
max =  0.9746 | max_idx =  3
**pseudo_label ->  [0.0445, 0.0055, 0.0048, 0.9375, 0.0076] **
max =  0.9375 | max_idx =  3
**pseudo_label ->  [0.0064, 0.01, 0.0122, 0.941, 0.0305] **
max =  0.941 | max_idx =  3
**pseudo_label ->  [0.0053, 0.0107, 0.0067, 0.9737, 0.0036] **
max =  0.9737 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.2, 0.6, 0.4, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 5, 3, 630, 6]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 5, 2, 101, 2]
psl_acc(PSL 평가에서의 정확도):  0.172 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 1.0, 0.6666666865348816, 0.16031746566295624, 0.3333333432674408]
loss for labeled data =>  tensor(0.3052, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.9410, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 50, Time: 0:18:11
Train F1: 0.6239, Val F1: 0.1137, Test F1: 0.0897
Epoch 10/20, Train Acc: 0.6400, Val Acc: 0.1531, Test Acc: 0.2316, Test F1(macro): 0.0897, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.0026, 0.0074, 0.0092, 0.9722, 0.0086] **
max =  0.9722 | max_idx =  3
**pseudo_label ->  [0.0042, 0.0053, 0.0116, 0.9759, 0.003] **
max =  0.9759 | max_idx =  3
**pseudo_label ->  [0.0041, 0.0147, 0.0085, 0.9664, 0.0062] **
max =  0.9664 | max_idx =  3
**pseudo_label ->  [0.021, 0.0673, 0.0193, 0.8379, 0.0546] **
max =  0.8379 | max_idx =  3
**pseudo_label ->  [0.0038, 0.1565, 0.0119, 0.0774, 0.7504] **
max =  0.7504 | max_idx =  4
acc_train_cw(현재 train의 class별 acc) [0.6, 0.6, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 2, 2, 636, 17]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 2, 1, 101, 4]
psl_acc(PSL 평가에서의 정확도):  0.166 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 1.0, 0.5, 0.1588050276041031, 0.23529411852359772]
loss for labeled data =>  tensor(0.2228, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.6694, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 55, Time: 0:19:58
Train F1: 0.8357, Val F1: 0.1570, Test F1: 0.1730
Epoch 11/20, Train Acc: 0.8400, Val Acc: 0.1633, Test Acc: 0.2526, Test F1(macro): 0.1730, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.0073, 0.007, 0.0869, 0.8918, 0.007] **
max =  0.8918 | max_idx =  3
**pseudo_label ->  [0.0246, 0.0486, 0.0067, 0.8872, 0.0328] **
max =  0.8872 | max_idx =  3
**pseudo_label ->  [0.0053, 0.0068, 0.0048, 0.9694, 0.0137] **
max =  0.9694 | max_idx =  3
**pseudo_label ->  [0.0032, 0.0118, 0.0466, 0.9106, 0.0279] **
max =  0.9106 | max_idx =  3
**pseudo_label ->  [0.004, 0.0056, 0.0576, 0.9236, 0.0092] **
max =  0.9236 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.6, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [2, 2, 4, 659, 23]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [2, 2, 2, 104, 6]
psl_acc(PSL 평가에서의 정확도):  0.168 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 1.0, 0.5, 0.1578148752450943, 0.260869562625885]
loss for labeled data =>  tensor(0.0930, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.0368, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 60, Time: 0:21:45
Train F1: 0.8763, Val F1: 0.1570, Test F1: 0.1730
Epoch 12/20, Train Acc: 0.8800, Val Acc: 0.1633, Test Acc: 0.2526, Test F1(macro): 0.1730, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.0025, 0.0104, 0.0486, 0.8688, 0.0697] **
max =  0.8688 | max_idx =  3
**pseudo_label ->  [0.0021, 0.0056, 0.031, 0.958, 0.0032] **
max =  0.958 | max_idx =  3
**pseudo_label ->  [0.0031, 0.0029, 0.0724, 0.9191, 0.0025] **
max =  0.9191 | max_idx =  3
**pseudo_label ->  [0.0012, 0.0239, 0.0206, 0.9142, 0.0401] **
max =  0.9142 | max_idx =  3
**pseudo_label ->  [0.003, 0.0086, 0.0167, 0.9644, 0.0073] **
max =  0.9644 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.6, 0.8, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 1, 2, 654, 26]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 1, 1, 102, 7]
psl_acc(PSL 평가에서의 정확도):  0.164 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 1.0, 0.5, 0.15596330165863037, 0.26923078298568726]
loss for labeled data =>  tensor(0.0661, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(1.2499, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 65, Time: 0:23:31
Train F1: 0.8412, Val F1: 0.1570, Test F1: 0.1730
Epoch 13/20, Train Acc: 0.8400, Val Acc: 0.1633, Test Acc: 0.2526, Test F1(macro): 0.1730, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.0174, 0.0031, 0.0538, 0.9243, 0.0014] **
max =  0.9243 | max_idx =  3
**pseudo_label ->  [0.0148, 0.0068, 0.1108, 0.8627, 0.0049] **
max =  0.8627 | max_idx =  3
**pseudo_label ->  [0.0034, 0.0035, 0.0378, 0.9508, 0.0044] **
max =  0.9508 | max_idx =  3
**pseudo_label ->  [0.0023, 0.0147, 0.3007, 0.6703, 0.0121] **
max =  0.6703 | max_idx =  3
**pseudo_label ->  [0.0023, 0.0217, 0.1465, 0.7606, 0.0688] **
max =  0.7606 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.6, 0.8, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 3, 3, 643, 24]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 3, 3, 103, 7]
psl_acc(PSL 평가에서의 정확도):  0.172 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, 1.0, 1.0, 0.16018661856651306, 0.2916666567325592]
loss for labeled data =>  tensor(0.0738, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.9695, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 70, Time: 0:25:20
Train F1: 0.8412, Val F1: 0.1908, Test F1: 0.1730
Epoch 14/20, Train Acc: 0.8400, Val Acc: 0.1735, Test Acc: 0.2526, Test F1(macro): 0.1730, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.0025, 0.0088, 0.0033, 0.9715, 0.0138] **
max =  0.9715 | max_idx =  3
**pseudo_label ->  [0.0026, 0.0921, 0.0079, 0.0327, 0.8647] **
max =  0.8647 | max_idx =  4
**pseudo_label ->  [0.0061, 0.0401, 0.0091, 0.9431, 0.0015] **
max =  0.9431 | max_idx =  3
**pseudo_label ->  [0.0015, 0.0322, 0.0287, 0.9353, 0.0022] **
max =  0.9353 | max_idx =  3
**pseudo_label ->  [0.004, 0.0082, 0.0245, 0.9575, 0.0058] **
max =  0.9575 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.8, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 4, 8, 630, 28]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 4, 5, 101, 8]
psl_acc(PSL 평가에서의 정확도):  0.176 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, 1.0, 0.625, 0.16031746566295624, 0.2857142984867096]
loss for labeled data =>  tensor(0.1331, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.7212, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 75, Time: 0:27:03
Train F1: 0.9192, Val F1: 0.1999, Test F1: 0.2213
Epoch 15/20, Train Acc: 0.9200, Val Acc: 0.1837, Test Acc: 0.2632, Test F1(macro): 0.2213, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.0049, 0.0049, 0.0148, 0.974, 0.0013] **
max =  0.974 | max_idx =  3
**pseudo_label ->  [0.0014, 0.0114, 0.0225, 0.9516, 0.0131] **
max =  0.9516 | max_idx =  3
**pseudo_label ->  [0.0048, 0.0036, 0.0016, 0.9857, 0.0044] **
max =  0.9857 | max_idx =  3
**pseudo_label ->  [0.0007, 0.011, 0.0114, 0.9665, 0.0104] **
max =  0.9665 | max_idx =  3
**pseudo_label ->  [0.0013, 0.0086, 0.0033, 0.9814, 0.0053] **
max =  0.9814 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.8, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 6, 8, 631, 27]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 6, 5, 103, 8]
psl_acc(PSL 평가에서의 정확도):  0.182 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, 1.0, 0.625, 0.1632329672574997, 0.29629629850387573]
loss for labeled data =>  tensor(0.0244, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.7964, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 80, Time: 0:28:49
Train F1: 0.9192, Val F1: 0.1680, Test F1: 0.2577
Epoch 16/20, Train Acc: 0.9200, Val Acc: 0.1837, Test Acc: 0.2737, Test F1(macro): 0.2577, Total Pseudo-Labels: 3, Correct Pseudo-Labels: 1, Train Data Number: 25

**pseudo_label ->  [0.001, 0.0032, 0.741, 0.2471, 0.0077] **
max =  0.741 | max_idx =  2
**pseudo_label ->  [0.0014, 0.1634, 0.0049, 0.8028, 0.0274] **
max =  0.8028 | max_idx =  3
**pseudo_label ->  [0.001, 0.049, 0.0027, 0.0092, 0.9381] **
max =  0.9381 | max_idx =  4
**pseudo_label ->  [0.0014, 0.0104, 0.0072, 0.9768, 0.0042] **
max =  0.9768 | max_idx =  3
**pseudo_label ->  [0.0033, 0.004, 0.0083, 0.9496, 0.0348] **
max =  0.9496 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.8, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [0, 13, 18, 598, 28]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [0, 12, 9, 100, 8]
psl_acc(PSL 평가에서의 정확도):  0.196 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [nan, 0.9230769276618958, 0.5, 0.16722407937049866, 0.2857142984867096]
loss for labeled data =>  tensor(0.0220, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.5698, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 85, Time: 0:30:36
Train F1: 0.9192, Val F1: 0.1675, Test F1: 0.2417
Epoch 17/20, Train Acc: 0.9200, Val Acc: 0.1735, Test Acc: 0.2737, Test F1(macro): 0.2417, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.0038, 0.0342, 0.0017, 0.9019, 0.0585] **
max =  0.9019 | max_idx =  3
**pseudo_label ->  [0.0007, 0.0057, 0.0092, 0.9829, 0.0015] **
max =  0.9829 | max_idx =  3
**pseudo_label ->  [0.0014, 0.0021, 0.0044, 0.9906, 0.0016] **
max =  0.9906 | max_idx =  3
**pseudo_label ->  [0.0033, 0.0222, 0.0023, 0.9689, 0.0033] **
max =  0.9689 | max_idx =  3
**pseudo_label ->  [0.0024, 0.0146, 0.0011, 0.9804, 0.0015] **
max =  0.9804 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.8, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 16, 5, 630, 29]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 14, 4, 102, 8]
psl_acc(PSL 평가에서의 정확도):  0.189 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 0.875, 0.800000011920929, 0.16190476715564728, 0.27586206793785095]
loss for labeled data =>  tensor(0.0424, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.3981, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 90, Time: 0:32:22
Train F1: 0.9192, Val F1: 0.1680, Test F1: 0.2168
Epoch 18/20, Train Acc: 0.9200, Val Acc: 0.1837, Test Acc: 0.2632, Test F1(macro): 0.2168, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 2, Train Data Number: 25

**pseudo_label ->  [0.0082, 0.0008, 0.0031, 0.9853, 0.0025] **
max =  0.9853 | max_idx =  3
**pseudo_label ->  [0.0009, 0.0054, 0.0038, 0.9871, 0.0028] **
max =  0.9871 | max_idx =  3
**pseudo_label ->  [0.0009, 0.0015, 0.0011, 0.9871, 0.0094] **
max =  0.9871 | max_idx =  3
**pseudo_label ->  [0.0013, 0.0082, 0.0044, 0.9765, 0.0096] **
max =  0.9765 | max_idx =  3
**pseudo_label ->  [0.0008, 0.0178, 0.0015, 0.9763, 0.0035] **
max =  0.9763 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.6, 0.6, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 26, 5, 621, 28]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 19, 4, 100, 8]
psl_acc(PSL 평가에서의 정확도):  0.194 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 0.7307692170143127, 0.800000011920929, 0.1610305905342102, 0.2857142984867096]
loss for labeled data =>  tensor(0.0173, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.4018, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 95, Time: 0:34:05
Train F1: 0.8357, Val F1: 0.1679, Test F1: 0.1936
Epoch 19/20, Train Acc: 0.8400, Val Acc: 0.1837, Test Acc: 0.2526, Test F1(macro): 0.1936, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 0, Train Data Number: 25

**pseudo_label ->  [0.001, 0.0167, 0.0194, 0.9518, 0.011] **
max =  0.9518 | max_idx =  3
**pseudo_label ->  [0.0013, 0.15, 0.0039, 0.0706, 0.7741] **
max =  0.7741 | max_idx =  4
**pseudo_label ->  [0.0009, 0.0102, 0.0049, 0.9809, 0.0031] **
max =  0.9809 | max_idx =  3
**pseudo_label ->  [0.0006, 0.0516, 0.0022, 0.9282, 0.0175] **
max =  0.9282 | max_idx =  3
**pseudo_label ->  [0.0011, 0.0167, 0.0022, 0.9539, 0.0261] **
max =  0.9539 | max_idx =  3
acc_train_cw(현재 train의 class별 acc) [0.8, 0.8, 1.0, 1.0, 1.0]
cw_psl_total_eval(pseudo label 클래스별 총 샘플 수):  [1, 25, 6, 619, 28]
cw_psl_correct_eval(pseudo label 클래스별 맞은 샘플 수):  [1, 18, 3, 101, 8]
psl_acc(PSL 평가에서의 정확도):  0.193 
cw_psl_acc(클래스별 PSL 평가에서의 정확도):  [1.0, 0.7200000286102295, 0.5, 0.16316640377044678, 0.2857142984867096]
loss for labeled data =>  tensor(0.0350, device='cuda:0', grad_fn=<NllLossBackward0>)
loss for labeled data =>  tensor(0.3406, device='cuda:0', grad_fn=<NllLossBackward0>)
Step 100, Time: 0:35:53
Train F1: 0.9192, Val F1: 0.1592, Test F1: 0.2152
Epoch 20/20, Train Acc: 0.9200, Val Acc: 0.1735, Test Acc: 0.2632, Test F1(macro): 0.2152, Total Pseudo-Labels: 4, Correct Pseudo-Labels: 1, Train Data Number: 25


Training complete!
Total training took 0:35:53 (h:mm:ss)
Load model from ./experiment/jointmatch/output/5_['unixcoder', 'unixcoder']_[1e-05, 2e-06]_0.7_jointmatch_20_[42]_{'corcode'}_net0.pth
Load model from ./experiment/jointmatch/output/5_['unixcoder', 'unixcoder']_[1e-05, 2e-06]_0.7_jointmatch_20_[42]_{'corcode'}_net1.pth
Save training statistics in:  ./experiment/jointmatch/log/unixcoder/joint_match//5_['unixcoder', 'unixcoder']_[1e-05, 2e-06]_0.7_jointmatch_20_[42]_{'corcode'}/training_statistics.csv


Best_step:  10 
Best_val_epoch:  2 
best_val_acc:  0.5102040816326531 
best_val_test_acc:  0.42105263157894735 
best_val_test_f1:  0.24546850998463904
Save best record in:  ./experiment/jointmatch/log/unixcoder/joint_match/summary.csv
Save best record in:  ./experiment/jointmatch/log/summary_avgrun.csv
