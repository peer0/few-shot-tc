current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_codebert-base_0.0005_0.7_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0005

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.073826 f1_test 0.034030 acc_val 0.175973 f1_val 0.090057 acc_train 0.285714 f1_train 0.183673 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:13
acc_train_cw(현재 train의 class별 acc) [0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
tensor([[0.1370, 0.1719, 0.1271, 0.1160, 0.1564, 0.1368, 0.1549],
        [0.1710, 0.1483, 0.1377, 0.1214, 0.1521, 0.1052, 0.1643],
        [0.1462, 0.1358, 0.0940, 0.1685, 0.1439, 0.1469, 0.1647],
        [0.1260, 0.1728, 0.1218, 0.1120, 0.1877, 0.1209, 0.1589],
        [0.1561, 0.1939, 0.1221, 0.1196, 0.1363, 0.1228, 0.1492],
        [0.1252, 0.1389, 0.0938, 0.1773, 0.1303, 0.1386, 0.1960],
        [0.1818, 0.1658, 0.1097, 0.1246, 0.1496, 0.1108, 0.1576]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.123043 f1_test 0.085826 acc_val 0.159052 f1_val 0.053515 acc_train 0.571429 f1_train 0.452381 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:04
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0938, 0.1359, 0.1642, 0.1069, 0.1282, 0.2792, 0.0917],
        [0.1142, 0.0998, 0.1071, 0.1452, 0.1563, 0.2614, 0.1159],
        [0.1393, 0.1299, 0.1061, 0.1132, 0.2048, 0.1884, 0.1183],
        [0.0736, 0.1378, 0.1577, 0.0790, 0.1191, 0.3536, 0.0792],
        [0.0848, 0.1501, 0.1421, 0.0889, 0.1611, 0.2961, 0.0769],
        [0.1091, 0.1123, 0.1239, 0.0888, 0.2078, 0.2084, 0.1498],
        [0.0737, 0.0792, 0.1295, 0.1157, 0.1651, 0.3746, 0.0622]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:52
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.2433, 0.1099, 0.1426, 0.1342, 0.1556, 0.0644, 0.1500],
        [0.3735, 0.0731, 0.0700, 0.1264, 0.1447, 0.0394, 0.1729],
        [0.2921, 0.0667, 0.0717, 0.1221, 0.2378, 0.0309, 0.1787],
        [0.2471, 0.1085, 0.1492, 0.1287, 0.1778, 0.0503, 0.1385],
        [0.2546, 0.0874, 0.1284, 0.1370, 0.1748, 0.0624, 0.1554],
        [0.3041, 0.0838, 0.0968, 0.1290, 0.1921, 0.0390, 0.1552],
        [0.2500, 0.1093, 0.1106, 0.1389, 0.1814, 0.0441, 0.1657]],
       device='cuda:0')

line 303 => train data수 16
line 258 => 인스턴스 수 3
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.161074 f1_test 0.070291 acc_val 0.125212 f1_val 0.080665 acc_train 0.250000 f1_train 0.106750 psl_cor 0 psl_totl 9 pslt_global 0.700000  Tim 0:02:41
acc_train_cw(현재 train의 class별 acc) [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [2, 0, 0, 0, 0, 7, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.0 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.0, nan, nan, nan, nan, 0.0, nan]
train batch instace수가 7안됨 pass
tensor([[0.0314, 0.0862, 0.0826, 0.0885, 0.0523, 0.6113, 0.0477],
        [0.0999, 0.0876, 0.0758, 0.0716, 0.1182, 0.4348, 0.1120],
        [0.0795, 0.0879, 0.0871, 0.0777, 0.0858, 0.5008, 0.0811],
        [0.0384, 0.0697, 0.0903, 0.0774, 0.0521, 0.6164, 0.0557],
        [0.0272, 0.0683, 0.0785, 0.0922, 0.0437, 0.6537, 0.0364],
        [0.0467, 0.0518, 0.0505, 0.0544, 0.0475, 0.6730, 0.0761],
        [0.0280, 0.0872, 0.0925, 0.0837, 0.0640, 0.5969, 0.0478]],
       device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 502
line 258 => 인스턴스 수 72
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 6 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.988048 f1_train 0.141998 psl_cor 61 psl_totl 490 pslt_global 0.700000  Tim 0:03:35
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 490, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 61, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.124 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, 0.12448979914188385, nan]
train batch instace수가 7안됨 pass
tensor([[7.6794e-04, 1.4793e-03, 1.0593e-03, 3.6085e-04, 1.1461e-03, 9.9458e-01,
         6.0563e-04],
        [7.7067e-04, 9.1156e-04, 7.1289e-04, 2.1421e-04, 7.5406e-04, 9.9610e-01,
         5.3451e-04],
        [8.1310e-04, 7.8742e-04, 6.5406e-04, 2.5947e-04, 8.7981e-04, 9.9595e-01,
         6.5530e-04],
        [6.7328e-04, 8.7268e-04, 7.3452e-04, 2.8084e-04, 1.0067e-03, 9.9579e-01,
         6.3723e-04],
        [5.2291e-04, 1.0696e-03, 8.6953e-04, 2.8354e-04, 9.0317e-04, 9.9578e-01,
         5.7385e-04],
        [4.3766e-04, 7.5798e-04, 5.4454e-04, 1.4767e-04, 6.2925e-04, 9.9704e-01,
         4.4347e-04],
        [7.9463e-04, 1.1122e-03, 9.4406e-04, 2.9465e-04, 9.3082e-04, 9.9522e-01,
         6.9881e-04]], device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 78 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 431 psl_totl 3844 pslt_global 0.700000  Tim 0:05:11
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 3844, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 431, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.112 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, 0.1121227890253067, nan]
train batch instace수가 7안됨 pass
tensor([[7.9606e-05, 1.0996e-04, 1.1851e-04, 4.9144e-05, 4.2878e-05, 9.9956e-01,
         4.1048e-05],
        [6.0047e-05, 8.0430e-05, 1.4380e-04, 3.4138e-05, 2.7961e-05, 9.9963e-01,
         2.6645e-05],
        [6.9803e-05, 6.7375e-05, 1.2785e-04, 2.7511e-05, 3.3424e-05, 9.9965e-01,
         2.5889e-05],
        [5.5905e-05, 5.6335e-05, 1.6856e-04, 2.5599e-05, 2.0174e-05, 9.9964e-01,
         3.0413e-05],
        [6.4941e-05, 7.1375e-05, 1.2938e-04, 2.4940e-05, 2.3757e-05, 9.9966e-01,
         2.8017e-05],
        [6.9318e-05, 7.3455e-05, 1.6050e-04, 4.4717e-05, 3.2873e-05, 9.9957e-01,
         4.5494e-05],
        [7.1693e-05, 9.7213e-05, 2.2578e-04, 4.9356e-05, 3.9013e-05, 9.9946e-01,
         5.3667e-05]], device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 627 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 431 psl_totl 3844 pslt_global 0.700000  Tim 0:08:17
acc_train_cw(현재 train의 class별 acc) [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 3844, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 431, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.112 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, 0.1121227890253067, nan]
