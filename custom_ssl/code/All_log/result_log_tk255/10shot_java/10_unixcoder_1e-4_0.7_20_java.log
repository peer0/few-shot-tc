current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_unixcoder-base_0.0001_0.7_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.100671 f1_test 0.069870 acc_val 0.297800 f1_val 0.187759 acc_train 0.128571 f1_train 0.099647 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:10
acc_train_cw [0.0, 0.2, 0.4, 0.1, 0.1, 0.0, 0.1]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.199105 f1_test 0.060444 acc_val 0.299492 f1_val 0.135685 acc_train 0.285714 f1_train 0.221166 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:39
acc_train_cw [0.0, 0.4, 0.0, 0.0, 0.9, 0.1, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.120805 f1_test 0.104143 acc_val 0.236887 f1_val 0.177617 acc_train 0.542857 f1_train 0.420106 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:15
acc_train_cw [0.9, 0.0, 0.9, 0.9, 0.0, 0.1, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 530
line 258 => 인스턴스 수 76
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.145414 f1_test 0.152303 acc_val 0.401015 f1_val 0.361189 acc_train 0.964151 f1_train 0.876639 psl_cor 324 psl_totl 460 pslt_global 0.700000  Tim 0:01:45
acc_train_cw [0.993, 0.885, 1.0, 0.923, 0.7, 0.538, 1.0]
cw_psl_eval:  [287, 51, 10, 3, 0, 3, 106] [242, 41, 6, 3, 0, 1, 31]
psl_acc:  0.704 cw_psl_acc:  [0.8432055711746216, 0.8039215803146362, 0.6000000238418579, 1.0, nan, 0.3333333432674408, 0.2924528419971466]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3102
line 258 => 인스턴스 수 444
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 106 acc_test 0.223714 f1_test 0.203584 acc_val 0.291032 f1_val 0.237030 acc_train 0.934558 f1_train 0.822689 psl_cor 1253 psl_totl 3038 pslt_global 0.700000  Tim 0:02:39
acc_train_cw [0.987, 0.862, 0.976, 0.84, 0.143, 0.811, 1.0]
cw_psl_eval:  [660, 331, 539, 308, 4, 365, 831] [400, 205, 168, 147, 2, 73, 258]
psl_acc:  0.412 cw_psl_acc:  [0.6060606241226196, 0.6193353533744812, 0.31168830394744873, 0.47727271914482117, 0.5, 0.20000000298023224, 0.31046929955482483]
train batch instace수가 7안됨 pass

line 303 => train data수 3648
line 258 => 인스턴스 수 522
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 550 acc_test 0.268456 f1_test 0.242363 acc_val 0.309645 f1_val 0.254443 acc_train 0.953947 f1_train 0.815591 psl_cor 1392 psl_totl 3444 pslt_global 0.700000  Tim 0:04:04
acc_train_cw [0.989, 0.899, 0.98, 0.914, 0.0, 0.934, 0.981]
cw_psl_eval:  [620, 390, 544, 440, 0, 576, 874] [392, 233, 153, 209, 0, 115, 290]
psl_acc:  0.404 cw_psl_acc:  [0.6322580575942993, 0.5974358916282654, 0.28125, 0.4749999940395355, nan, 0.1996527761220932, 0.33180779218673706]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 1072 acc_test 0.237136 f1_test 0.220872 acc_val 0.289340 f1_val 0.226520 acc_train 0.939458 f1_train 0.796280 psl_cor 1370 psl_totl 3620 pslt_global 0.700000  Tim 0:05:38
acc_train_cw [0.99, 0.805, 0.982, 0.91, 0.0, 0.845, 0.995]
cw_psl_eval:  [692, 292, 650, 587, 0, 462, 937] [401, 177, 170, 213, 0, 96, 313]
psl_acc:  0.378 cw_psl_acc:  [0.5794797539710999, 0.6061643958091736, 0.26153847575187683, 0.3628620207309723, nan, 0.20779220759868622, 0.33404481410980225]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 1615 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.185575 f1_train 0.044722 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:13
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 2158 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:08:48
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 2701 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:10:23
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 3244 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:11:58
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 3787 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:13:33
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 4330 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:15:08
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 4873 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.177415 f1_train 0.043052 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:16:43
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 5416 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:18:18
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 5959 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:19:53
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 6502 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:21:28
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 7045 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:23:03
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 7588 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:24:38
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 8131 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:26:13
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 8674 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:27:48
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 9217 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:29:23
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 9760 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:30:58
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3799
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 10303 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.255857 f1_train 0.058209 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:32:32
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  10303
Best model at step:  30
**조기종료됨**
종료된 epoch시점 :  25 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:32:50 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_unixcoder-base_0.0001_0.7_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-000615/0/training_statistics.csv

Best_step:  30 
best_test_acc:  0.14541387024608501 
best_test_f1:  0.15230326558180698
Save best record in:  ./experiment/few_shot/log/20240401-000615/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
