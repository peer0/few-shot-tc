current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codebert-base_0.0005_0.7_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0005

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.096197 f1_test 0.031173 acc_val 0.089679 f1_val 0.033271 acc_train 0.114286 f1_train 0.032653 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 296
line 258 => 인스턴스 수 43
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.033784 f1_train 0.009337 psl_cor 23 psl_totl 226 pslt_global 0.700000  Tim 0:00:41
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 226, 0] [0, 0, 0, 0, 0, 23, 0]
psl_acc:  0.102 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10176990926265717, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3804
line 258 => 인스턴스 수 544
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 53 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984227 f1_train 0.141722 psl_cor 419 psl_totl 3745 pslt_global 0.700000  Tim 0:01:31
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3745, 0] [0, 0, 0, 0, 0, 419, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11188250780105591, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 597 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:03:08
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 1146 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:04:45
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 1695 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:06:23
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 2244 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:08:01
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 2793 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:09:38
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 3342 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:11:16
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 3891 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:12:54
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 4440 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:14:31
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 4989 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:16:09
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 5538 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:17:46
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 6087 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:19:24
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 6636 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:21:02
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 7185 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:22:39
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 7734 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:24:17
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 8283 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:25:55
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 8832 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:27:32
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 9381 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:29:10
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 9930 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.700000  Tim 0:30:48
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
Early stopping trigger at step:  9930
Best model at step:  0
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  22 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:31:06 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codebert-base_0.0005_0.7_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240331-205623/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.09619686800894854 
best_test_f1:  0.031173466136183613
Save best record in:  ./experiment/few_shot/log/20240331-205623/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
