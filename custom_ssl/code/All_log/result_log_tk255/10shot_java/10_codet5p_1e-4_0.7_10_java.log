current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codet5p-110m-embedding_0.0001_0.7_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0001

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.223714 f1_test 0.107895 acc_val 0.255499 f1_val 0.096385 acc_train 0.200000 f1_train 0.139276 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:12
acc_train_cw [0.0, 0.1, 0.1, 0.0, 0.7, 0.5, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.085011 f1_test 0.104379 acc_val 0.094755 f1_val 0.122191 acc_train 0.385714 f1_train 0.332813 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:42
acc_train_cw [0.7, 0.0, 0.6, 0.3, 0.1, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.237136 f1_test 0.176792 acc_val 0.194585 f1_val 0.130483 acc_train 0.728571 f1_train 0.709184 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:11
acc_train_cw [1.0, 0.2, 0.9, 0.6, 0.9, 0.6, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.194631 f1_test 0.192551 acc_val 0.253807 f1_val 0.202761 acc_train 0.914286 f1_train 0.911869 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:41
acc_train_cw [1.0, 0.6, 1.0, 0.9, 0.9, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 40 acc_test 0.259508 f1_test 0.239728 acc_val 0.255499 f1_val 0.186032 acc_train 0.957143 f1_train 0.956818 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:11
acc_train_cw [1.0, 1.0, 1.0, 0.8, 0.9, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 50 acc_test 0.275168 f1_test 0.258579 acc_val 0.252115 f1_val 0.211214 acc_train 0.971429 f1_train 0.970522 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:41
acc_train_cw [1.0, 0.8, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 60 acc_test 0.263982 f1_test 0.252903 acc_val 0.294416 f1_val 0.235019 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:11
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 70 acc_test 0.234899 f1_test 0.225216 acc_val 0.319797 f1_val 0.242731 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:45
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 80 acc_test 0.272931 f1_test 0.248377 acc_val 0.284264 f1_val 0.227558 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:20
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 90 acc_test 0.290828 f1_test 0.263793 acc_val 0.311337 f1_val 0.243284 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:50
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 100 acc_test 0.268456 f1_test 0.256051 acc_val 0.309645 f1_val 0.236228 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:19
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 110 acc_test 0.266219 f1_test 0.245628 acc_val 0.321489 f1_val 0.252295 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:49
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 120 acc_test 0.286353 f1_test 0.263938 acc_val 0.306261 f1_val 0.243223 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:24
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.9, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 130 acc_test 0.259508 f1_test 0.248393 acc_val 0.329949 f1_val 0.255744 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:54
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 140 acc_test 0.279642 f1_test 0.262401 acc_val 0.296108 f1_val 0.239060 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:28
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 150 acc_test 0.261745 f1_test 0.248248 acc_val 0.324873 f1_val 0.252015 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:58
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 160 acc_test 0.275168 f1_test 0.256908 acc_val 0.302876 f1_val 0.242975 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:08:28
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 170 acc_test 0.270694 f1_test 0.260499 acc_val 0.326565 f1_val 0.256448 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:08:58
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.9, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 180 acc_test 0.266219 f1_test 0.258249 acc_val 0.304569 f1_val 0.241995 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:09:27
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 190 acc_test 0.281879 f1_test 0.257603 acc_val 0.306261 f1_val 0.243493 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:09:57
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 200 acc_test 0.257271 f1_test 0.251875 acc_val 0.314721 f1_val 0.247262 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:10:27
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 210 acc_test 0.277405 f1_test 0.262160 acc_val 0.309645 f1_val 0.246186 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:10:57
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 220 acc_test 0.266219 f1_test 0.260869 acc_val 0.307953 f1_val 0.243304 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:11:27
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.9, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 230 acc_test 0.272931 f1_test 0.263520 acc_val 0.314721 f1_val 0.248803 acc_train 0.985714 f1_train 0.985678 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:11:57
acc_train_cw [1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  230
Best model at step:  130
**조기종료됨**
종료된 epoch시점 :  25 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:12:14 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codet5p-110m-embedding_0.0001_0.7_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-034731/0/training_statistics.csv

Best_step:  130 
best_test_acc:  0.2595078299776286 
best_test_f1:  0.24839297943121635
Save best record in:  ./experiment/few_shot/log/20240401-034731/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
