current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 5_codet5p-110m-embedding_0.0005_0.7_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  5
train_df samples: 3851
train_labeled_df samples: 35
train_unlabeled_df samples: 3816
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0005

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.100671 f1_test 0.068150 acc_val 0.152284 f1_val 0.115862 acc_train 0.114286 f1_train 0.076190 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.0, 0.0, 0.0, 0.6, 0.0, 0.2, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:41
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.100671 f1_test 0.035615 acc_val 0.000000 f1_val 0.000000 acc_train 0.257143 f1_train 0.114625 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:15
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 15 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:44
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 20 acc_test 0.071588 f1_test 0.060662 acc_val 0.265651 f1_val 0.196710 acc_train 0.257143 f1_train 0.180357 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:14
acc_train_cw [0.6, 0.0, 0.2, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 25 acc_test 0.116331 f1_test 0.073500 acc_val 0.197970 f1_val 0.118373 acc_train 0.314286 f1_train 0.192118 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:48
acc_train_cw [1.0, 0.0, 0.0, 1.0, 0.2, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 30 acc_test 0.017897 f1_test 0.016250 acc_val 0.023689 f1_val 0.019858 acc_train 0.200000 f1_train 0.088599 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:18
acc_train_cw [0.0, 0.0, 0.0, 0.4, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 35 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:47
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 40 acc_test 0.143177 f1_test 0.037166 acc_val 0.204738 f1_val 0.058370 acc_train 0.171429 f1_train 0.078410 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:16
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 45 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:46
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 50 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:15
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 55 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:44
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 60 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:13
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 65 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:43
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 70 acc_test 0.024609 f1_test 0.014757 acc_val 0.103215 f1_val 0.046959 acc_train 0.257143 f1_train 0.118247 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:12
acc_train_cw [0.0, 0.0, 0.0, 0.8, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 75 acc_test 0.098434 f1_test 0.047700 acc_val 0.076142 f1_val 0.045455 acc_train 0.200000 f1_train 0.093117 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:41
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.8, 0.0, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 80 acc_test 0.199105 f1_test 0.134837 acc_val 0.204738 f1_val 0.135730 acc_train 0.542857 f1_train 0.457535 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:08:11
acc_train_cw [1.0, 0.0, 0.0, 0.8, 1.0, 0.6, 0.4]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 85 acc_test 0.185682 f1_test 0.131670 acc_val 0.157360 f1_val 0.099204 acc_train 0.628571 f1_train 0.524202 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:08:40
acc_train_cw [1.0, 0.0, 1.0, 0.6, 0.8, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 90 acc_test 0.076063 f1_test 0.072739 acc_val 0.155668 f1_val 0.097190 acc_train 0.457143 f1_train 0.424170 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:09:09
acc_train_cw [0.6, 0.0, 0.4, 1.0, 0.4, 0.6, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 95 acc_test 0.208054 f1_test 0.111370 acc_val 0.197970 f1_val 0.110466 acc_train 0.457143 f1_train 0.378711 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:09:39
acc_train_cw [1.0, 0.0, 0.0, 0.6, 1.0, 0.2, 0.4]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 100 acc_test 0.082774 f1_test 0.093495 acc_val 0.194585 f1_val 0.116077 acc_train 0.628571 f1_train 0.602172 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:10:08
acc_train_cw [0.8, 0.6, 0.0, 1.0, 0.6, 0.6, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 105 acc_test 0.239374 f1_test 0.162460 acc_val 0.191201 f1_val 0.125663 acc_train 0.542857 f1_train 0.484982 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:10:38
acc_train_cw [1.0, 0.2, 0.8, 0.4, 1.0, 0.4, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 110 acc_test 0.210291 f1_test 0.122266 acc_val 0.096447 f1_val 0.087705 acc_train 0.657143 f1_train 0.594450 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:11:07
acc_train_cw [0.8, 0.0, 0.8, 1.0, 0.2, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 115 acc_test 0.161074 f1_test 0.137118 acc_val 0.170897 f1_val 0.115364 acc_train 0.771429 f1_train 0.760779 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:11:36
acc_train_cw [1.0, 0.4, 0.8, 1.0, 0.4, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 120 acc_test 0.205817 f1_test 0.177325 acc_val 0.170897 f1_val 0.140035 acc_train 0.857143 f1_train 0.859890 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:12:05
acc_train_cw [1.0, 1.0, 0.8, 1.0, 0.6, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  120
Best model at step:  20
**조기종료됨**
종료된 epoch시점 :  26 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:12:23 (h:mm:ss)
Load model from ./experiment/few_shot/output/5_codet5p-110m-embedding_0.0005_0.7_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-225321/0/training_statistics.csv

Best_step:  20 
best_test_acc:  0.07158836689038031 
best_test_f1:  0.060662003761498176
Save best record in:  ./experiment/few_shot/log/20240401-225321/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
