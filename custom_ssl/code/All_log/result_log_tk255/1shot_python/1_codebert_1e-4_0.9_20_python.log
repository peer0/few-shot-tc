current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_codebert-base_0.0001_0.9_20_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.192623 f1_test 0.098918 acc_val 0.228013 f1_val 0.075525 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.043033 f1_test 0.023768 acc_val 0.110749 f1_val 0.030263 acc_train 0.285714 f1_train 0.142857 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:32
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.307377 f1_test 0.118506 acc_val 0.026059 f1_val 0.034555 acc_train 0.571429 f1_train 0.452381 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:56
acc_train_cw [0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.225410 f1_test 0.135937 acc_val 0.133550 f1_val 0.088550 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:20
acc_train_cw [0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.100410 f1_test 0.073924 acc_val 0.136808 f1_val 0.073524 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:44
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.096311 f1_test 0.079041 acc_val 0.175896 f1_val 0.118815 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:09
acc_train_cw [1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.133197 f1_test 0.108993 acc_val 0.156352 f1_val 0.097945 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:33
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 12
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.149590 f1_test 0.123675 acc_val 0.166124 f1_val 0.122483 acc_train 1.000000 f1_train 1.000000 psl_cor 2 psl_totl 5 pslt_global 0.900000  Tim 0:02:57
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 5] [0, 0, 0, 0, 0, 0, 2]
psl_acc:  0.4 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.4000000059604645]
train batch instace수가 7안됨 pass

line 303 => train data수 22
line 258 => 인스턴스 수 4
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 9 acc_test 0.129098 f1_test 0.112513 acc_val 0.192182 f1_val 0.158560 acc_train 1.000000 f1_train 1.000000 psl_cor 6 psl_totl 11 pslt_global 0.900000  Tim 0:03:21
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [8, 2, 0, 1, 0, 0, 0] [5, 0, 0, 1, 0, 0, 0]
psl_acc:  0.545 cw_psl_acc:  [0.625, 0.0, nan, 1.0, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 553
line 258 => 인스턴스 수 79
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 13 acc_test 0.098361 f1_test 0.080569 acc_val 0.201954 f1_val 0.165298 acc_train 0.783002 f1_train 0.592970 psl_cor 187 psl_totl 554 pslt_global 0.900000  Tim 0:03:48
acc_train_cw [1.0, 0.479, 0.86, 0.429, 0.0, 0.915, 1.0]
cw_psl_eval:  [106, 176, 99, 7, 0, 164, 2] [71, 60, 20, 4, 0, 31, 1]
psl_acc:  0.338 cw_psl_acc:  [0.6698113083839417, 0.34090909361839294, 0.20202019810676575, 0.5714285969734192, nan, 0.18902438879013062, 0.5]
**bs에 맞지않음!!!!!**


line 303 => train data수 3550
line 258 => 인스턴스 수 508
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 92 acc_test 0.258197 f1_test 0.160879 acc_val 0.110749 f1_val 0.090353 acc_train 0.964789 f1_train 0.806705 psl_cor 837 psl_totl 3601 pslt_global 0.900000  Tim 0:04:35
acc_train_cw [0.986, 0.996, 0.852, 0.841, 0.0, 0.942, 0.984]
cw_psl_eval:  [852, 1610, 185, 283, 0, 542, 129] [341, 295, 33, 56, 0, 89, 23]
psl_acc:  0.232 cw_psl_acc:  [0.40023472905158997, 0.18322981894016266, 0.1783783733844757, 0.1978798657655716, nan, 0.1642066389322281, 0.1782945692539215]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3764
line 258 => 인스턴스 수 538
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 600 acc_test 0.213115 f1_test 0.131319 acc_val 0.068404 f1_val 0.095833 acc_train 0.861849 f1_train 0.731089 psl_cor 700 psl_totl 3237 pslt_global 0.900000  Tim 0:06:03
acc_train_cw [0.669, 1.0, 0.881, 0.547, 0.0, 0.834, 0.872]
cw_psl_eval:  [539, 1881, 180, 178, 0, 343, 116] [261, 323, 33, 17, 0, 42, 24]
psl_acc:  0.216 cw_psl_acc:  [0.48423004150390625, 0.17171716690063477, 0.18333333730697632, 0.09550561755895615, nan, 0.12244898080825806, 0.2068965584039688]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3875
line 258 => 인스턴스 수 554
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 1138 acc_test 0.202869 f1_test 0.135870 acc_val 0.123779 f1_val 0.119148 acc_train 0.976774 f1_train 0.835890 psl_cor 828 psl_totl 3758 pslt_global 0.900000  Tim 0:07:34
acc_train_cw [0.952, 0.988, 0.946, 0.972, 0.0, 0.992, 0.993]
cw_psl_eval:  [783, 1784, 162, 495, 0, 392, 142] [314, 334, 28, 84, 0, 42, 26]
psl_acc:  0.22 cw_psl_acc:  [0.40102171897888184, 0.18721972405910492, 0.17283950746059418, 0.16969697177410126, nan, 0.1071428582072258, 0.18309858441352844]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 1692 acc_test 0.168033 f1_test 0.122444 acc_val 0.110749 f1_val 0.092768 acc_train 0.968718 f1_train 0.825809 psl_cor 766 psl_totl 3694 pslt_global 0.900000  Tim 0:09:07
acc_train_cw [0.966, 0.977, 0.871, 0.981, 0.0, 0.992, 0.994]
cw_psl_eval:  [865, 1533, 302, 462, 0, 376, 156] [273, 298, 51, 76, 0, 42, 26]
psl_acc:  0.207 cw_psl_acc:  [0.3156069219112396, 0.19439008831977844, 0.16887417435646057, 0.16450215876102448, nan, 0.11170212924480438, 0.1666666716337204]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 2250 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 30 psl_totl 121 pslt_global 0.900000  Tim 0:10:40
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 121, 0, 0, 0, 0, 0] [0, 30, 0, 0, 0, 0, 0]
psl_acc:  0.248 cw_psl_acc:  [nan, 0.24793387949466705, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 2808 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:12:12
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 3366 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:13:45
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 3924 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:15:18
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 4482 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:16:50
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 5040 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:18:23
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 5598 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.445641 f1_train 0.088076 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:19:56
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  5598
Best model at step:  0
**조기종료됨**
종료된 epoch시점 :  22 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:20:14 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codebert-base_0.0001_0.9_20_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-073536/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.19262295081967212 
best_test_f1:  0.09891822583616645
Save best record in:  ./experiment/few_shot/log/20240330-073536/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
