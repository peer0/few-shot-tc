current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_unixcoder-base_0.0005_0.8_10_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0005

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.168033 f1_test 0.111264 acc_val 0.179153 f1_val 0.119752 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.285714 f1_train 0.183673 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:32
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 36
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.388889 f1_train 0.172619 psl_cor 6 psl_totl 29 pslt_global 0.800000  Tim 0:00:56
acc_train_cw [0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [1, 12, 9, 0, 0, 7, 0] [1, 4, 0, 0, 0, 1, 0]
psl_acc:  0.207 cw_psl_acc:  [1.0, 0.3333333432674408, 0.0, nan, nan, 0.1428571492433548, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 47
line 258 => 인스턴스 수 7
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 8 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.617021 f1_train 0.109023 psl_cor 3 psl_totl 21 pslt_global 0.800000  Tim 0:01:20
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 21, 0] [0, 0, 0, 0, 0, 3, 0]
psl_acc:  0.143 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.1428571492433548, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 59
line 258 => 인스턴스 수 9
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 15 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.694915 f1_train 0.117143 psl_cor 1 psl_totl 12 pslt_global 0.800000  Tim 0:01:44
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 12, 0] [0, 0, 0, 0, 0, 1, 0]
psl_acc:  0.083 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.0833333358168602, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2589
line 258 => 인스턴스 수 370
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 24 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.996524 f1_train 0.166376 psl_cor 262 psl_totl 2603 pslt_global 0.800000  Tim 0:02:20
acc_train_cw [0.0, nan, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 2603, 0] [0, 0, 0, 0, 0, 262, 0]
psl_acc:  0.101 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10065308958292007, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 394 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.998975 f1_train 0.199897 psl_cor 425 psl_totl 3967 pslt_global 0.800000  Tim 0:03:34
acc_train_cw [0.0, nan, 0.0, nan, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3967, 0] [0, 0, 0, 0, 0, 425, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10713385790586472, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 952 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.998975 f1_train 0.199897 psl_cor 425 psl_totl 3967 pslt_global 0.800000  Tim 0:05:06
acc_train_cw [0.0, nan, 0.0, nan, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3967, 0] [0, 0, 0, 0, 0, 425, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10713385790586472, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 1510 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.998975 f1_train 0.199897 psl_cor 425 psl_totl 3967 pslt_global 0.800000  Tim 0:06:38
acc_train_cw [0.0, nan, 0.0, nan, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3967, 0] [0, 0, 0, 0, 0, 425, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10713385790586472, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 2068 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.998975 f1_train 0.199897 psl_cor 425 psl_totl 3967 pslt_global 0.800000  Tim 0:08:10
acc_train_cw [0.0, nan, 0.0, nan, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3967, 0] [0, 0, 0, 0, 0, 425, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10713385790586472, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 2626 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.998975 f1_train 0.199897 psl_cor 425 psl_totl 3967 pslt_global 0.800000  Tim 0:09:42
acc_train_cw [0.0, nan, 0.0, nan, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3967, 0] [0, 0, 0, 0, 0, 425, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10713385790586472, nan]
Early stopping trigger at step:  2626
Best model at step:  0
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  12 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:10:00 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0005_0.8_10_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-033012/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.1680327868852459 
best_test_f1:  0.11126401329587658
Save best record in:  ./experiment/few_shot/log/20240330-033012/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
