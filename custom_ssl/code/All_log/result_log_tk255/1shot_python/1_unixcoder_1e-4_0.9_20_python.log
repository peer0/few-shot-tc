current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_unixcoder-base_0.0001_0.9_20_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.168033 f1_test 0.111264 acc_val 0.179153 f1_val 0.119752 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.069672 f1_test 0.072829 acc_val 0.172638 f1_val 0.115141 acc_train 0.571429 f1_train 0.452381 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:32
acc_train_cw [1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 19
line 258 => 인스턴스 수 3
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.206967 f1_test 0.161286 acc_val 0.159609 f1_val 0.142145 acc_train 1.000000 f1_train 1.000000 psl_cor 4 psl_totl 12 pslt_global 0.900000  Tim 0:00:55
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 12] [0, 0, 0, 0, 0, 0, 4]
psl_acc:  0.333 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.3333333432674408]
train batch instace수가 7안됨 pass

line 303 => train data수 212
line 258 => 인스턴스 수 31
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 5 acc_test 0.053279 f1_test 0.051087 acc_val 0.172638 f1_val 0.139326 acc_train 0.952830 f1_train 0.830313 psl_cor 86 psl_totl 208 pslt_global 0.900000  Tim 0:01:21
acc_train_cw [0.972, 0.667, 1.0, 0.75, 0.75, 0.375, 1.0]
cw_psl_eval:  [70, 3, 17, 4, 3, 7, 104] [52, 1, 5, 3, 3, 1, 21]
psl_acc:  0.413 cw_psl_acc:  [0.7428571581840515, 0.3333333432674408, 0.29411765933036804, 0.75, 1.0, 0.1428571492433548, 0.20192307233810425]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 1349
line 258 => 인스턴스 수 193
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 36 acc_test 0.247951 f1_test 0.121686 acc_val 0.104235 f1_val 0.107176 acc_train 0.969607 f1_train 0.822742 psl_cor 425 psl_totl 1353 pslt_global 0.900000  Tim 0:01:53
acc_train_cw [0.955, 0.4, 0.952, 0.6, 0.929, 1.0, 0.993]
cw_psl_eval:  [638, 6, 62, 3, 13, 13, 618] [295, 2, 20, 2, 12, 0, 94]
psl_acc:  0.314 cw_psl_acc:  [0.462382435798645, 0.3333333432674408, 0.32258063554763794, 0.6666666865348816, 0.9230769276618958, 0.0, 0.15210355818271637]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3092
line 258 => 인스턴스 수 442
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 229 acc_test 0.153689 f1_test 0.097998 acc_val 0.130293 f1_val 0.069799 acc_train 0.977038 f1_train 0.727573 psl_cor 706 psl_totl 3097 pslt_global 0.900000  Tim 0:02:48
acc_train_cw [0.997, 0.8, 0.842, 0.5, 0.0, 0.894, 0.999]
cw_psl_eval:  [1265, 6, 89, 3, 0, 349, 1385] [410, 2, 29, 2, 0, 37, 226]
psl_acc:  0.228 cw_psl_acc:  [0.3241106867790222, 0.3333333432674408, 0.3258427083492279, 0.6666666865348816, nan, 0.10601719468832016, 0.16317689418792725]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3149
line 258 => 인스턴스 수 450
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 671 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.490950 f1_train 0.094082 psl_cor 46 psl_totl 294 pslt_global 0.900000  Tim 0:04:06
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 294] [0, 0, 0, 0, 0, 0, 46]
psl_acc:  0.156 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15646257996559143]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 1121 acc_test 0.081967 f1_test 0.038960 acc_val 0.146580 f1_val 0.069691 acc_train 0.841919 f1_train 0.290437 psl_cor 206 psl_totl 1154 pslt_global 0.900000  Tim 0:05:26
acc_train_cw [0.998, 0.0, 0.0, 0.0, 0.0, 0.156, 0.893]
cw_psl_eval:  [294, 0, 4, 0, 0, 96, 760] [80, 0, 0, 0, 0, 15, 111]
psl_acc:  0.179 cw_psl_acc:  [0.27210885286331177, nan, 0.0, nan, nan, 0.15625, 0.14605262875556946]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 1607 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:06:49
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 2093 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:08:12
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 2579 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:09:35
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 3065 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:10:58
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 3551 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:12:21
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 4037 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:13:44
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 4523 acc_test 0.077869 f1_test 0.020641 acc_val 0.091205 f1_val 0.023881 acc_train 0.370032 f1_train 0.077169 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:15:07
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 5009 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:16:30
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 5495 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:17:53
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 5981 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:19:17
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 6467 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:20:40
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 6953 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:22:03
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3397
line 258 => 인스턴스 수 486
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 7439 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.512805 f1_train 0.096850 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:23:26
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  7439
Best model at step:  0
**조기종료됨**
종료된 epoch시점 :  22 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:23:43 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0001_0.9_20_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-104731/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.1680327868852459 
best_test_f1:  0.11126401329587658
Save best record in:  ./experiment/few_shot/log/20240330-104731/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
