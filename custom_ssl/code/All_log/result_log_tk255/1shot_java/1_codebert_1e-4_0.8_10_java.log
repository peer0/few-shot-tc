current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_codebert-base_0.0001_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.136465 f1_test 0.040425 acc_val 0.098139 f1_val 0.038512 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.194631 f1_test 0.055116 acc_val 0.250423 f1_val 0.077817 acc_train 0.428571 f1_train 0.333333 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:39
acc_train_cw [0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.225951 f1_test 0.075210 acc_val 0.260575 f1_val 0.067987 acc_train 0.428571 f1_train 0.333333 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:15
acc_train_cw [0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.172260 f1_test 0.113943 acc_val 0.203046 f1_val 0.159603 acc_train 0.428571 f1_train 0.285714 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:50
acc_train_cw [0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.060403 f1_test 0.049614 acc_val 0.213198 f1_val 0.087477 acc_train 0.571429 f1_train 0.485714 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:18
acc_train_cw [0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.131991 f1_test 0.114880 acc_val 0.203046 f1_val 0.143542 acc_train 0.714286 f1_train 0.642857 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:46
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.098434 f1_test 0.091475 acc_val 0.123519 f1_val 0.097635 acc_train 0.714286 f1_train 0.642857 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:15
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.085011 f1_test 0.093688 acc_val 0.184433 f1_val 0.133488 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:43
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 8 acc_test 0.140940 f1_test 0.119721 acc_val 0.153976 f1_val 0.117591 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:11
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 11
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 9 acc_test 0.143177 f1_test 0.116194 acc_val 0.155668 f1_val 0.113657 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 4 pslt_global 0.800000  Tim 0:04:39
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 2, 0, 0, 0, 2] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, 0.0, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 27
line 258 => 인스턴스 수 4
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 11 acc_test 0.125280 f1_test 0.108380 acc_val 0.133672 f1_val 0.093937 acc_train 1.000000 f1_train 1.000000 psl_cor 2 psl_totl 19 pslt_global 0.800000  Tim 0:05:08
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 11, 0, 0, 0, 8] [0, 0, 1, 0, 0, 0, 1]
psl_acc:  0.105 cw_psl_acc:  [nan, nan, 0.09090909361839294, nan, nan, nan, 0.125]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 1576
line 258 => 인스턴스 수 226
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 15 acc_test 0.147651 f1_test 0.126781 acc_val 0.160745 f1_val 0.102272 acc_train 0.919416 f1_train 0.723480 psl_cor 341 psl_totl 1571 pslt_global 0.800000  Tim 0:05:43
acc_train_cw [0.943, 0.808, 1.0, 0.0, 0.813, 0.462, 0.998]
cw_psl_eval:  [403, 25, 200, 1, 404, 38, 500] [129, 6, 29, 0, 86, 6, 85]
psl_acc:  0.217 cw_psl_acc:  [0.32009926438331604, 0.23999999463558197, 0.14499999582767487, 0.0, 0.21287128329277039, 0.15789473056793213, 0.17000000178813934]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3281
line 258 => 인스턴스 수 469
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 241 acc_test 0.219239 f1_test 0.158617 acc_val 0.165821 f1_val 0.109691 acc_train 0.948491 f1_train 0.764659 psl_cor 704 psl_totl 3220 pslt_global 0.800000  Tim 0:06:48
acc_train_cw [0.975, 0.575, 0.999, 0.0, 0.923, 0.829, 0.985]
cw_psl_eval:  [696, 124, 931, 0, 560, 223, 686] [246, 18, 160, 0, 112, 29, 139]
psl_acc:  0.219 cw_psl_acc:  [0.3534482717514038, 0.14516128599643707, 0.17185822129249573, nan, 0.20000000298023224, 0.1300448477268219, 0.2026239037513733]
Early stopping trigger at step:  241
Best model at step:  2
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  14 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:07:07 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codebert-base_0.0001_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240328-130309/0/training_statistics.csv

Best_step:  2 
best_test_acc:  0.22595078299776286 
best_test_f1:  0.07520986831029607
Save best record in:  ./experiment/few_shot/log/20240328-130309/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
