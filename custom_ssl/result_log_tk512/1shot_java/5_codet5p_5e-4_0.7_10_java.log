current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/code
java_extended_data
save_name: 5_codet5p-110m-embedding_0.0005_0.7_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  5
train_df samples: 3851
train_labeled_df samples: 35
train_unlabeled_df samples: 3816
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0005

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.257271 f1_test 0.084358 acc_val 0.081218 f1_val 0.054519 acc_train 0.114286 f1_train 0.056049 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:13
acc_train_cw(현재 train의 class별 acc) [0.0, 0.4, 0.0, 0.0, 0.0, 0.4, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
loss ->  tensor(1.9264, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9602, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9789, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(2.0403, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(2.0199, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1431, 0.1597, 0.1461, 0.1383, 0.1439, 0.1370, 0.1320],
        [0.1442, 0.1578, 0.1453, 0.1403, 0.1454, 0.1355, 0.1314],
        [0.1436, 0.1586, 0.1457, 0.1402, 0.1450, 0.1371, 0.1297],
        [0.1434, 0.1594, 0.1460, 0.1398, 0.1443, 0.1362, 0.1309],
        [0.1455, 0.1575, 0.1455, 0.1405, 0.1447, 0.1363, 0.1301],
        [0.1405, 0.1588, 0.1476, 0.1420, 0.1452, 0.1365, 0.1294],
        [0.1459, 0.1596, 0.1462, 0.1391, 0.1442, 0.1358, 0.1292]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.171429 f1_train 0.084249 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:07
acc_train_cw(현재 train의 class별 acc) [0.2, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
loss ->  tensor(1.9468, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9303, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(2.0116, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9291, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9669, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1129, 0.1461, 0.1514, 0.1439, 0.1502, 0.1482, 0.1472],
        [0.1111, 0.1442, 0.1540, 0.1460, 0.1496, 0.1490, 0.1462],
        [0.1102, 0.1444, 0.1521, 0.1448, 0.1517, 0.1490, 0.1478],
        [0.1153, 0.1436, 0.1513, 0.1458, 0.1494, 0.1497, 0.1449],
        [0.1177, 0.1404, 0.1528, 0.1463, 0.1489, 0.1497, 0.1442],
        [0.1113, 0.1445, 0.1526, 0.1453, 0.1505, 0.1476, 0.1482],
        [0.1285, 0.1427, 0.1472, 0.1466, 0.1455, 0.1509, 0.1385]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.183445 f1_test 0.114088 acc_val 0.143824 f1_val 0.111179 acc_train 0.371429 f1_train 0.333333 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:05
acc_train_cw(현재 train의 class별 acc) [0.8, 0.0, 1.0, 0.0, 0.2, 0.4, 0.2]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
loss ->  tensor(1.9322, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.8703, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9027, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.8621, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9084, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1003, 0.1544, 0.1669, 0.1299, 0.1560, 0.1294, 0.1631],
        [0.0947, 0.1544, 0.1656, 0.1334, 0.1573, 0.1292, 0.1654],
        [0.0940, 0.1583, 0.1642, 0.1319, 0.1595, 0.1297, 0.1624],
        [0.1097, 0.1544, 0.1603, 0.1300, 0.1524, 0.1271, 0.1661],
        [0.1054, 0.1560, 0.1585, 0.1336, 0.1532, 0.1258, 0.1675],
        [0.0936, 0.1555, 0.1659, 0.1319, 0.1592, 0.1305, 0.1635],
        [0.1077, 0.1565, 0.1612, 0.1293, 0.1532, 0.1280, 0.1642]],
       device='cuda:0')
