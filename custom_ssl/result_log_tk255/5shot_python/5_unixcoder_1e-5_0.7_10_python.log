current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 5_unixcoder-base_1e-05_0.7_10_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  5
train_df samples: 3974
train_labeled_df samples: 35
train_unlabeled_df samples: 3939
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  1e-05

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.170082 f1_test 0.119786 acc_val 0.159609 f1_val 0.097550 acc_train 0.200000 f1_train 0.141657 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:12
acc_train_cw(현재 train의 class별 acc) [0.8, 0.4, 0.0, 0.2, 0.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
tensor([[0.1647, 0.1365, 0.1117, 0.1444, 0.1278, 0.1677, 0.1472],
        [0.2118, 0.1251, 0.1202, 0.1097, 0.1801, 0.1464, 0.1068],
        [0.1958, 0.1454, 0.1441, 0.1023, 0.1692, 0.1388, 0.1045],
        [0.1192, 0.1550, 0.1515, 0.1795, 0.1164, 0.1363, 0.1421],
        [0.1591, 0.0994, 0.1270, 0.1736, 0.1473, 0.2059, 0.0877],
        [0.1397, 0.1224, 0.1517, 0.1502, 0.0912, 0.1976, 0.1471],
        [0.1769, 0.1168, 0.1443, 0.1772, 0.1157, 0.1211, 0.1479]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.161885 f1_test 0.135252 acc_val 0.198697 f1_val 0.131686 acc_train 0.371429 f1_train 0.325170 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:00
acc_train_cw(현재 train의 class별 acc) [0.8, 0.4, 0.0, 0.6, 0.4, 0.4, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
tensor([[0.0932, 0.1524, 0.1417, 0.1018, 0.1910, 0.1901, 0.1297],
        [0.1739, 0.1408, 0.1000, 0.1393, 0.1555, 0.1865, 0.1041],
        [0.1622, 0.0903, 0.2805, 0.1206, 0.1650, 0.0871, 0.0944],
        [0.1207, 0.1842, 0.1509, 0.1174, 0.1079, 0.1465, 0.1723],
        [0.1283, 0.0921, 0.1895, 0.1547, 0.1768, 0.1478, 0.1109],
        [0.1363, 0.1403, 0.1749, 0.1389, 0.1355, 0.1453, 0.1288],
        [0.1003, 0.1325, 0.2648, 0.1334, 0.1024, 0.1175, 0.1491]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.266393 f1_test 0.178283 acc_val 0.143322 f1_val 0.099867 acc_train 0.542857 f1_train 0.539991 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:51
acc_train_cw(현재 train의 class별 acc) [0.8, 0.6, 0.6, 0.4, 0.4, 0.8, 0.2]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0801, 0.0991, 0.1653, 0.1433, 0.1395, 0.1967, 0.1759],
        [0.1519, 0.1432, 0.1085, 0.1523, 0.1567, 0.1294, 0.1580],
        [0.2718, 0.1139, 0.1837, 0.1185, 0.1095, 0.1180, 0.0846],
        [0.1114, 0.2157, 0.0704, 0.0963, 0.1040, 0.2073, 0.1949],
        [0.1095, 0.0949, 0.1260, 0.1466, 0.2108, 0.1667, 0.1456],
        [0.1311, 0.1282, 0.1632, 0.1396, 0.0899, 0.1840, 0.1641],
        [0.0660, 0.2030, 0.1621, 0.1111, 0.1976, 0.1256, 0.1347]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 15 acc_test 0.313525 f1_test 0.209271 acc_val 0.127036 f1_val 0.102562 acc_train 0.714286 f1_train 0.706262 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:36
acc_train_cw(현재 train의 class별 acc) [0.8, 0.8, 1.0, 0.6, 0.4, 1.0, 0.4]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0865, 0.1367, 0.1352, 0.1125, 0.1432, 0.2219, 0.1641],
        [0.1282, 0.1698, 0.1019, 0.1199, 0.1459, 0.1619, 0.1723],
        [0.1688, 0.0652, 0.2544, 0.1839, 0.1364, 0.1008, 0.0906],
        [0.0667, 0.1536, 0.1221, 0.1389, 0.0916, 0.1567, 0.2704],
        [0.1234, 0.1229, 0.1628, 0.1439, 0.1146, 0.1666, 0.1659],
        [0.1290, 0.1667, 0.1288, 0.1123, 0.0834, 0.2248, 0.1550],
        [0.0908, 0.1667, 0.1418, 0.1646, 0.1049, 0.1388, 0.1924]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 20 acc_test 0.362705 f1_test 0.229646 acc_val 0.140065 f1_val 0.095337 acc_train 0.828571 f1_train 0.821681 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:21
acc_train_cw(현재 train의 class별 acc) [1.0, 0.8, 1.0, 0.8, 0.4, 1.0, 0.8]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0692, 0.0984, 0.1054, 0.1632, 0.1444, 0.2504, 0.1690],
        [0.1459, 0.1724, 0.1159, 0.1409, 0.1114, 0.1580, 0.1556],
        [0.2795, 0.0920, 0.1793, 0.1021, 0.1096, 0.1012, 0.1363],
        [0.0841, 0.2255, 0.0729, 0.1342, 0.0719, 0.1434, 0.2681],
        [0.0886, 0.1753, 0.1673, 0.1211, 0.1236, 0.1520, 0.1721],
        [0.1573, 0.1903, 0.0921, 0.1162, 0.0755, 0.2048, 0.1638],
        [0.0997, 0.2520, 0.1162, 0.1046, 0.0936, 0.1323, 0.2016]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 25 acc_test 0.360656 f1_test 0.239234 acc_val 0.140065 f1_val 0.129781 acc_train 0.885714 f1_train 0.883045 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:06
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 0.8, 0.6, 1.0, 0.8]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0808, 0.0686, 0.1775, 0.0852, 0.0878, 0.3227, 0.1774],
        [0.1090, 0.1597, 0.1126, 0.1456, 0.1468, 0.1574, 0.1688],
        [0.2174, 0.0732, 0.2116, 0.1848, 0.1455, 0.0931, 0.0744],
        [0.0622, 0.1943, 0.0737, 0.1202, 0.0763, 0.2066, 0.2667],
        [0.0914, 0.1262, 0.1504, 0.2005, 0.1727, 0.1439, 0.1149],
        [0.0742, 0.2072, 0.0702, 0.0820, 0.0923, 0.3014, 0.1727],
        [0.0885, 0.1524, 0.1315, 0.1740, 0.0788, 0.1163, 0.2585]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 30 acc_test 0.375000 f1_test 0.234162 acc_val 0.136808 f1_val 0.113720 acc_train 0.885714 f1_train 0.883045 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:51
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 0.6, 0.8, 1.0, 0.8]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0862, 0.1003, 0.0787, 0.1303, 0.0883, 0.3005, 0.2157],
        [0.1106, 0.1494, 0.0733, 0.1606, 0.1510, 0.1289, 0.2262],
        [0.3314, 0.0583, 0.2001, 0.1090, 0.1790, 0.0502, 0.0719],
        [0.1138, 0.2986, 0.0743, 0.1159, 0.0601, 0.1840, 0.1533],
        [0.0684, 0.0662, 0.2315, 0.1559, 0.2397, 0.1332, 0.1051],
        [0.1181, 0.2112, 0.0845, 0.0898, 0.0707, 0.2216, 0.2041],
        [0.1132, 0.1525, 0.1599, 0.1192, 0.1589, 0.1606, 0.1358]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 35 acc_test 0.344262 f1_test 0.229183 acc_val 0.159609 f1_val 0.130297 acc_train 0.942857 f1_train 0.942569 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:37
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 0.8]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0890, 0.0971, 0.0866, 0.1709, 0.1647, 0.2132, 0.1785],
        [0.1349, 0.2235, 0.0607, 0.1475, 0.0989, 0.1366, 0.1978],
        [0.4178, 0.0900, 0.1571, 0.1328, 0.0963, 0.0445, 0.0615],
        [0.0809, 0.3052, 0.0501, 0.0913, 0.0453, 0.1132, 0.3141],
        [0.1012, 0.1020, 0.2365, 0.2306, 0.1368, 0.1161, 0.0768],
        [0.1201, 0.1731, 0.0813, 0.1492, 0.0708, 0.2179, 0.1879],
        [0.1207, 0.2268, 0.0877, 0.1098, 0.0934, 0.1127, 0.2490]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 40 acc_test 0.364754 f1_test 0.253006 acc_val 0.250814 f1_val 0.211447 acc_train 0.971429 f1_train 0.971140 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:22
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
tensor([[0.0917, 0.0778, 0.0598, 0.1349, 0.0964, 0.1910, 0.3484],
        [0.0809, 0.2839, 0.0413, 0.1034, 0.1435, 0.1577, 0.1891],
        [0.2668, 0.0766, 0.2822, 0.1668, 0.0899, 0.0635, 0.0542],
        [0.0527, 0.3239, 0.0365, 0.0934, 0.0688, 0.1870, 0.2377],
        [0.1178, 0.0865, 0.1680, 0.1942, 0.2325, 0.1131, 0.0880],
        [0.1093, 0.2319, 0.0567, 0.1271, 0.0757, 0.2417, 0.1576],
        [0.0695, 0.1667, 0.0956, 0.1758, 0.1331, 0.1845, 0.1749]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 45 acc_test 0.399590 f1_test 0.288285 acc_val 0.231270 f1_val 0.177485 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:07:12
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0542, 0.0594, 0.1354, 0.1559, 0.1503, 0.2546, 0.1902],
        [0.1121, 0.2254, 0.0527, 0.1089, 0.1753, 0.1280, 0.1976],
        [0.1969, 0.0530, 0.3352, 0.1656, 0.1476, 0.0629, 0.0388],
        [0.0411, 0.3335, 0.0310, 0.0906, 0.0425, 0.1752, 0.2862],
        [0.0740, 0.0948, 0.1137, 0.1285, 0.2451, 0.1869, 0.1570],
        [0.0566, 0.1004, 0.0769, 0.0900, 0.1107, 0.3608, 0.2045],
        [0.0760, 0.1312, 0.1118, 0.1484, 0.1731, 0.1550, 0.2045]],
       device='cuda:0')

line 303 => train data수 40
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 50 acc_test 0.395492 f1_test 0.293662 acc_val 0.237785 f1_val 0.165680 acc_train 0.975000 f1_train 0.976024 psl_cor 3 psl_totl 6 pslt_global 0.700000  Tim 0:07:57
acc_train_cw(현재 train의 class별 acc) [0.857, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [2, 2, 2, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [1, 0, 2, 0, 0, 0, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.5 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.5, 0.0, 1.0, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
tensor([[0.0587, 0.0552, 0.1314, 0.1402, 0.1817, 0.2218, 0.2109],
        [0.0627, 0.1847, 0.0592, 0.1182, 0.2244, 0.1169, 0.2339],
        [0.2594, 0.0503, 0.2551, 0.2315, 0.1409, 0.0328, 0.0299],
        [0.0578, 0.2568, 0.0390, 0.0953, 0.0802, 0.2040, 0.2670],
        [0.0668, 0.1307, 0.2057, 0.2312, 0.1511, 0.1306, 0.0838],
        [0.0591, 0.1305, 0.0542, 0.0915, 0.0732, 0.3415, 0.2500],
        [0.0452, 0.1149, 0.1012, 0.1632, 0.1234, 0.2078, 0.2443]],
       device='cuda:0')

line 303 => train data수 67
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 56 acc_test 0.387295 f1_test 0.252945 acc_val 0.201954 f1_val 0.169110 acc_train 0.985075 f1_train 0.981722 psl_cor 18 psl_totl 30 pslt_global 0.700000  Tim 0:08:42
acc_train_cw(현재 train의 class별 acc) [1.0, 0.929, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [9, 10, 9, 1, 0, 1, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [8, 4, 4, 1, 0, 1, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.6 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.8888888955116272, 0.4000000059604645, 0.4444444477558136, 1.0, nan, 1.0, nan]
train batch instace수가 7안됨 pass
tensor([[0.0573, 0.0660, 0.1747, 0.0870, 0.1346, 0.2266, 0.2538],
        [0.1178, 0.3737, 0.0409, 0.0882, 0.1289, 0.0888, 0.1617],
        [0.3804, 0.0474, 0.3646, 0.0936, 0.0704, 0.0196, 0.0240],
        [0.0601, 0.5404, 0.0253, 0.0543, 0.0382, 0.0865, 0.1952],
        [0.1286, 0.0747, 0.2992, 0.1490, 0.1589, 0.1241, 0.0656],
        [0.0756, 0.3256, 0.0234, 0.0554, 0.0253, 0.3201, 0.1745],
        [0.0957, 0.1769, 0.1057, 0.1099, 0.0865, 0.1708, 0.2545]],
       device='cuda:0')

line 303 => train data수 108
line 258 => 인스턴스 수 16
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 66 acc_test 0.450820 f1_test 0.298416 acc_val 0.175896 f1_val 0.140230 acc_train 0.981481 f1_train 0.967942 psl_cor 28 psl_totl 48 pslt_global 0.700000  Tim 0:09:36
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 0.833, 1.0, 0.833]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [3, 15, 4, 1, 1, 23, 1]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [3, 8, 3, 1, 0, 13, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.583 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [1.0, 0.5333333611488342, 0.75, 1.0, 0.0, 0.5652173757553101, 0.0]
train batch instace수가 7안됨 pass
tensor([[0.0330, 0.0592, 0.0545, 0.0205, 0.1182, 0.6264, 0.0883],
        [0.0504, 0.4978, 0.0281, 0.0466, 0.0795, 0.1936, 0.1039],
        [0.2853, 0.0812, 0.2867, 0.1357, 0.1182, 0.0618, 0.0310],
        [0.0253, 0.7940, 0.0107, 0.0130, 0.0139, 0.0793, 0.0638],
        [0.1111, 0.0815, 0.3720, 0.0958, 0.1842, 0.1073, 0.0481],
        [0.0335, 0.1296, 0.0264, 0.0286, 0.0448, 0.6961, 0.0410],
        [0.0496, 0.3616, 0.0566, 0.1100, 0.0744, 0.2058, 0.1419]],
       device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 1082
line 258 => 인스턴스 수 155
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 82 acc_test 0.465164 f1_test 0.254077 acc_val 0.107492 f1_val 0.119066 acc_train 0.912200 f1_train 0.837848 psl_cor 445 psl_totl 1045 pslt_global 0.700000  Tim 0:10:38
acc_train_cw(현재 train의 class별 acc) [0.832, 0.941, 0.976, 0.625, 0.688, 1.0, 0.45]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [239, 184, 334, 20, 42, 212, 14]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [147, 85, 88, 7, 13, 96, 9]
psl_acc(이전 PSL 평가에서의 정확도):  0.426 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.6150627732276917, 0.46195653080940247, 0.2634730637073517, 0.3499999940395355, 0.3095238208770752, 0.4528301954269409, 0.6428571343421936]
train batch instace수가 7안됨 pass
tensor([[0.0043, 0.0376, 0.0042, 0.0181, 0.0480, 0.8549, 0.0330],
        [0.0127, 0.7152, 0.0103, 0.0332, 0.1385, 0.0450, 0.0451],
        [0.4630, 0.0024, 0.5060, 0.0124, 0.0120, 0.0018, 0.0024],
        [0.0072, 0.9187, 0.0025, 0.0048, 0.0128, 0.0273, 0.0267],
        [0.0312, 0.0032, 0.8776, 0.0274, 0.0512, 0.0051, 0.0043],
        [0.0026, 0.1525, 0.0021, 0.0093, 0.0100, 0.7762, 0.0473],
        [0.0102, 0.7104, 0.0058, 0.0203, 0.0458, 0.1510, 0.0564]],
       device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 2866
line 258 => 인스턴스 수 410
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 237 acc_test 0.450820 f1_test 0.278740 acc_val 0.110749 f1_val 0.109330 acc_train 0.932310 f1_train 0.850988 psl_cor 948 psl_totl 2806 pslt_global 0.700000  Tim 0:12:17
acc_train_cw(현재 train의 class별 acc) [0.851, 0.932, 0.996, 0.421, 0.758, 0.995, 0.706]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [507, 653, 704, 3, 179, 740, 20]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [268, 221, 175, 2, 52, 221, 9]
psl_acc(이전 PSL 평가에서의 정확도):  0.338 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.5285996198654175, 0.3384379744529724, 0.24857954680919647, 0.6666666865348816, 0.29050278663635254, 0.2986486554145813, 0.44999998807907104]
train batch instace수가 7안됨 pass
tensor([[1.5283e-03, 1.0101e-01, 1.3132e-02, 2.7900e-02, 2.4099e-01, 5.7593e-01,
         3.9517e-02],
        [7.4239e-04, 9.2559e-01, 1.0389e-03, 3.0801e-03, 5.7058e-02, 7.4140e-03,
         5.0746e-03],
        [2.3334e-01, 8.0185e-04, 7.5139e-01, 6.7901e-03, 5.9423e-03, 5.0498e-04,
         1.2239e-03],
        [4.4698e-04, 9.8744e-01, 4.3800e-04, 1.0561e-03, 4.4440e-03, 3.1901e-03,
         2.9850e-03],
        [2.7119e-03, 1.6004e-03, 9.7699e-01, 5.9490e-03, 1.0392e-02, 1.3217e-03,
         1.0303e-03],
        [9.4146e-04, 7.5723e-02, 8.5730e-04, 3.5714e-03, 2.8538e-03, 8.9661e-01,
         1.9439e-02],
        [1.8750e-03, 8.2818e-01, 2.6913e-03, 1.3589e-02, 6.6558e-02, 6.6887e-02,
         2.0219e-02]], device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3582
line 258 => 인스턴스 수 512
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 647 acc_test 0.452869 f1_test 0.299685 acc_val 0.140065 f1_val 0.153089 acc_train 0.939419 f1_train 0.897555 psl_cor 1128 psl_totl 3477 pslt_global 0.700000  Tim 0:14:55
acc_train_cw(현재 train의 class별 acc) [0.903, 0.905, 0.995, 0.6, 0.873, 0.985, 0.8]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [527, 824, 835, 5, 391, 852, 43]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [283, 259, 206, 3, 123, 236, 18]
psl_acc(이전 PSL 평가에서의 정확도):  0.324 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.53700190782547, 0.3143203854560852, 0.24670659005641937, 0.6000000238418579, 0.31457799673080444, 0.27699530124664307, 0.41860464215278625]
train batch instace수가 7안됨 pass
tensor([[9.6626e-04, 2.8664e-02, 1.3564e-03, 5.6886e-03, 4.8815e-01, 4.6303e-01,
         1.2138e-02],
        [1.8182e-03, 8.8157e-01, 6.6472e-04, 1.6086e-03, 1.0581e-01, 4.2558e-03,
         4.2699e-03],
        [4.7487e-01, 6.2403e-04, 5.1188e-01, 5.8003e-03, 5.2729e-03, 3.1199e-04,
         1.2385e-03],
        [3.9970e-04, 9.8934e-01, 1.9733e-04, 7.9220e-04, 4.4293e-03, 1.7713e-03,
         3.0735e-03],
        [5.8723e-03, 1.0308e-03, 9.7370e-01, 4.9856e-03, 1.1735e-02, 3.7686e-04,
         2.3008e-03],
        [2.0796e-04, 2.7219e-03, 1.4960e-04, 4.4860e-04, 6.7667e-04, 9.9388e-01,
         1.9110e-03],
        [4.9108e-04, 9.8239e-01, 2.0322e-04, 6.7777e-04, 1.2198e-02, 1.1610e-03,
         2.8780e-03]], device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3807
line 258 => 인스턴스 수 544
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 1159 acc_test 0.430328 f1_test 0.284992 acc_val 0.140065 f1_val 0.165805 acc_train 0.964276 f1_train 0.921971 psl_cor 1225 psl_totl 3698 pslt_global 0.700000  Tim 0:17:54
acc_train_cw(현재 train의 class별 acc) [0.957, 0.967, 0.988, 0.667, 0.948, 0.967, 0.833]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [595, 942, 806, 4, 494, 802, 55]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [321, 281, 206, 3, 157, 237, 20]
psl_acc(이전 PSL 평가에서의 정확도):  0.331 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.5394958257675171, 0.29830148816108704, 0.25558313727378845, 0.75, 0.3178137540817261, 0.2955112159252167, 0.3636363744735718]
train batch instace수가 7안됨 pass
tensor([[2.8221e-04, 7.9534e-03, 1.7007e-03, 4.5129e-03, 8.6356e-01, 1.1858e-01,
         3.4201e-03],
        [3.6284e-04, 6.2214e-01, 1.7405e-03, 2.6024e-03, 3.6881e-01, 2.4011e-03,
         1.9354e-03],
        [6.3676e-01, 1.5748e-04, 3.5582e-01, 3.3436e-03, 2.9200e-03, 2.1081e-04,
         7.8710e-04],
        [5.6966e-04, 9.8932e-01, 1.7052e-04, 7.1832e-04, 4.8429e-03, 1.3092e-03,
         3.0643e-03],
        [2.5916e-03, 6.3855e-04, 9.0014e-01, 3.8825e-03, 9.0805e-02, 7.4534e-04,
         1.1924e-03],
        [4.6995e-04, 3.8958e-02, 2.8679e-04, 8.3449e-04, 1.6188e-03, 9.5319e-01,
         4.6399e-03],
        [3.3361e-04, 9.6446e-01, 7.1395e-04, 1.0329e-03, 3.0787e-02, 1.2674e-03,
         1.4051e-03]], device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3869
line 258 => 인스턴스 수 553
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 1703 acc_test 0.405738 f1_test 0.267817 acc_val 0.156352 f1_val 0.185613 acc_train 0.968984 f1_train 0.938569 psl_cor 1237 psl_totl 3805 pslt_global 0.700000  Tim 0:20:59
acc_train_cw(현재 train의 class별 acc) [0.976, 0.954, 0.996, 0.667, 0.953, 0.973, 0.902]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [613, 943, 825, 4, 583, 794, 43]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [328, 276, 206, 3, 169, 235, 20]
psl_acc(이전 PSL 평가에서의 정확도):  0.325 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.5350733995437622, 0.2926829159259796, 0.24969696998596191, 0.75, 0.2898799180984497, 0.29596978425979614, 0.4651162922382355]
train batch instace수가 7안됨 pass
tensor([[1.1275e-04, 2.7308e-04, 7.8037e-04, 5.7047e-04, 9.9117e-01, 6.6127e-03,
         4.8371e-04],
        [8.5186e-04, 4.5611e-01, 2.2419e-03, 1.9795e-03, 5.3127e-01, 3.5212e-03,
         4.0252e-03],
        [9.2661e-01, 1.3083e-04, 7.1159e-02, 9.6553e-04, 6.9330e-04, 6.2107e-05,
         3.7722e-04],
        [9.5637e-05, 9.9784e-01, 4.1451e-05, 1.6863e-04, 7.2701e-04, 3.3022e-04,
         7.9968e-04],
        [1.1966e-03, 9.5790e-05, 9.9618e-01, 8.3521e-04, 1.2849e-03, 7.4825e-05,
         3.3753e-04],
        [1.2732e-04, 1.7161e-03, 6.7032e-05, 2.7019e-04, 4.7220e-04, 9.9577e-01,
         1.5818e-03],
        [4.2867e-04, 9.5130e-01, 2.2127e-04, 9.4904e-04, 3.9621e-02, 5.6239e-03,
         1.8570e-03]], device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3890
line 258 => 인스턴스 수 556
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 2256 acc_test 0.366803 f1_test 0.254400 acc_val 0.166124 f1_val 0.185287 acc_train 0.951414 f1_train 0.938518 psl_cor 1244 psl_totl 3782 pslt_global 0.700000  Tim 0:24:06
acc_train_cw(현재 train의 class별 acc) [0.973, 0.888, 0.992, 0.8, 0.943, 0.973, 0.9]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [671, 833, 813, 5, 633, 783, 44]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [344, 259, 209, 3, 172, 238, 19]
psl_acc(이전 PSL 평가에서의 정확도):  0.329 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.5126676559448242, 0.31092438101768494, 0.2570725679397583, 0.6000000238418579, 0.2717219591140747, 0.3039591312408447, 0.4318181872367859]
Early stopping trigger at step:  2256
Best model at step:  40
**조기종료됨**

가장 높은 acc_val :  0.250814332247557
tensor([[9.2119e-05, 2.4809e-04, 5.0846e-04, 5.0731e-04, 9.9028e-01, 7.5008e-03,
         8.6828e-04],
        [4.4581e-04, 2.4998e-01, 1.6303e-03, 1.7046e-03, 7.4319e-01, 1.3853e-03,
         1.6659e-03],
        [9.5920e-01, 1.5940e-04, 3.8530e-02, 5.0532e-04, 9.4859e-04, 7.0960e-05,
         5.8265e-04],
        [1.0391e-04, 9.9749e-01, 4.6201e-05, 2.0548e-04, 8.6607e-04, 4.5753e-04,
         8.3445e-04],
        [1.1063e-03, 9.8256e-05, 9.9397e-01, 5.8534e-04, 3.9066e-03, 6.8389e-05,
         2.6927e-04],
        [1.5829e-04, 1.7344e-03, 6.0934e-05, 2.4548e-04, 7.0224e-04, 9.9634e-01,
         7.5745e-04],
        [3.8029e-04, 9.7542e-01, 1.0746e-04, 5.6665e-04, 2.0645e-02, 1.3229e-03,
         1.5532e-03]], device='cuda:0')
**bs에 맞지않음!!!!!**

acc_val 증가안된 epoch시점 :  9
early_stop_flag

Training complete!
Total training took 0:24:44 (h:mm:ss)
Load model from ./experiment/few_shot/output/5_unixcoder-base_1e-05_0.7_10_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240403-233803/0/training_statistics.csv

Best_step:  40 
best_test_acc:  0.36475409836065575 
best_test_f1:  0.2530056596244895
Save best record in:  ./experiment/few_shot/log/20240403-233803/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
