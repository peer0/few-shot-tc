current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 5_codet5p-110m-embedding_0.0001_0.8_10_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  5
train_df samples: 3974
train_labeled_df samples: 35
train_unlabeled_df samples: 3939
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0001

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.120902 f1_test 0.038092 acc_val 0.019544 f1_val 0.015444 acc_train 0.028571 f1_train 0.009852 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:08
acc_train_cw [0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:33
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.237705 f1_test 0.167554 acc_val 0.091205 f1_val 0.057981 acc_train 0.628571 f1_train 0.570201 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:59
acc_train_cw [1.0, 1.0, 0.8, 0.0, 0.6, 0.8, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 15 acc_test 0.342213 f1_test 0.216642 acc_val 0.100977 f1_val 0.104796 acc_train 0.800000 f1_train 0.801088 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:28
acc_train_cw [0.8, 1.0, 1.0, 0.6, 0.6, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 20 acc_test 0.299180 f1_test 0.183137 acc_val 0.120521 f1_val 0.098207 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:55
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 25 acc_test 0.211066 f1_test 0.155115 acc_val 0.169381 f1_val 0.144421 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:25
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 30 acc_test 0.206967 f1_test 0.176921 acc_val 0.166124 f1_val 0.155339 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:51
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 35 acc_test 0.202869 f1_test 0.152704 acc_val 0.143322 f1_val 0.121966 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:16
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 40 acc_test 0.219262 f1_test 0.165661 acc_val 0.169381 f1_val 0.150234 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:41
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 45 acc_test 0.186475 f1_test 0.151184 acc_val 0.185668 f1_val 0.158594 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:06
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 50 acc_test 0.180328 f1_test 0.141216 acc_val 0.172638 f1_val 0.156898 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:36
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 55 acc_test 0.172131 f1_test 0.138036 acc_val 0.166124 f1_val 0.143592 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:02
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 60 acc_test 0.174180 f1_test 0.140322 acc_val 0.166124 f1_val 0.143619 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:27
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 65 acc_test 0.174180 f1_test 0.141077 acc_val 0.172638 f1_val 0.153557 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:52
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 70 acc_test 0.178279 f1_test 0.138566 acc_val 0.169381 f1_val 0.153022 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:06:17
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 75 acc_test 0.170082 f1_test 0.138144 acc_val 0.179153 f1_val 0.161352 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:06:42
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 80 acc_test 0.192623 f1_test 0.148460 acc_val 0.192182 f1_val 0.170153 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:07:07
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 85 acc_test 0.209016 f1_test 0.156437 acc_val 0.166124 f1_val 0.150512 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:07:37
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 90 acc_test 0.184426 f1_test 0.143092 acc_val 0.162866 f1_val 0.148513 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:08:03
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 95 acc_test 0.184426 f1_test 0.144453 acc_val 0.192182 f1_val 0.170936 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:08:28
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 100 acc_test 0.209016 f1_test 0.153338 acc_val 0.179153 f1_val 0.165071 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:08:53
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 105 acc_test 0.192623 f1_test 0.145066 acc_val 0.179153 f1_val 0.164891 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:09:18
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 110 acc_test 0.194672 f1_test 0.146344 acc_val 0.182410 f1_val 0.164431 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:09:44
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 115 acc_test 0.198770 f1_test 0.146739 acc_val 0.182410 f1_val 0.166473 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:10:09
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 120 acc_test 0.198770 f1_test 0.149054 acc_val 0.185668 f1_val 0.167894 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:10:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 26 Step 125 acc_test 0.194672 f1_test 0.149378 acc_val 0.188925 f1_val 0.171771 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:10:59
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 27 Step 130 acc_test 0.194672 f1_test 0.148907 acc_val 0.185668 f1_val 0.164736 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:11:24
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  130
Best model at step:  80
**조기종료됨**
종료된 epoch시점 :  28 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:11:42 (h:mm:ss)
Load model from ./experiment/few_shot/output/5_codet5p-110m-embedding_0.0001_0.8_10_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240402-104554/0/training_statistics.csv

Best_step:  80 
best_test_acc:  0.19262295081967212 
best_test_f1:  0.1484604818687408
Save best record in:  ./experiment/few_shot/log/20240402-104554/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
