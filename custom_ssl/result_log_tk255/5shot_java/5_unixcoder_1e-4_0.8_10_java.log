current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 5_unixcoder-base_0.0001_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  5
train_df samples: 3851
train_labeled_df samples: 35
train_unlabeled_df samples: 3816
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.038031 f1_test 0.031177 acc_val 0.074450 f1_val 0.049749 acc_train 0.171429 f1_train 0.108277 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:10
acc_train_cw [0.2, 0.4, 0.0, 0.0, 0.0, 0.0, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.118568 f1_test 0.051082 acc_val 0.099831 f1_val 0.048096 acc_train 0.400000 f1_train 0.308865 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:39
acc_train_cw [1.0, 0.8, 0.4, 0.0, 0.0, 0.0, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.353468 f1_test 0.161924 acc_val 0.148900 f1_val 0.118485 acc_train 0.771429 f1_train 0.714868 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:12
acc_train_cw [1.0, 1.0, 1.0, 0.0, 1.0, 0.8, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 15 acc_test 0.234899 f1_test 0.137716 acc_val 0.181049 f1_val 0.167123 acc_train 0.742857 f1_train 0.741084 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:46
acc_train_cw [0.8, 1.0, 0.6, 0.4, 1.0, 0.8, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 61
line 258 => 인스턴스 수 9
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 20 acc_test 0.248322 f1_test 0.150405 acc_val 0.255499 f1_val 0.202717 acc_train 0.918033 f1_train 0.898066 psl_cor 16 psl_totl 26 pslt_global 0.800000  Tim 0:02:19
acc_train_cw [0.947, 1.0, 1.0, 0.8, 1.0, 0.8, 0.714]
cw_psl_eval:  [14, 5, 4, 0, 1, 0, 2] [14, 0, 0, 0, 0, 0, 2]
psl_acc:  0.615 cw_psl_acc:  [1.0, 0.0, 0.0, nan, 0.0, nan, 1.0]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 303 => train data수 536
line 258 => 인스턴스 수 77
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 29 acc_test 0.192394 f1_test 0.150622 acc_val 0.228426 f1_val 0.196070 acc_train 0.964552 f1_train 0.939923 psl_cor 191 psl_totl 500 pslt_global 0.800000  Tim 0:02:55
acc_train_cw [0.963, 0.99, 0.936, 0.857, 0.986, 1.0, 0.971]
cw_psl_eval:  [103, 99, 168, 2, 66, 33, 29] [85, 27, 45, 0, 11, 5, 18]
psl_acc:  0.382 cw_psl_acc:  [0.8252426981925964, 0.27272728085517883, 0.2678571343421936, 0.0, 0.1666666716337204, 0.1515151560306549, 0.6206896305084229]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2928
line 258 => 인스턴스 수 419
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 106 acc_test 0.156600 f1_test 0.103369 acc_val 0.260575 f1_val 0.167980 acc_train 0.958333 f1_train 0.949554 psl_cor 752 psl_totl 2872 pslt_global 0.800000  Tim 0:03:43
acc_train_cw [0.958, 0.937, 0.983, 0.931, 0.968, 0.928, 0.903]
cw_psl_eval:  [607, 307, 758, 326, 652, 155, 67] [263, 125, 151, 45, 119, 23, 26]
psl_acc:  0.262 cw_psl_acc:  [0.4332784116268158, 0.40716612339019775, 0.19920843839645386, 0.1380368024110794, 0.18251533806324005, 0.1483870893716812, 0.38805970549583435]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3537
line 258 => 인스턴스 수 506
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 525 acc_test 0.190157 f1_test 0.130053 acc_val 0.184433 f1_val 0.126141 acc_train 0.959853 f1_train 0.960765 psl_cor 791 psl_totl 3239 pslt_global 0.800000  Tim 0:05:12
acc_train_cw [0.991, 0.92, 0.911, 0.986, 0.986, 0.95, 0.97]
cw_psl_eval:  [712, 275, 676, 501, 676, 338, 61] [274, 121, 139, 75, 109, 49, 24]
psl_acc:  0.244 cw_psl_acc:  [0.3848314583301544, 0.4399999976158142, 0.20562130212783813, 0.1497005969285965, 0.16124260425567627, 0.14497041702270508, 0.39344263076782227]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3728
line 258 => 인스턴스 수 533
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 1031 acc_test 0.194631 f1_test 0.134512 acc_val 0.196277 f1_val 0.135092 acc_train 0.970225 f1_train 0.972506 psl_cor 848 psl_totl 3502 pslt_global 0.800000  Tim 0:06:44
acc_train_cw [0.98, 0.965, 0.946, 0.98, 0.99, 0.954, 0.984]
cw_psl_eval:  [799, 304, 728, 495, 711, 406, 59] [293, 123, 150, 74, 120, 65, 23]
psl_acc:  0.242 cw_psl_acc:  [0.3667083978652954, 0.40460526943206787, 0.20604395866394043, 0.1494949460029602, 0.16877637803554535, 0.16009852290153503, 0.38983049988746643]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3796
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 1564 acc_test 0.192394 f1_test 0.133604 acc_val 0.197970 f1_val 0.135974 acc_train 0.978662 f1_train 0.972970 psl_cor 864 psl_totl 3577 pslt_global 0.800000  Tim 0:08:19
acc_train_cw [0.967, 0.953, 0.992, 0.99, 0.985, 0.973, 0.961]
cw_psl_eval:  [772, 327, 822, 510, 663, 437, 46] [276, 135, 169, 85, 113, 70, 16]
psl_acc:  0.242 cw_psl_acc:  [0.3575129508972168, 0.4128440320491791, 0.20559610426425934, 0.1666666716337204, 0.17043741047382355, 0.16018307209014893, 0.3478260934352875]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3819
line 258 => 인스턴스 수 546
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 2107 acc_test 0.185682 f1_test 0.129985 acc_val 0.186125 f1_val 0.132924 acc_train 0.985860 f1_train 0.986779 psl_cor 876 psl_totl 3661 pslt_global 0.800000  Tim 0:09:55
acc_train_cw [0.989, 0.988, 0.97, 0.992, 0.99, 0.996, 0.984]
cw_psl_eval:  [848, 335, 778, 521, 667, 453, 59] [290, 137, 152, 86, 116, 72, 23]
psl_acc:  0.239 cw_psl_acc:  [0.3419811427593231, 0.4089552164077759, 0.19537274539470673, 0.1650671809911728, 0.17391304671764374, 0.1589404046535492, 0.38983049988746643]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3830
line 258 => 인스턴스 수 548
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 2653 acc_test 0.190157 f1_test 0.132233 acc_val 0.201354 f1_val 0.145832 acc_train 0.985901 f1_train 0.985347 psl_cor 890 psl_totl 3713 pslt_global 0.800000  Tim 0:11:32
acc_train_cw [0.984, 0.981, 0.992, 0.99, 0.991, 0.973, 0.984]
cw_psl_eval:  [832, 355, 789, 508, 657, 514, 58] [286, 143, 157, 86, 115, 80, 23]
psl_acc:  0.24 cw_psl_acc:  [0.34375, 0.40281689167022705, 0.19898605346679688, 0.16929133236408234, 0.17503805458545685, 0.15564201772212982, 0.3965517282485962]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3838
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 3201 acc_test 0.243848 f1_test 0.166021 acc_val 0.182741 f1_val 0.132329 acc_train 0.972381 f1_train 0.972444 psl_cor 901 psl_totl 3671 pslt_global 0.800000  Tim 0:13:09
acc_train_cw [0.982, 0.979, 0.949, 0.992, 0.991, 0.949, 0.952]
cw_psl_eval:  [851, 311, 677, 510, 668, 598, 56] [303, 136, 140, 86, 119, 95, 22]
psl_acc:  0.245 cw_psl_acc:  [0.3560517132282257, 0.43729904294013977, 0.20679467916488647, 0.16862745583057404, 0.178143709897995, 0.1588628739118576, 0.3928571343421936]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3838
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 3750 acc_test 0.183445 f1_test 0.130859 acc_val 0.189509 f1_val 0.135339 acc_train 0.967952 f1_train 0.968476 psl_cor 848 psl_totl 3440 pslt_global 0.800000  Tim 0:14:46
acc_train_cw [0.99, 0.966, 0.94, 0.994, 0.986, 0.93, 0.967]
cw_psl_eval:  [691, 339, 648, 514, 659, 536, 53] [269, 135, 135, 86, 117, 83, 23]
psl_acc:  0.247 cw_psl_acc:  [0.38929086923599243, 0.39823007583618164, 0.2083333283662796, 0.16731517016887665, 0.17754173278808594, 0.15485075116157532, 0.43396225571632385]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 4299 acc_test 0.205817 f1_test 0.144060 acc_val 0.194585 f1_val 0.138971 acc_train 0.984110 f1_train 0.981821 psl_cor 888 psl_totl 3733 pslt_global 0.800000  Tim 0:16:23
acc_train_cw [0.989, 0.988, 0.99, 0.992, 0.981, 0.967, 0.967]
cw_psl_eval:  [841, 338, 759, 523, 601, 616, 55] [295, 131, 157, 87, 102, 95, 21]
psl_acc:  0.238 cw_psl_acc:  [0.350772887468338, 0.3875739574432373, 0.20685112476348877, 0.16634799540042877, 0.16971713304519653, 0.15422077476978302, 0.38181817531585693]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 4848 acc_test 0.246085 f1_test 0.164581 acc_val 0.182741 f1_val 0.135160 acc_train 0.982808 f1_train 0.983423 psl_cor 895 psl_totl 3716 pslt_global 0.800000  Tim 0:17:59
acc_train_cw [0.979, 0.98, 0.992, 0.996, 0.987, 0.962, 0.983]
cw_psl_eval:  [808, 337, 767, 508, 627, 614, 55] [290, 136, 153, 86, 110, 98, 22]
psl_acc:  0.241 cw_psl_acc:  [0.3589108884334564, 0.4035608172416687, 0.19947849214076996, 0.16929133236408234, 0.17543859779834747, 0.1596091240644455, 0.4000000059604645]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 5397 acc_test 0.174497 f1_test 0.121890 acc_val 0.216582 f1_val 0.154732 acc_train 0.975254 f1_train 0.971114 psl_cor 892 psl_totl 3695 pslt_global 0.800000  Tim 0:19:36
acc_train_cw [0.986, 0.965, 0.989, 0.977, 0.975, 0.945, 0.97]
cw_psl_eval:  [805, 357, 804, 470, 676, 523, 60] [292, 138, 162, 75, 114, 86, 25]
psl_acc:  0.241 cw_psl_acc:  [0.3627329170703888, 0.38655462861061096, 0.2014925330877304, 0.1595744639635086, 0.16863904893398285, 0.1644359529018402, 0.4166666567325592]
Early stopping trigger at step:  5397
Best model at step:  106
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  18 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:19:55 (h:mm:ss)
Load model from ./experiment/few_shot/output/5_unixcoder-base_0.0001_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240403-082417/0/training_statistics.csv

Best_step:  106 
best_test_acc:  0.15659955257270694 
best_test_f1:  0.10336881340700962
Save best record in:  ./experiment/few_shot/log/20240403-082417/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
