current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_unixcoder-base_0.0005_0.9_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0005

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.181208 f1_test 0.091400 acc_val 0.131980 f1_val 0.074635 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:10
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.111857 f1_test 0.035014 acc_val 0.182741 f1_val 0.064546 acc_train 0.428571 f1_train 0.333333 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:39
acc_train_cw [0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 26
line 258 => 인스턴스 수 4
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.214765 f1_test 0.058748 acc_val 0.272420 f1_val 0.110007 acc_train 0.076923 f1_train 0.054422 psl_cor 5 psl_totl 19 pslt_global 0.900000  Tim 0:01:14
acc_train_cw [0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 19, 0, 0, 0, 0, 0] [0, 5, 0, 0, 0, 0, 0]
psl_acc:  0.263 cw_psl_acc:  [nan, 0.2631579041481018, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3444
line 258 => 인스턴스 수 492
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 6 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998258 f1_train 0.142733 psl_cor 511 psl_totl 3445 pslt_global 0.900000  Tim 0:02:06
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3445, 0, 0, 0, 0, 0] [0, 511, 0, 0, 0, 0, 0]
psl_acc:  0.148 cw_psl_acc:  [nan, 0.1483309119939804, nan, nan, nan, nan, nan]
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 498 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:03:37
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 1047 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:05:14
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 1596 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:06:52
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 2145 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:08:29
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 2694 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:10:06
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 3243 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:11:43
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 3792 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:13:20
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 4341 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:14:58
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 4890 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:16:35
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 5439 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:18:12
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 5988 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:19:50
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 6537 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:21:27
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 7086 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:23:04
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 7635 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:24:41
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 8184 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:26:19
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 8733 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:27:56
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 9282 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:29:34
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 9831 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:31:11
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 10380 acc_test 0.060403 f1_test 0.016275 acc_val 0.199662 f1_val 0.066573 acc_train 0.998437 f1_train 0.142745 psl_cor 554 psl_totl 3844 pslt_global 0.900000  Tim 0:32:48
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3844, 0, 0, 0, 0, 0] [0, 554, 0, 0, 0, 0, 0]
psl_acc:  0.144 cw_psl_acc:  [nan, 0.1441207081079483, nan, nan, nan, nan, nan]
Early stopping trigger at step:  10380
Best model at step:  2
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  24 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:33:07 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0005_0.9_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240329-073859/0/training_statistics.csv

Best_step:  2 
best_test_acc:  0.21476510067114093 
best_test_f1:  0.05874794915890806
Save best record in:  ./experiment/few_shot/log/20240329-073859/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
