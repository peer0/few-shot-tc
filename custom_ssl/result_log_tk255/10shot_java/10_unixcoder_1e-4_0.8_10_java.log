current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_unixcoder-base_0.0001_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.100671 f1_test 0.069870 acc_val 0.297800 f1_val 0.187759 acc_train 0.128571 f1_train 0.099647 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.0, 0.2, 0.4, 0.1, 0.1, 0.0, 0.1]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.199105 f1_test 0.060444 acc_val 0.299492 f1_val 0.135685 acc_train 0.285714 f1_train 0.221166 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:40
acc_train_cw [0.0, 0.4, 0.0, 0.0, 0.9, 0.1, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.120805 f1_test 0.104143 acc_val 0.236887 f1_val 0.177617 acc_train 0.542857 f1_train 0.420106 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:14
acc_train_cw [0.9, 0.0, 0.9, 0.9, 0.0, 0.1, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 365
line 258 => 인스턴스 수 53
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.145414 f1_test 0.152303 acc_val 0.401015 f1_val 0.361189 acc_train 0.953425 f1_train 0.847370 psl_cor 236 psl_totl 295 pslt_global 0.800000  Tim 0:01:43
acc_train_cw [0.992, 0.76, 1.0, 0.9, 0.7, 0.545, 1.0]
cw_psl_eval:  [250, 15, 0, 0, 0, 1, 29] [211, 13, 0, 0, 0, 1, 11]
psl_acc:  0.8 cw_psl_acc:  [0.843999981880188, 0.8666666746139526, nan, nan, nan, 1.0, 0.37931033968925476]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3283
line 258 => 인스턴스 수 469
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 83 acc_test 0.158837 f1_test 0.098581 acc_val 0.258883 f1_val 0.180018 acc_train 0.922936 f1_train 0.673994 psl_cor 1147 psl_totl 3221 pslt_global 0.800000  Tim 0:02:36
acc_train_cw [0.999, 0.0, 0.866, 0.911, 0.715, 0.167, 0.908]
cw_psl_eval:  [1343, 0, 298, 697, 227, 1, 655] [520, 0, 71, 265, 69, 1, 221]
psl_acc:  0.356 cw_psl_acc:  [0.38719284534454346, nan, 0.23825503885746002, 0.3802008628845215, 0.303964763879776, 1.0, 0.3374045789241791]
**bs에 맞지않음!!!!!**


line 303 => train data수 3696
line 258 => 인스턴스 수 528
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 552 acc_test 0.167785 f1_test 0.125533 acc_val 0.318105 f1_val 0.226009 acc_train 0.923160 f1_train 0.645092 psl_cor 1128 psl_totl 3264 pslt_global 0.800000  Tim 0:04:04
acc_train_cw [0.942, 0.0, 0.934, 0.986, 0.346, 0.167, 0.906]
cw_psl_eval:  [1081, 0, 658, 861, 48, 0, 616] [474, 0, 142, 313, 10, 0, 189]
psl_acc:  0.346 cw_psl_acc:  [0.4384828805923462, nan, 0.21580547094345093, 0.3635307848453522, 0.2083333283662796, nan, 0.3068181872367859]
**bs에 맞지않음!!!!!**


line 303 => train data수 3780
line 258 => 인스턴스 수 540
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 1080 acc_test 0.178971 f1_test 0.134626 acc_val 0.304569 f1_val 0.221100 acc_train 0.945767 f1_train 0.705902 psl_cor 1189 psl_totl 3419 pslt_global 0.800000  Tim 0:05:38
acc_train_cw [0.987, 0.0, 0.911, 0.947, 0.617, 0.25, 0.971]
cw_psl_eval:  [1127, 0, 619, 844, 65, 1, 763] [478, 0, 142, 305, 14, 1, 249]
psl_acc:  0.348 cw_psl_acc:  [0.42413488030433655, nan, 0.22940225899219513, 0.3613744080066681, 0.2153846174478531, 1.0, 0.3263433873653412]

line 303 => train data수 3820
line 258 => 인스턴스 수 546
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 1620 acc_test 0.205817 f1_test 0.179856 acc_val 0.362098 f1_val 0.263447 acc_train 0.935079 f1_train 0.729861 psl_cor 1201 psl_totl 3350 pslt_global 0.800000  Tim 0:07:14
acc_train_cw [0.929, 0.0, 0.988, 0.981, 0.767, 0.417, 0.889]
cw_psl_eval:  [895, 0, 800, 890, 197, 1, 567] [436, 0, 188, 363, 43, 0, 171]
psl_acc:  0.359 cw_psl_acc:  [0.4871508479118347, nan, 0.23499999940395355, 0.40786516666412354, 0.21827411651611328, 0.0, 0.30158731341362]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3829
line 258 => 인스턴스 수 547
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 2166 acc_test 0.187919 f1_test 0.155271 acc_val 0.351946 f1_val 0.256890 acc_train 0.961870 f1_train 0.707497 psl_cor 1245 psl_totl 3548 pslt_global 0.800000  Tim 0:08:50
acc_train_cw [0.979, 0.0, 0.974, 0.987, 0.838, 0.1, 0.963]
cw_psl_eval:  [1058, 0, 763, 905, 271, 0, 551] [472, 0, 179, 373, 54, 0, 167]
psl_acc:  0.351 cw_psl_acc:  [0.44612476229667664, nan, 0.2346002608537674, 0.4121547043323517, 0.19926199316978455, nan, 0.3030852973461151]

line 303 => train data수 3835
line 258 => 인스턴스 수 548
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 2713 acc_test 0.199105 f1_test 0.168489 acc_val 0.335025 f1_val 0.251640 acc_train 0.956454 f1_train 0.678806 psl_cor 1255 psl_totl 3591 pslt_global 0.800000  Tim 0:10:27
acc_train_cw [0.992, 0.0, 0.878, 0.991, 0.904, 0.0, 0.986]
cw_psl_eval:  [1047, 0, 527, 933, 453, 0, 631] [466, 0, 127, 363, 106, 0, 193]
psl_acc:  0.349 cw_psl_acc:  [0.4450811743736267, nan, 0.24098671972751617, 0.38906753063201904, 0.23399558663368225, nan, 0.30586370825767517]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 3261 acc_test 0.199105 f1_test 0.159459 acc_val 0.323181 f1_val 0.239753 acc_train 0.924720 f1_train 0.653945 psl_cor 1175 psl_totl 3475 pslt_global 0.800000  Tim 0:12:03
acc_train_cw [0.973, 0.0, 0.876, 0.943, 0.821, 0.0, 0.959]
cw_psl_eval:  [1059, 0, 644, 826, 346, 0, 600] [427, 0, 144, 351, 84, 0, 169]
psl_acc:  0.338 cw_psl_acc:  [0.4032105803489685, nan, 0.22360248863697052, 0.42493945360183716, 0.24277456104755402, nan, 0.28166666626930237]
train batch instace수가 7안됨 pass

line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 3810 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.246418 f1_train 0.056486 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:13:40
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 4359 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.297473 f1_train 0.065506 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:15:16
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 4908 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.246418 f1_train 0.056486 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:16:52
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  4908
Best model at step:  30
**조기종료됨**
종료된 epoch시점 :  15 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:17:10 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_unixcoder-base_0.0001_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-113650/0/training_statistics.csv

Best_step:  30 
best_test_acc:  0.14541387024608501 
best_test_f1:  0.15230326558180698
Save best record in:  ./experiment/few_shot/log/20240401-113650/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
