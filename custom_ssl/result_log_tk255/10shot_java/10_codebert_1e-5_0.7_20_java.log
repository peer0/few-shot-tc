current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codebert-base_1e-05_0.7_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  1e-05

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.096197 f1_test 0.031173 acc_val 0.089679 f1_val 0.033271 acc_train 0.114286 f1_train 0.032653 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.131991 f1_test 0.036566 acc_val 0.096447 f1_val 0.031301 acc_train 0.171429 f1_train 0.081062 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:42
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.127517 f1_test 0.106530 acc_val 0.181049 f1_val 0.110079 acc_train 0.300000 f1_train 0.186783 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:17
acc_train_cw [0.9, 0.0, 0.0, 0.0, 0.4, 0.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.183445 f1_test 0.096925 acc_val 0.194585 f1_val 0.100962 acc_train 0.400000 f1_train 0.322235 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:52
acc_train_cw [0.6, 0.0, 0.0, 0.0, 0.9, 0.6, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 40 acc_test 0.172260 f1_test 0.063558 acc_val 0.240271 f1_val 0.120658 acc_train 0.300000 f1_train 0.215745 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:27
acc_train_cw [0.5, 0.0, 0.0, 0.0, 0.9, 0.0, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 50 acc_test 0.093960 f1_test 0.106647 acc_val 0.160745 f1_val 0.128342 acc_train 0.428571 f1_train 0.417017 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:02
acc_train_cw [0.5, 0.1, 0.2, 0.4, 0.6, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 60 acc_test 0.082774 f1_test 0.084010 acc_val 0.214890 f1_val 0.160284 acc_train 0.414286 f1_train 0.368561 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:31
acc_train_cw [0.7, 0.1, 0.3, 0.7, 0.4, 0.0, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 70 acc_test 0.102908 f1_test 0.108233 acc_val 0.208122 f1_val 0.162182 acc_train 0.471429 f1_train 0.418312 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:00
acc_train_cw [0.7, 0.4, 0.0, 0.7, 0.5, 0.1, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 80 acc_test 0.093960 f1_test 0.119450 acc_val 0.135364 f1_val 0.121581 acc_train 0.457143 f1_train 0.434379 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:29
acc_train_cw [0.8, 0.1, 0.6, 0.5, 0.3, 0.1, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 90 acc_test 0.161074 f1_test 0.172250 acc_val 0.211506 f1_val 0.165587 acc_train 0.642857 f1_train 0.626846 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:58
acc_train_cw [0.9, 0.3, 0.9, 0.7, 0.7, 0.3, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 100 acc_test 0.183445 f1_test 0.183040 acc_val 0.179357 f1_val 0.150372 acc_train 0.628571 f1_train 0.627512 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:28
acc_train_cw [0.9, 0.6, 0.5, 0.7, 0.6, 0.4, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 71
line 258 => 인스턴스 수 11
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 110 acc_test 0.147651 f1_test 0.166935 acc_val 0.167513 f1_val 0.145097 acc_train 0.704225 f1_train 0.688968 psl_cor 1 psl_totl 1 pslt_global 0.700000  Tim 0:05:57
acc_train_cw [0.909, 0.4, 0.8, 0.8, 0.6, 0.4, 1.0]
cw_psl_eval:  [1, 0, 0, 0, 0, 0, 0] [1, 0, 0, 0, 0, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [1.0, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 85
line 258 => 인스턴스 수 13
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 121 acc_test 0.123043 f1_test 0.139365 acc_val 0.148900 f1_val 0.119969 acc_train 0.705882 f1_train 0.653314 psl_cor 7 psl_totl 14 pslt_global 0.700000  Tim 0:06:26
acc_train_cw [0.929, 0.4, 0.8, 0.7, 0.2, 0.6, 0.952]
cw_psl_eval:  [3, 0, 0, 0, 0, 0, 11] [3, 0, 0, 0, 0, 0, 4]
psl_acc:  0.5 cw_psl_acc:  [1.0, nan, nan, nan, nan, nan, 0.3636363744735718]
train batch instace수가 7안됨 pass

line 303 => train data수 294
line 258 => 인스턴스 수 42
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 134 acc_test 0.174497 f1_test 0.173987 acc_val 0.201354 f1_val 0.140481 acc_train 0.874150 f1_train 0.691008 psl_cor 124 psl_totl 213 pslt_global 0.700000  Tim 0:06:56
acc_train_cw [0.983, 0.2, 0.8, 0.667, 0.6, 0.684, 1.0]
cw_psl_eval:  [164, 0, 0, 14, 0, 28, 7] [115, 0, 0, 2, 0, 5, 2]
psl_acc:  0.582 cw_psl_acc:  [0.7012194991111755, nan, nan, 0.1428571492433548, nan, 0.1785714328289032, 0.2857142984867096]

line 303 => train data수 1682
line 258 => 인스턴스 수 241
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 176 acc_test 0.208054 f1_test 0.188695 acc_val 0.155668 f1_val 0.122994 acc_train 0.890606 f1_train 0.765327 psl_cor 501 psl_totl 1603 pslt_global 0.700000  Tim 0:07:36
acc_train_cw [0.997, 0.526, 0.56, 0.644, 0.872, 0.718, 1.0]
cw_psl_eval:  [639, 9, 74, 132, 38, 262, 449] [327, 2, 12, 22, 0, 41, 97]
psl_acc:  0.313 cw_psl_acc:  [0.5117371082305908, 0.2222222238779068, 0.1621621549129486, 0.1666666716337204, 0.0, 0.1564885526895523, 0.2160356342792511]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3299
line 258 => 인스턴스 수 472
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 417 acc_test 0.203579 f1_test 0.163646 acc_val 0.125212 f1_val 0.098663 acc_train 0.881782 f1_train 0.732224 psl_cor 791 psl_totl 3152 pslt_global 0.700000  Tim 0:08:42
acc_train_cw [0.993, 0.0, 0.749, 0.765, 0.643, 0.871, 1.0]
cw_psl_eval:  [806, 0, 412, 457, 169, 604, 704] [376, 0, 67, 84, 25, 88, 151]
psl_acc:  0.251 cw_psl_acc:  [0.46650123596191406, nan, 0.1626213639974594, 0.18380743265151978, 0.14792899787425995, 0.14569535851478577, 0.21448864042758942]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3731
line 258 => 인스턴스 수 533
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 889 acc_test 0.208054 f1_test 0.157898 acc_val 0.128596 f1_val 0.099416 acc_train 0.911016 f1_train 0.757373 psl_cor 863 psl_totl 3576 pslt_global 0.700000  Tim 0:10:12
acc_train_cw [0.999, 0.0, 0.806, 0.836, 0.663, 0.917, 0.996]
cw_psl_eval:  [914, 0, 487, 512, 156, 804, 703] [407, 0, 76, 87, 22, 116, 155]
psl_acc:  0.241 cw_psl_acc:  [0.44529539346694946, nan, 0.15605749189853668, 0.169921875, 0.14102564752101898, 0.1442786008119583, 0.22048364579677582]

line 303 => train data수 3805
line 258 => 인스턴스 수 544
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 1422 acc_test 0.194631 f1_test 0.159366 acc_val 0.140440 f1_val 0.111071 acc_train 0.920105 f1_train 0.778597 psl_cor 844 psl_totl 3558 pslt_global 0.700000  Tim 0:11:48
acc_train_cw [0.985, 0.0, 0.889, 0.876, 0.749, 0.908, 0.991]
cw_psl_eval:  [730, 0, 665, 583, 167, 746, 667] [364, 0, 112, 96, 16, 109, 147]
psl_acc:  0.237 cw_psl_acc:  [0.4986301362514496, nan, 0.16842105984687805, 0.16466552019119263, 0.09580838680267334, 0.1461126059293747, 0.22038979828357697]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3829
line 258 => 인스턴스 수 547
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 1966 acc_test 0.190157 f1_test 0.157192 acc_val 0.133672 f1_val 0.106637 acc_train 0.945678 f1_train 0.804368 psl_cor 861 psl_totl 3652 pslt_global 0.700000  Tim 0:13:26
acc_train_cw [0.997, 0.0, 0.919, 0.901, 0.842, 0.948, 0.991]
cw_psl_eval:  [747, 0, 668, 590, 163, 796, 688] [366, 0, 110, 99, 17, 115, 154]
psl_acc:  0.236 cw_psl_acc:  [0.48995983600616455, nan, 0.1646706610918045, 0.16779661178588867, 0.10429447889328003, 0.14447236061096191, 0.223837211728096]
**bs에 맞지않음!!!!!**


line 303 => train data수 3834
line 258 => 인스턴스 수 548
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 2513 acc_test 0.201342 f1_test 0.159837 acc_val 0.145516 f1_val 0.113400 acc_train 0.949922 f1_train 0.809853 psl_cor 867 psl_totl 3669 pslt_global 0.700000  Tim 0:15:04
acc_train_cw [0.995, 0.0, 0.926, 0.925, 0.874, 0.936, 0.997]
cw_psl_eval:  [787, 0, 635, 622, 174, 796, 655] [380, 0, 105, 104, 19, 114, 145]
psl_acc:  0.236 cw_psl_acc:  [0.4828462600708008, nan, 0.16535432636737823, 0.16720257699489594, 0.10919540375471115, 0.143216073513031, 0.221374049782753]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 3061 acc_test 0.181208 f1_test 0.156744 acc_val 0.147208 f1_val 0.118137 acc_train 0.963774 f1_train 0.820447 psl_cor 859 psl_totl 3667 pslt_global 0.700000  Tim 0:16:42
acc_train_cw [0.996, 0.0, 0.965, 0.954, 0.863, 0.954, 0.994]
cw_psl_eval:  [727, 0, 701, 663, 213, 721, 642] [364, 0, 118, 103, 25, 107, 142]
psl_acc:  0.234 cw_psl_acc:  [0.5006877779960632, nan, 0.16833095252513885, 0.15535445511341095, 0.11737088859081268, 0.14840498566627502, 0.22118380665779114]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3838
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 3610 acc_test 0.217002 f1_test 0.176186 acc_val 0.130288 f1_val 0.107102 acc_train 0.966910 f1_train 0.825100 psl_cor 872 psl_totl 3700 pslt_global 0.700000  Tim 0:18:20
acc_train_cw [0.995, 0.0, 0.974, 0.93, 0.883, 0.972, 0.999]
cw_psl_eval:  [759, 0, 662, 559, 230, 805, 685] [373, 0, 114, 91, 27, 115, 152]
psl_acc:  0.236 cw_psl_acc:  [0.49143609404563904, nan, 0.17220543324947357, 0.1627907007932663, 0.11739130318164825, 0.1428571492433548, 0.22189781069755554]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 4159 acc_test 0.210291 f1_test 0.174171 acc_val 0.130288 f1_val 0.107511 acc_train 0.977338 f1_train 0.834209 psl_cor 872 psl_totl 3737 pslt_global 0.700000  Tim 0:19:58
acc_train_cw [0.999, 0.0, 0.98, 0.951, 0.903, 0.991, 0.999]
cw_psl_eval:  [758, 0, 672, 571, 246, 805, 685] [373, 0, 110, 93, 27, 116, 153]
psl_acc:  0.233 cw_psl_acc:  [0.49208444356918335, nan, 0.1636904776096344, 0.16287215054035187, 0.10975609719753265, 0.1440993845462799, 0.2233576625585556]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 4708 acc_test 0.203579 f1_test 0.169523 acc_val 0.155668 f1_val 0.128128 acc_train 0.977598 f1_train 0.834973 psl_cor 876 psl_totl 3750 pslt_global 0.700000  Tim 0:21:36
acc_train_cw [1.0, 0.0, 0.97, 0.971, 0.901, 0.988, 0.999]
cw_psl_eval:  [740, 0, 692, 576, 264, 808, 670] [373, 0, 121, 92, 29, 114, 147]
psl_acc:  0.234 cw_psl_acc:  [0.504054069519043, nan, 0.17485548555850983, 0.1597222238779068, 0.10984848439693451, 0.14108911156654358, 0.2194029837846756]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 5257 acc_test 0.210291 f1_test 0.174153 acc_val 0.162437 f1_val 0.134138 acc_train 0.981766 f1_train 0.839982 psl_cor 870 psl_totl 3728 pslt_global 0.700000  Tim 0:23:14
acc_train_cw [1.0, 0.0, 0.98, 0.975, 0.94, 0.983, 1.0]
cw_psl_eval:  [729, 0, 674, 584, 272, 792, 677] [368, 0, 119, 92, 29, 113, 149]
psl_acc:  0.233 cw_psl_acc:  [0.5048010945320129, nan, 0.17655786871910095, 0.15753424167633057, 0.10661764442920685, 0.14267677068710327, 0.2200886309146881]
Early stopping trigger at step:  5257
Best model at step:  40
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  26 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:23:33 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codebert-base_1e-05_0.7_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240331-190436/0/training_statistics.csv

Best_step:  40 
best_test_acc:  0.17225950782997762 
best_test_f1:  0.06355803752750526
Save best record in:  ./experiment/few_shot/log/20240331-190436/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
