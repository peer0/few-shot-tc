current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_codebert-base_0.0005_0.9_20_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0005

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.192623 f1_test 0.098918 acc_val 0.228013 f1_val 0.075525 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.188525 f1_test 0.073259 acc_val 0.107492 f1_val 0.042827 acc_train 0.285714 f1_train 0.142857 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:32
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.043033 f1_test 0.011788 acc_val 0.143322 f1_val 0.035816 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:56
acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 8
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.090164 f1_test 0.052074 acc_val 0.140065 f1_val 0.091156 acc_train 0.500000 f1_train 0.404762 psl_cor 1 psl_totl 1 pslt_global 0.900000  Tim 0:01:20
acc_train_cw [1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 1, 0, 0] [0, 0, 0, 0, 1, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [nan, nan, nan, nan, 1.0, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 221
line 258 => 인스턴스 수 32
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 5 acc_test 0.049180 f1_test 0.024717 acc_val 0.146580 f1_val 0.040039 acc_train 0.416290 f1_train 0.237060 psl_cor 63 psl_totl 219 pslt_global 0.900000  Tim 0:01:45
acc_train_cw [0.553, 0.0, 0.453, 0.0, 1.0, 0.069, 0.125]
cw_psl_eval:  [38, 0, 142, 0, 3, 29, 7] [34, 0, 19, 0, 1, 7, 2]
psl_acc:  0.288 cw_psl_acc:  [0.8947368264198303, nan, 0.13380281627178192, nan, 0.3333333432674408, 0.24137930572032928, 0.2857142984867096]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 987
line 258 => 인스턴스 수 141
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 37 acc_test 0.032787 f1_test 0.018113 acc_val 0.159609 f1_val 0.068937 acc_train 0.828774 f1_train 0.161304 psl_cor 163 psl_totl 987 pslt_global 0.900000  Tim 0:02:16
acc_train_cw [0.0, 0.0, 0.83, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 971, 0, 0, 0, 16] [0, 0, 162, 0, 0, 0, 1]
psl_acc:  0.165 cw_psl_acc:  [nan, nan, 0.16683831810951233, nan, nan, nan, 0.0625]
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 178 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:03:10
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 736 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:04:43
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 1294 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:06:16
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 1852 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:07:49
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 2410 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:09:22
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 2968 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:10:56
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 3526 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:12:29
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 4084 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:14:02
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 4642 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:15:35
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 5200 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:17:08
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 5758 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:18:41
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 6316 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:20:14
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 6874 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:21:47
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 7432 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:23:20
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 7990 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.998975 f1_train 0.199897 psl_cor 706 psl_totl 3967 pslt_global 0.900000  Tim 0:24:53
acc_train_cw [0.0, nan, 1.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 3967, 0, 0, 0, 0] [0, 0, 706, 0, 0, 0, 0]
psl_acc:  0.178 cw_psl_acc:  [nan, nan, 0.17796823382377625, nan, nan, nan, nan]
Early stopping trigger at step:  7990
Best model at step:  0
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  22 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:25:11 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codebert-base_0.0005_0.9_20_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-084136/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.19262295081967212 
best_test_f1:  0.09891822583616645
Save best record in:  ./experiment/few_shot/log/20240330-084136/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
