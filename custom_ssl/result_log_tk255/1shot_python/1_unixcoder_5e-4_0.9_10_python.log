current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_unixcoder-base_0.0005_0.9_10_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0005

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.168033 f1_test 0.111264 acc_val 0.179153 f1_val 0.119752 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.018443 f1_test 0.005174 acc_val 0.117264 f1_val 0.029988 acc_train 0.285714 f1_train 0.183673 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:31
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 28
line 258 => 인스턴스 수 4
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.250000 f1_train 0.147186 psl_cor 5 psl_totl 21 pslt_global 0.900000  Tim 0:00:55
acc_train_cw [0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [1, 5, 8, 0, 0, 7, 0] [1, 3, 0, 0, 0, 1, 0]
psl_acc:  0.238 cw_psl_acc:  [1.0, 0.6000000238418579, 0.0, nan, nan, 0.1428571492433548, nan]

line 303 => train data수 41
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 6 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.609756 f1_train 0.108225 psl_cor 1 psl_totl 18 pslt_global 0.900000  Tim 0:01:19
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 17, 0, 0, 1, 0] [0, 0, 1, 0, 0, 0, 0]
psl_acc:  0.056 cw_psl_acc:  [nan, nan, 0.05882352963089943, nan, nan, 0.0, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 303 => train data수 86
line 258 => 인스턴스 수 13
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 12 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.744186 f1_train 0.121905 psl_cor 1 psl_totl 58 pslt_global 0.900000  Tim 0:01:51
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 52, 0, 0, 6, 0] [0, 0, 1, 0, 0, 0, 0]
psl_acc:  0.017 cw_psl_acc:  [nan, nan, 0.01923076994717121, nan, nan, 0.0, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 94
line 258 => 인스턴스 수 14
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 25 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.765957 f1_train 0.123924 psl_cor 1 psl_totl 8 pslt_global 0.900000  Tim 0:02:16
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 8, 0, 0, 0, 0] [0, 0, 1, 0, 0, 0, 0]
psl_acc:  0.125 cw_psl_acc:  [nan, nan, 0.125, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 108
line 258 => 인스턴스 수 16
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 39 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.638889 f1_train 0.111380 psl_cor 1 psl_totl 18 pslt_global 0.900000  Tim 0:02:41
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 18, 0] [0, 0, 0, 0, 0, 1, 0]
psl_acc:  0.056 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.0555555559694767, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 152
line 258 => 인스턴스 수 22
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 55 acc_test 0.297131 f1_test 0.065552 acc_val 0.026059 f1_val 0.007256 acc_train 0.769737 f1_train 0.215180 psl_cor 9 psl_totl 94 pslt_global 0.900000  Tim 0:03:06
acc_train_cw [0.0, 0.0, 0.743, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 94, 0, 0, 0, 0] [0, 0, 9, 0, 0, 0, 0]
psl_acc:  0.096 cw_psl_acc:  [nan, nan, 0.09574468433856964, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 187
line 258 => 인스턴스 수 27
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 77 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.577540 f1_train 0.161117 psl_cor 11 psl_totl 105 pslt_global 0.900000  Tim 0:03:33
acc_train_cw [0.0, 0.0, 0.507, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 105, 0, 0, 0, 0] [0, 0, 11, 0, 0, 0, 0]
psl_acc:  0.105 cw_psl_acc:  [nan, nan, 0.10476190596818924, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 189
line 258 => 인스턴스 수 27
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 104 acc_test 0.297131 f1_test 0.065552 acc_val 0.026059 f1_val 0.007256 acc_train 0.587302 f1_train 0.163221 psl_cor 5 psl_totl 79 pslt_global 0.900000  Tim 0:03:59
acc_train_cw [0.0, 0.0, 0.52, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 79, 0, 0, 0, 0] [0, 0, 5, 0, 0, 0, 0]
psl_acc:  0.063 cw_psl_acc:  [nan, nan, 0.06329113990068436, nan, nan, nan, nan]
**bs에 맞지않음!!!!!**


line 303 => train data수 192
line 258 => 인스턴스 수 28
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 131 acc_test 0.297131 f1_test 0.065552 acc_val 0.026059 f1_val 0.007256 acc_train 0.588542 f1_train 0.163124 psl_cor 8 psl_totl 84 pslt_global 0.900000  Tim 0:04:26
acc_train_cw [0.0, 0.0, 0.523, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 84, 0, 0, 0, 0] [0, 0, 8, 0, 0, 0, 0]
psl_acc:  0.095 cw_psl_acc:  [nan, nan, 0.095238097012043, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 192
line 258 => 인스턴스 수 28
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 159 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.796875 f1_train 0.126708 psl_cor 6 psl_totl 81 pslt_global 0.900000  Tim 0:04:53
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 81, 0, 0, 0, 0] [0, 0, 6, 0, 0, 0, 0]
psl_acc:  0.074 cw_psl_acc:  [nan, nan, 0.07407407462596893, nan, nan, nan, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 196
line 258 => 인스턴스 수 28
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 187 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.801020 f1_train 0.127074 psl_cor 6 psl_totl 81 pslt_global 0.900000  Tim 0:05:20
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 81, 0, 0, 0, 0] [0, 0, 6, 0, 0, 0, 0]
psl_acc:  0.074 cw_psl_acc:  [nan, nan, 0.07407407462596893, nan, nan, nan, nan]
**bs에 맞지않음!!!!!**


line 303 => train data수 280
line 258 => 인스턴스 수 40
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 215 acc_test 0.122951 f1_test 0.031283 acc_val 0.228013 f1_val 0.053050 acc_train 0.864286 f1_train 0.132458 psl_cor 28 psl_totl 165 pslt_global 0.900000  Tim 0:05:47
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 165, 0, 0, 0, 0] [0, 0, 28, 0, 0, 0, 0]
psl_acc:  0.17 cw_psl_acc:  [nan, nan, 0.16969697177410126, nan, nan, nan, nan]
Early stopping trigger at step:  215
Best model at step:  6
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  15 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:06:05 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0005_0.9_10_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-114908/0/training_statistics.csv

Best_step:  6 
best_test_acc:  0.12295081967213115 
best_test_f1:  0.03128258602711157
Save best record in:  ./experiment/few_shot/log/20240330-114908/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
