current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../codecomplex_java

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  5
train_df samples: 3911
train_labeled_df samples: 35
train_unlabeled_df samples: 3876
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  1e-05

line 257 => epoch 0
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.157464 f1_test 0.124581 acc_val 0.134969 f1_val 0.097237 acc_train 0.114286 f1_train 0.075397 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:10
acc_train_cw [0.0, 0.0, 0.2, 0.0, 0.2, 0.4, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 1
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 5 acc_test 0.161554 f1_test 0.119617 acc_val 0.163599 f1_val 0.126697 acc_train 0.314286 f1_train 0.224603 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:37
acc_train_cw [0.0, 0.0, 0.4, 0.6, 0.2, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 2
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.208589 f1_test 0.174574 acc_val 0.235174 f1_val 0.214369 acc_train 0.457143 f1_train 0.431853 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:11
acc_train_cw [0.6, 0.2, 0.4, 0.8, 0.4, 0.8, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 3
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 15 acc_test 0.233129 f1_test 0.207722 acc_val 0.222904 f1_val 0.196889 acc_train 0.714286 f1_train 0.687126 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:46
acc_train_cw [0.4, 1.0, 0.2, 1.0, 0.6, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 4
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 20 acc_test 0.229039 f1_test 0.210978 acc_val 0.212679 f1_val 0.190630 acc_train 0.771429 f1_train 0.759854 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:13
acc_train_cw [0.8, 0.6, 0.6, 1.0, 0.4, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 5
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 25 acc_test 0.247444 f1_test 0.232383 acc_val 0.233129 f1_val 0.219791 acc_train 0.857143 f1_train 0.850216 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:41
acc_train_cw [0.8, 0.6, 0.6, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 257 => epoch 6
line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 30 acc_test 0.257669 f1_test 0.236005 acc_val 0.239264 f1_val 0.215198 acc_train 0.857143 f1_train 0.854185 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:09
acc_train_cw [0.8, 0.8, 0.6, 1.0, 0.8, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 7
line 303 => train data수 37
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 35 acc_test 0.257669 f1_test 0.235126 acc_val 0.243354 f1_val 0.217740 acc_train 0.891892 f1_train 0.891208 psl_cor 2 psl_totl 2 pslt_global 0.700000  Tim 0:03:43
acc_train_cw [0.857, 0.8, 0.6, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [2, 0, 0, 0, 0, 0, 0] [2, 0, 0, 0, 0, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [1.0, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 257 => epoch 8
line 303 => train data수 37
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 41 acc_test 0.306748 f1_test 0.294042 acc_val 0.253579 f1_val 0.239760 acc_train 0.945946 f1_train 0.941775 psl_cor 0 psl_totl 2 pslt_global 0.700000  Tim 0:04:18
acc_train_cw [1.0, 1.0, 0.6, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 257 => epoch 9
line 303 => train data수 38
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 47 acc_test 0.312883 f1_test 0.295294 acc_val 0.265849 f1_val 0.248611 acc_train 0.947368 f1_train 0.941775 psl_cor 0 psl_totl 3 pslt_global 0.700000  Tim 0:04:53
acc_train_cw [1.0, 1.0, 0.6, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 1, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 257 => epoch 10
line 303 => train data수 83
line 258 => 인스턴스 수 12
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 53 acc_test 0.296524 f1_test 0.281601 acc_val 0.271984 f1_val 0.255953 acc_train 0.987952 f1_train 0.982522 psl_cor 38 psl_totl 51 pslt_global 0.700000  Tim 0:05:28
acc_train_cw [1.0, 1.0, 0.8, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [39, 0, 0, 9, 0, 0, 0] [32, 0, 0, 6, 0, 0, 0]
psl_acc:  0.745 cw_psl_acc:  [0.8205128312110901, nan, nan, 0.6666666865348816, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 11
line 303 => train data수 766
line 258 => 인스턴스 수 110
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 65 acc_test 0.261759 f1_test 0.203009 acc_val 0.245399 f1_val 0.194763 acc_train 0.960836 f1_train 0.837064 psl_cor 378 psl_totl 783 pslt_global 0.700000  Tim 0:06:07
acc_train_cw [0.989, 0.606, 0.333, 1.0, 0.857, 1.0, 0.985]
cw_psl_eval:  [431, 28, 4, 106, 23, 9, 131] [253, 14, 0, 75, 5, 3, 28]
psl_acc:  0.483 cw_psl_acc:  [0.5870069861412048, 0.5, 0.0, 0.7075471878051758, 0.21739129722118378, 0.3333333432674408, 0.21374045312404633]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 12
line 303 => train data수 3102
line 258 => 인스턴스 수 444
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 175 acc_test 0.284254 f1_test 0.265870 acc_val 0.276074 f1_val 0.248007 acc_train 0.948098 f1_train 0.856676 psl_cor 1016 psl_totl 3851 pslt_global 0.700000  Tim 0:06:58
acc_train_cw [0.938, 0.884, 0.357, 0.969, 0.96, 0.645, 0.998]
cw_psl_eval:  [611, 458, 6, 385, 600, 57, 951] [321, 167, 3, 230, 119, 13, 163]
psl_acc:  0.264 cw_psl_acc:  [0.5253682732582092, 0.3646288216114044, 0.5, 0.5974025726318359, 0.19833333790302277, 0.22807016968727112, 0.17139852046966553]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 13
line 303 => train data수 3693
line 258 => 인스턴스 수 528
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 619 acc_test 0.284254 f1_test 0.248765 acc_val 0.278119 f1_val 0.246225 acc_train 0.969402 f1_train 0.804655 psl_cor 1114 psl_totl 7401 pslt_global 0.700000  Tim 0:08:31
acc_train_cw [0.941, 0.986, 0.0, 0.975, 0.962, 0.632, 0.998]
cw_psl_eval:  [566, 850, 0, 389, 752, 17, 976] [306, 244, 0, 236, 157, 5, 166]
psl_acc:  0.151 cw_psl_acc:  [0.5406360626220703, 0.28705883026123047, nan, 0.6066837906837463, 0.208776593208313, 0.29411765933036804, 0.1700819730758667]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 14
line 303 => train data수 3847
line 258 => 인스턴스 수 550
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 1147 acc_test 0.296524 f1_test 0.264177 acc_val 0.290389 f1_val 0.256489 acc_train 0.983884 f1_train 0.828778 psl_cor 1169 psl_totl 11156 pslt_global 0.700000  Tim 0:10:12
acc_train_cw [0.979, 0.977, 0.0, 0.986, 0.992, 0.816, 0.999]
cw_psl_eval:  [574, 861, 0, 415, 878, 28, 999] [306, 254, 0, 244, 194, 4, 167]
psl_acc:  0.105 cw_psl_acc:  [0.5331010222434998, 0.29500579833984375, nan, 0.5879517793655396, 0.2209567129611969, 0.1428571492433548, 0.16716717183589935]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 15
line 303 => train data수 3892
line 258 => 인스턴스 수 556
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 1697 acc_test 0.282209 f1_test 0.246227 acc_val 0.282209 f1_val 0.247180 acc_train 0.989723 f1_train 0.836996 psl_cor 1174 psl_totl 14994 pslt_global 0.700000  Tim 0:11:57
acc_train_cw [0.988, 0.997, 0.0, 0.988, 0.99, 0.824, 0.997]
cw_psl_eval:  [555, 959, 1, 411, 889, 23, 1000] [300, 259, 0, 243, 200, 5, 167]
psl_acc:  0.078 cw_psl_acc:  [0.5405405163764954, 0.2700729966163635, 0.0, 0.5912408828735352, 0.22497187554836273, 0.21739129722118378, 0.16699999570846558]
**bs에 맞지않음!!!!!**


line 257 => epoch 16
line 303 => train data수 3898
line 258 => 인스턴스 수 557
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 2253 acc_test 0.292434 f1_test 0.259206 acc_val 0.282209 f1_val 0.250298 acc_train 0.990764 f1_train 0.908614 psl_cor 1184 psl_totl 18827 pslt_global 0.700000  Tim 0:13:47
acc_train_cw [0.983, 0.991, 0.333, 1.0, 0.99, 0.917, 0.998]
cw_psl_eval:  [577, 905, 1, 417, 907, 29, 997] [308, 252, 0, 244, 207, 6, 167]
psl_acc:  0.063 cw_psl_acc:  [0.5337954759597778, 0.2784530520439148, 0.0, 0.5851318836212158, 0.22822491824626923, 0.2068965584039688, 0.1675025075674057]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 17
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 2810 acc_test 0.292434 f1_test 0.254232 acc_val 0.286299 f1_val 0.253807 acc_train 0.991284 f1_train 0.926025 psl_cor 1180 psl_totl 22662 pslt_global 0.700000  Tim 0:15:26
acc_train_cw [0.982, 0.994, 0.4, 0.993, 0.99, 0.969, 0.999]
cw_psl_eval:  [592, 897, 0, 413, 912, 24, 997] [310, 252, 0, 242, 204, 5, 167]
psl_acc:  0.052 cw_psl_acc:  [0.5236486196517944, 0.28093644976615906, nan, 0.5859563946723938, 0.22368420660495758, 0.2083333283662796, 0.1675025075674057]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 18
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 3368 acc_test 0.296524 f1_test 0.265202 acc_val 0.280164 f1_val 0.248707 acc_train 0.995386 f1_train 0.929537 psl_cor 1188 psl_totl 26521 pslt_global 0.700000  Tim 0:17:12
acc_train_cw [0.992, 1.0, 0.4, 0.998, 0.994, 0.914, 1.0]
cw_psl_eval:  [586, 909, 0, 415, 921, 28, 1000] [310, 255, 0, 244, 207, 5, 167]
psl_acc:  0.045 cw_psl_acc:  [0.5290102362632751, 0.2805280387401581, nan, 0.5879517793655396, 0.22475570440292358, 0.1785714328289032, 0.16699999570846558]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 19
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 3926 acc_test 0.282209 f1_test 0.245022 acc_val 0.271984 f1_val 0.237901 acc_train 0.995129 f1_train 0.947329 psl_cor 1181 psl_totl 30385 pslt_global 0.700000  Tim 0:19:03
acc_train_cw [0.993, 0.996, 0.6, 0.998, 0.993, 0.972, 0.999]
cw_psl_eval:  [583, 917, 0, 420, 909, 31, 1004] [308, 253, 0, 244, 204, 5, 167]
psl_acc:  0.039 cw_psl_acc:  [0.5283018946647644, 0.2758996784687042, nan, 0.5809524059295654, 0.22442243993282318, 0.16129031777381897, 0.16633465886116028]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 20
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 4484 acc_test 0.286299 f1_test 0.258365 acc_val 0.276074 f1_val 0.246782 acc_train 0.994360 f1_train 0.958390 psl_cor 1179 psl_totl 34244 pslt_global 0.700000  Tim 0:20:49
acc_train_cw [0.985, 0.995, 0.6, 0.995, 0.998, 0.975, 0.999]
cw_psl_eval:  [593, 925, 0, 419, 881, 35, 1006] [308, 256, 0, 244, 197, 7, 167]
psl_acc:  0.034 cw_psl_acc:  [0.5193929076194763, 0.27675676345825195, nan, 0.5823389291763306, 0.2236095368862152, 0.20000000298023224, 0.1660039722919464]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 21
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 5042 acc_test 0.280164 f1_test 0.248926 acc_val 0.290389 f1_val 0.259025 acc_train 0.994873 f1_train 0.977241 psl_cor 1186 psl_totl 38109 pslt_global 0.700000  Tim 0:22:27
acc_train_cw [0.995, 0.996, 0.8, 0.998, 0.99, 0.974, 0.999]
cw_psl_eval:  [602, 898, 0, 419, 907, 34, 1005] [310, 255, 0, 243, 203, 7, 168]
psl_acc:  0.031 cw_psl_acc:  [0.514950156211853, 0.2839643657207489, nan, 0.5799522399902344, 0.22381477057933807, 0.20588235557079315, 0.1671641767024994]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 22
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 5600 acc_test 0.286299 f1_test 0.253705 acc_val 0.284254 f1_val 0.256306 acc_train 0.997180 f1_train 0.975980 psl_cor 1184 psl_totl 41985 pslt_global 0.700000  Tim 0:24:05
acc_train_cw [0.998, 0.997, 0.8, 1.0, 0.996, 0.953, 1.0]
cw_psl_eval:  [602, 903, 0, 419, 909, 38, 1005] [309, 254, 0, 243, 203, 8, 167]
psl_acc:  0.028 cw_psl_acc:  [0.5132890343666077, 0.2812846004962921, nan, 0.5799522399902344, 0.223322331905365, 0.21052631735801697, 0.1661691516637802]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 23
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 6158 acc_test 0.292434 f1_test 0.264561 acc_val 0.278119 f1_val 0.247109 acc_train 0.997949 f1_train 0.976412 psl_cor 1179 psl_totl 45856 pslt_global 0.700000  Tim 0:25:43
acc_train_cw [1.0, 0.996, 0.8, 1.0, 1.0, 0.962, 0.999]
cw_psl_eval:  [604, 893, 0, 415, 908, 47, 1004] [309, 252, 0, 241, 203, 8, 166]
psl_acc:  0.026 cw_psl_acc:  [0.5115894079208374, 0.2821948528289795, nan, 0.5807228684425354, 0.22356827557086945, 0.1702127605676651, 0.1653386503458023]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 24
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 6716 acc_test 0.284254 f1_test 0.253053 acc_val 0.286299 f1_val 0.255917 acc_train 0.995898 f1_train 0.994540 psl_cor 1183 psl_totl 49720 pslt_global 0.700000  Tim 0:27:22
acc_train_cw [0.995, 0.994, 1.0, 1.0, 0.993, 0.981, 0.999]
cw_psl_eval:  [601, 905, 0, 413, 909, 46, 990] [309, 255, 0, 241, 204, 9, 165]
psl_acc:  0.024 cw_psl_acc:  [0.5141431093215942, 0.28176796436309814, nan, 0.5835351347923279, 0.22442243993282318, 0.19565217196941376, 0.1666666716337204]
Early stopping trigger at step:  6716
Best model at step:  1147
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  25 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:27:41 (h:mm:ss)
Load model from ./experiment/few_shot/output/codecomplex_java_unixcoder-base_5_0.7_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240327-100341/0/training_statistics.csv

Best_step:  1147 
best_test_acc:  0.2965235173824131 
best_test_f1:  0.2641767171985073
Save best record in:  ./experiment/few_shot/log/20240327-100341/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
