current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_codebert-base_0.0001_0.7_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.073826 f1_test 0.034030 acc_val 0.175973 f1_val 0.090057 acc_train 0.285714 f1_train 0.183673 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:13
acc_train_cw(현재 train의 class별 acc) [0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
tensor([[0.1376, 0.1733, 0.1592, 0.0977, 0.1597, 0.1326, 0.1399],
        [0.1648, 0.1558, 0.1336, 0.1134, 0.1525, 0.1209, 0.1591],
        [0.1545, 0.1344, 0.1158, 0.1453, 0.1480, 0.1516, 0.1505],
        [0.1198, 0.1551, 0.1551, 0.1057, 0.1809, 0.1352, 0.1483],
        [0.1511, 0.2063, 0.1444, 0.0962, 0.1479, 0.1262, 0.1279],
        [0.1371, 0.1328, 0.1208, 0.1466, 0.1475, 0.1446, 0.1707],
        [0.1661, 0.1579, 0.1532, 0.1095, 0.1499, 0.1257, 0.1377]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.158837 f1_test 0.072806 acc_val 0.214890 f1_val 0.116100 acc_train 0.571429 f1_train 0.452381 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:04
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
tensor([[0.1389, 0.1455, 0.1695, 0.1162, 0.1618, 0.1085, 0.1596],
        [0.1634, 0.1264, 0.0960, 0.1526, 0.1333, 0.1393, 0.1889],
        [0.1816, 0.1592, 0.1083, 0.1181, 0.1846, 0.1181, 0.1301],
        [0.1225, 0.1602, 0.1519, 0.1086, 0.1439, 0.1823, 0.1306],
        [0.1137, 0.1983, 0.1446, 0.1175, 0.1466, 0.1312, 0.1480],
        [0.1581, 0.1271, 0.1278, 0.1232, 0.1911, 0.1034, 0.1692],
        [0.1445, 0.1168, 0.1272, 0.1595, 0.1269, 0.1873, 0.1379]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.172260 f1_test 0.082815 acc_val 0.184433 f1_val 0.079091 acc_train 0.714286 f1_train 0.619048 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:58
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.1196, 0.1417, 0.1423, 0.1502, 0.1251, 0.1895, 0.1317],
        [0.1833, 0.1522, 0.0822, 0.1309, 0.1485, 0.1276, 0.1753],
        [0.1477, 0.1477, 0.0923, 0.1308, 0.2165, 0.0977, 0.1673],
        [0.0990, 0.1918, 0.1761, 0.1264, 0.1286, 0.1690, 0.1091],
        [0.1042, 0.1950, 0.1226, 0.1324, 0.1366, 0.2030, 0.1062],
        [0.1659, 0.1373, 0.0889, 0.1445, 0.1923, 0.1184, 0.1527],
        [0.1087, 0.1472, 0.1273, 0.1646, 0.1429, 0.1958, 0.1135]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.266219 f1_test 0.133687 acc_val 0.099831 f1_val 0.063952 acc_train 0.714286 f1_train 0.642857 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:47
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.1116, 0.1462, 0.1836, 0.1557, 0.1288, 0.1688, 0.1053],
        [0.2379, 0.1248, 0.0764, 0.1003, 0.1948, 0.0738, 0.1921],
        [0.1850, 0.1255, 0.0954, 0.1231, 0.2000, 0.0952, 0.1758],
        [0.0927, 0.1484, 0.1463, 0.1451, 0.1339, 0.2302, 0.1035],
        [0.0625, 0.1422, 0.1347, 0.1141, 0.1144, 0.3442, 0.0880],
        [0.2101, 0.1322, 0.0782, 0.0982, 0.1932, 0.1027, 0.1852],
        [0.0981, 0.1809, 0.1520, 0.1472, 0.1231, 0.1938, 0.1049]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.192394 f1_test 0.084114 acc_val 0.050761 f1_val 0.044013 acc_train 0.714286 f1_train 0.642857 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:36
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0934, 0.1406, 0.1904, 0.2126, 0.1366, 0.1348, 0.0917],
        [0.2557, 0.0813, 0.0651, 0.0892, 0.2901, 0.0616, 0.1571],
        [0.3068, 0.0806, 0.0575, 0.0748, 0.2441, 0.0563, 0.1798],
        [0.0773, 0.1471, 0.1528, 0.2292, 0.0870, 0.2237, 0.0829],
        [0.0636, 0.2163, 0.1445, 0.2027, 0.0789, 0.1985, 0.0956],
        [0.3247, 0.1028, 0.0681, 0.0817, 0.1820, 0.0675, 0.1731],
        [0.0764, 0.1507, 0.1554, 0.1791, 0.0950, 0.2455, 0.0980]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.138702 f1_test 0.075052 acc_val 0.084602 f1_val 0.056885 acc_train 0.714286 f1_train 0.619048 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:25
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0929, 0.1191, 0.2467, 0.1639, 0.1548, 0.1405, 0.0821],
        [0.2729, 0.0606, 0.0500, 0.0485, 0.2571, 0.0455, 0.2655],
        [0.2766, 0.0556, 0.0679, 0.0637, 0.2849, 0.0572, 0.1940],
        [0.0445, 0.1552, 0.2327, 0.1784, 0.0927, 0.2395, 0.0569],
        [0.0511, 0.1907, 0.1975, 0.2227, 0.0822, 0.1786, 0.0772],
        [0.2492, 0.0635, 0.0643, 0.0649, 0.2763, 0.0465, 0.2352],
        [0.0690, 0.1891, 0.1826, 0.1966, 0.0874, 0.2067, 0.0686]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.136465 f1_test 0.090677 acc_val 0.109983 f1_val 0.077138 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:14
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.0977, 0.1315, 0.2622, 0.1384, 0.1745, 0.1165, 0.0791],
        [0.2468, 0.0613, 0.0482, 0.0514, 0.2621, 0.0518, 0.2785],
        [0.2244, 0.0501, 0.0629, 0.0593, 0.2935, 0.0476, 0.2622],
        [0.0434, 0.1360, 0.3169, 0.1827, 0.0633, 0.2168, 0.0409],
        [0.0415, 0.1596, 0.2217, 0.2362, 0.0720, 0.2081, 0.0610],
        [0.2907, 0.0456, 0.0473, 0.0446, 0.2439, 0.0297, 0.2981],
        [0.0370, 0.1579, 0.1976, 0.2597, 0.0737, 0.2224, 0.0518]],
       device='cuda:0')

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.093960 f1_test 0.077811 acc_val 0.137056 f1_val 0.099054 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:02
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
tensor([[0.1139, 0.0869, 0.3090, 0.1701, 0.1166, 0.1236, 0.0798],
        [0.2754, 0.0523, 0.0378, 0.0435, 0.2155, 0.0293, 0.3462],
        [0.2956, 0.0330, 0.0410, 0.0349, 0.2496, 0.0280, 0.3179],
        [0.0506, 0.1885, 0.1652, 0.2724, 0.0771, 0.1914, 0.0547],
        [0.0559, 0.1687, 0.1651, 0.2715, 0.0932, 0.1650, 0.0806],
        [0.2989, 0.0318, 0.0347, 0.0420, 0.2444, 0.0298, 0.3184],
        [0.1090, 0.1751, 0.1223, 0.2785, 0.1061, 0.1254, 0.0836]],
       device='cuda:0')

line 303 => train data수 9
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 8 acc_test 0.062640 f1_test 0.053497 acc_val 0.155668 f1_val 0.081247 acc_train 0.888889 f1_train 0.904762 psl_cor 1 psl_totl 2 pslt_global 0.700000  Tim 0:06:51
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 0.5, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 1, 0, 0, 1, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 1, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.5 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, 0.0, nan, nan, 1.0, nan]
train batch instace수가 7안됨 pass
tensor([[0.0663, 0.0837, 0.4832, 0.1048, 0.0932, 0.1205, 0.0483],
        [0.2208, 0.0594, 0.0380, 0.0327, 0.1826, 0.0306, 0.4359],
        [0.2719, 0.0398, 0.0430, 0.0389, 0.2168, 0.0261, 0.3635],
        [0.0358, 0.1529, 0.2972, 0.1922, 0.0436, 0.2384, 0.0398],
        [0.0230, 0.1702, 0.1870, 0.3083, 0.0421, 0.2309, 0.0385],
        [0.2667, 0.0555, 0.0542, 0.0503, 0.2031, 0.0377, 0.3326],
        [0.0518, 0.1203, 0.1410, 0.2576, 0.0729, 0.3224, 0.0340]],
       device='cuda:0')

line 303 => train data수 17
line 258 => 인스턴스 수 3
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 10 acc_test 0.093960 f1_test 0.065637 acc_val 0.076142 f1_val 0.058957 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 9 pslt_global 0.700000  Tim 0:07:40
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 3, 4, 0, 1, 1, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(이전 PSL 평가에서의 정확도):  0.0 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, 0.0, 0.0, nan, 0.0, 0.0, nan]
train batch instace수가 7안됨 pass
tensor([[0.0246, 0.0436, 0.6818, 0.0677, 0.0507, 0.1106, 0.0211],
        [0.1691, 0.0585, 0.0286, 0.0267, 0.1941, 0.0267, 0.4963],
        [0.1564, 0.0379, 0.0582, 0.0277, 0.4100, 0.0459, 0.2639],
        [0.0295, 0.0753, 0.3344, 0.0949, 0.0487, 0.3757, 0.0415],
        [0.0244, 0.2356, 0.1764, 0.2127, 0.0507, 0.2652, 0.0348],
        [0.1672, 0.0353, 0.0466, 0.0299, 0.3551, 0.0467, 0.3192],
        [0.0381, 0.0717, 0.2207, 0.1231, 0.0570, 0.4440, 0.0454]],
       device='cuda:0')

line 303 => train data수 385
line 258 => 인스턴스 수 55
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 13 acc_test 0.187919 f1_test 0.123455 acc_val 0.099831 f1_val 0.086483 acc_train 0.836364 f1_train 0.769315 psl_cor 79 psl_totl 372 pslt_global 0.700000  Tim 0:08:33
acc_train_cw(현재 train의 class별 acc) [0.702, 0.922, 1.0, 0.6, 0.962, 1.0, 0.989]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [177, 75, 5, 4, 25, 0, 86]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [44, 18, 0, 0, 0, 0, 17]
psl_acc(이전 PSL 평가에서의 정확도):  0.212 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.24858756363391876, 0.23999999463558197, 0.0, 0.0, 0.0, nan, 0.19767442345619202]
tensor([[0.0086, 0.0128, 0.9197, 0.0179, 0.0133, 0.0249, 0.0027],
        [0.0390, 0.0056, 0.0010, 0.0018, 0.0221, 0.0014, 0.9291],
        [0.6677, 0.0037, 0.0033, 0.0038, 0.1528, 0.0048, 0.1638],
        [0.0071, 0.3660, 0.2622, 0.0916, 0.0407, 0.2268, 0.0056],
        [0.0059, 0.6892, 0.1308, 0.1088, 0.0138, 0.0454, 0.0060],
        [0.4558, 0.0048, 0.0030, 0.0037, 0.1240, 0.0040, 0.4048],
        [0.1756, 0.0267, 0.1302, 0.0258, 0.4610, 0.1720, 0.0087]],
       device='cuda:0')
**bs에 맞지않음!!!!!**


line 303 => train data수 3221
line 258 => 인스턴스 수 461
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 68 acc_test 0.078300 f1_test 0.051830 acc_val 0.135364 f1_val 0.086177 acc_train 0.919280 f1_train 0.720706 psl_cor 499 psl_totl 3214 pslt_global 0.700000  Tim 0:10:01
acc_train_cw(현재 train의 class별 acc) [0.994, 0.999, 0.658, 0.0, 0.593, 0.765, 0.968]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [1062, 1074, 476, 0, 77, 186, 339]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [165, 168, 94, 0, 3, 29, 40]
psl_acc(이전 PSL 평가에서의 정확도):  0.155 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [0.15536722540855408, 0.15642458200454712, 0.1974789947271347, nan, 0.03896103799343109, 0.15591397881507874, 0.11799409985542297]
Early stopping trigger at step:  68
Best model at step:  1
**조기종료됨**

가장 높은 acc_val :  0.21489001692047377
tensor([[9.5130e-03, 1.1721e-02, 9.1392e-01, 1.5667e-02, 1.6421e-02, 2.9573e-02,
         3.1818e-03],
        [4.1187e-02, 4.4432e-03, 7.6614e-04, 1.2969e-03, 2.6228e-02, 9.5103e-04,
         9.2513e-01],
        [6.7585e-01, 3.0191e-03, 2.7611e-03, 5.1386e-03, 1.4234e-01, 4.9334e-03,
         1.6596e-01],
        [8.0497e-03, 4.3250e-01, 1.7482e-01, 9.1350e-02, 4.3515e-02, 2.4513e-01,
         4.6387e-03],
        [1.1450e-02, 7.6713e-01, 6.9947e-02, 8.7929e-02, 1.4024e-02, 3.7576e-02,
         1.1945e-02],
        [4.8786e-01, 3.6479e-03, 3.0730e-03, 3.8751e-03, 1.3041e-01, 3.0505e-03,
         3.6808e-01],
        [1.6630e-01, 5.8830e-02, 1.4879e-01, 4.7802e-02, 3.2444e-01, 2.2842e-01,
         2.5418e-02]], device='cuda:0')
**bs에 맞지않음!!!!!**

acc_val 증가안된 epoch시점 :  2
early_stop_flag

Training complete!
Total training took 0:10:38 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codebert-base_0.0001_0.7_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240404-203028/0/training_statistics.csv

Best_step:  1 
best_test_acc:  0.15883668903803133 
best_test_f1:  0.07280594356948078
Save best record in:  ./experiment/few_shot/log/20240404-203028/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
