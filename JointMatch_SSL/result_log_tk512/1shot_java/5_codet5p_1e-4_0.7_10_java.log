current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/code
java_extended_data
save_name: 5_codet5p-110m-embedding_0.0001_0.7_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  5
train_df samples: 3851
train_labeled_df samples: 35
train_unlabeled_df samples: 3816
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0001

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.257271 f1_test 0.084358 acc_val 0.081218 f1_val 0.054519 acc_train 0.114286 f1_train 0.056049 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:13
acc_train_cw(현재 train의 class별 acc) [0.0, 0.4, 0.0, 0.0, 0.0, 0.4, 0.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
loss ->  tensor(1.9264, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9583, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9631, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9566, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(2.0207, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1514, 0.1517, 0.1286, 0.1437, 0.1447, 0.1298, 0.1501],
        [0.1490, 0.1522, 0.1303, 0.1471, 0.1429, 0.1283, 0.1502],
        [0.1504, 0.1583, 0.1228, 0.1446, 0.1478, 0.1255, 0.1505],
        [0.1535, 0.1547, 0.1265, 0.1439, 0.1429, 0.1269, 0.1516],
        [0.1558, 0.1490, 0.1261, 0.1413, 0.1506, 0.1266, 0.1507],
        [0.1455, 0.1500, 0.1275, 0.1487, 0.1480, 0.1245, 0.1559],
        [0.1608, 0.1580, 0.1240, 0.1416, 0.1444, 0.1281, 0.1431]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.129754 f1_test 0.070166 acc_val 0.182741 f1_val 0.115423 acc_train 0.571429 f1_train 0.481142 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:08
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 0.0, 0.6, 0.4, 0.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
loss ->  tensor(1.8636, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.9209, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.8860, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.8570, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.8965, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1327, 0.1386, 0.1399, 0.1471, 0.1499, 0.1381, 0.1537],
        [0.1310, 0.1381, 0.1397, 0.1494, 0.1417, 0.1507, 0.1494],
        [0.1275, 0.1457, 0.1332, 0.1494, 0.1485, 0.1408, 0.1549],
        [0.1324, 0.1387, 0.1415, 0.1539, 0.1371, 0.1383, 0.1581],
        [0.1394, 0.1335, 0.1397, 0.1422, 0.1500, 0.1387, 0.1565],
        [0.1189, 0.1363, 0.1381, 0.1511, 0.1489, 0.1365, 0.1701],
        [0.1428, 0.1474, 0.1305, 0.1500, 0.1462, 0.1364, 0.1467]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.114094 f1_test 0.126862 acc_val 0.157360 f1_val 0.128573 acc_train 0.771429 f1_train 0.781746 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:07
acc_train_cw(현재 train의 class별 acc) [1.0, 0.6, 0.6, 0.8, 0.8, 0.6, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
loss ->  tensor(1.8585, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.7666, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.8219, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.7729, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.7839, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1395, 0.1415, 0.1584, 0.1330, 0.1515, 0.1405, 0.1355],
        [0.1327, 0.1440, 0.1580, 0.1374, 0.1378, 0.1628, 0.1273],
        [0.1295, 0.1516, 0.1485, 0.1522, 0.1432, 0.1419, 0.1331],
        [0.1412, 0.1406, 0.1629, 0.1387, 0.1392, 0.1433, 0.1343],
        [0.1568, 0.1313, 0.1494, 0.1311, 0.1520, 0.1456, 0.1338],
        [0.1173, 0.1351, 0.1469, 0.1404, 0.1537, 0.1425, 0.1640],
        [0.1669, 0.1524, 0.1430, 0.1325, 0.1431, 0.1420, 0.1199]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 15 acc_test 0.281879 f1_test 0.213633 acc_val 0.233503 f1_val 0.167585 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:00
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
loss ->  tensor(1.7268, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6824, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.7258, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.7078, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6932, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1294, 0.1549, 0.1459, 0.1351, 0.1541, 0.1455, 0.1350],
        [0.1176, 0.1506, 0.1573, 0.1387, 0.1439, 0.1640, 0.1279],
        [0.1162, 0.1735, 0.1310, 0.1525, 0.1446, 0.1469, 0.1354],
        [0.1302, 0.1469, 0.1519, 0.1432, 0.1456, 0.1375, 0.1447],
        [0.1603, 0.1423, 0.1410, 0.1288, 0.1531, 0.1471, 0.1273],
        [0.1152, 0.1429, 0.1342, 0.1440, 0.1585, 0.1378, 0.1673],
        [0.1688, 0.1617, 0.1325, 0.1348, 0.1389, 0.1433, 0.1200]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 20 acc_test 0.232662 f1_test 0.195573 acc_val 0.297800 f1_val 0.211539 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:58
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
loss ->  tensor(1.6595, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6348, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6504, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6114, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6274, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1281, 0.1428, 0.1576, 0.1308, 0.1488, 0.1558, 0.1360],
        [0.1204, 0.1364, 0.1673, 0.1385, 0.1384, 0.1722, 0.1268],
        [0.1167, 0.1767, 0.1374, 0.1383, 0.1533, 0.1542, 0.1235],
        [0.1276, 0.1303, 0.1732, 0.1364, 0.1507, 0.1370, 0.1449],
        [0.1622, 0.1284, 0.1480, 0.1231, 0.1601, 0.1471, 0.1312],
        [0.1149, 0.1322, 0.1400, 0.1470, 0.1590, 0.1389, 0.1680],
        [0.1563, 0.1432, 0.1416, 0.1332, 0.1540, 0.1485, 0.1232]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 25 acc_test 0.259508 f1_test 0.208108 acc_val 0.277496 f1_val 0.208045 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:57
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
loss ->  tensor(1.5818, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.6062, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5881, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5821, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5668, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1251, 0.1399, 0.1646, 0.1249, 0.1565, 0.1583, 0.1308],
        [0.1140, 0.1457, 0.1776, 0.1349, 0.1380, 0.1700, 0.1199],
        [0.1157, 0.1870, 0.1357, 0.1405, 0.1482, 0.1562, 0.1168],
        [0.1265, 0.1292, 0.1713, 0.1316, 0.1638, 0.1281, 0.1496],
        [0.1757, 0.1278, 0.1468, 0.1215, 0.1556, 0.1485, 0.1242],
        [0.1128, 0.1412, 0.1333, 0.1492, 0.1564, 0.1440, 0.1631],
        [0.1702, 0.1521, 0.1468, 0.1321, 0.1422, 0.1462, 0.1103]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 30 acc_test 0.272931 f1_test 0.221179 acc_val 0.292724 f1_val 0.219046 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:50
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
loss ->  tensor(1.5400, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5336, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5449, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5231, device='cuda:0', grad_fn=<NllLossBackward0>) 

loss ->  tensor(1.5254, device='cuda:0', grad_fn=<NllLossBackward0>) 

tensor([[0.1213, 0.1533, 0.1600, 0.1305, 0.1538, 0.1453, 0.1358],
        [0.1080, 0.1599, 0.1661, 0.1366, 0.1344, 0.1695, 0.1254],
        [0.1140, 0.1996, 0.1210, 0.1410, 0.1543, 0.1491, 0.1211],
        [0.1256, 0.1403, 0.1570, 0.1363, 0.1673, 0.1235, 0.1500],
        [0.1693, 0.1271, 0.1393, 0.1291, 0.1786, 0.1288, 0.1278],
        [0.1107, 0.1520, 0.1227, 0.1503, 0.1675, 0.1352, 0.1617],
        [0.1628, 0.1634, 0.1331, 0.1313, 0.1559, 0.1386, 0.1148]],
       device='cuda:0')

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 35 acc_test 0.248322 f1_test 0.202908 acc_val 0.304569 f1_val 0.210256 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:06:44
acc_train_cw(현재 train의 class별 acc) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_total_eval(이전 pseudo label 클래스별 총 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
cw_psl_correct_eval(이전 pseudo label 클래스별 맞은 샘플 수):  [0, 0, 0, 0, 0, 0, 0]
psl_acc(PSL 평가에서의 정확도): None 
cw_psl_acc(이전 클래스별 PSL 평가에서의 정확도):  [nan, nan, nan, nan, nan, nan, nan]
