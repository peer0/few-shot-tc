current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  10
train_df samples: 3974
train_labeled_df samples: 70
train_unlabeled_df samples: 3904
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  1e-05

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:17
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.297131 f1_test 0.065552 acc_val 0.026059 f1_val 0.007256 acc_train 0.634803 f1_train 0.110962 psl_cor 495 psl_totl 3904 pslt_global 0.000000  Tim 0:01:40
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.998, 0.0]
cw_psl_eval:  [160, 3, 6, 632, 34, 2513, 556] [49, 0, 1, 96, 5, 271, 73]
psl_acc:  0.127 cw_psl_acc:  [0.3062500059604645, 0.0, 0.1666666716337204, 0.15189872682094574, 0.14705882966518402, 0.10783923417329788, 0.13129496574401855]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 568 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:04:46
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 1126 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:07:52
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 1684 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:10:57
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 2242 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:14:02
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 2800 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:16:06
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 3358 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:17:39
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 3916 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:19:11
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 4474 acc_test 0.297131 f1_test 0.065448 acc_val 0.026059 f1_val 0.007256 acc_train 0.985905 f1_train 0.141843 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:20:43
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3904, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.10655737668275833, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 5032 acc_test 0.297131 f1_test 0.065655 acc_val 0.026059 f1_val 0.007279 acc_train 0.992568 f1_train 0.647836 psl_cor 416 psl_totl 3904 pslt_global 0.000000  Tim 0:22:16
acc_train_cw [0.7, 0.5, 0.6, 0.111, 0.8, 0.999, 0.333]
cw_psl_eval:  [1, 0, 0, 0, 0, 3903, 0] [0, 0, 0, 0, 0, 416, 0]
psl_acc:  0.107 cw_psl_acc:  [0.0, nan, nan, nan, nan, 0.10658467561006546, nan]
Early stopping trigger at step:  5032
Best model at step:  0
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  12 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:22:33 (h:mm:ss)
Load model from ./experiment/few_shot/output/python_extended_data_codebert-base_10_0_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240327-200619/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.29713114754098363 
best_test_f1:  0.06544798013992327
Save best record in:  ./experiment/few_shot/log/20240327-200619/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
