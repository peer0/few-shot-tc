current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../codecomplex_java

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  10
train_df samples: 3911
train_labeled_df samples: 70
train_unlabeled_df samples: 3841
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  1e-05

line 257 => epoch 0
line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.145194 f1_test 0.116167 acc_val 0.134969 f1_val 0.108624 acc_train 0.185714 f1_train 0.137009 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:18
acc_train_cw [0.3, 0.1, 0.0, 0.5, 0.0, 0.4, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 1
line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 10 acc_test 0.186094 f1_test 0.114863 acc_val 0.177914 f1_val 0.108648 acc_train 0.328571 f1_train 0.269781 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:08
acc_train_cw [0.1, 0.0, 0.8, 0.2, 0.1, 0.8, 0.3]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 2
line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 20 acc_test 0.249489 f1_test 0.226695 acc_val 0.239264 f1_val 0.215793 acc_train 0.614286 f1_train 0.612155 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:45
acc_train_cw [0.6, 0.5, 0.3, 0.8, 0.8, 0.5, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 3
line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 30 acc_test 0.282209 f1_test 0.280609 acc_val 0.269939 f1_val 0.265280 acc_train 0.757143 f1_train 0.760426 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:21
acc_train_cw [0.7, 0.7, 0.7, 0.8, 0.8, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 4
line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 40 acc_test 0.327198 f1_test 0.317178 acc_val 0.310838 f1_val 0.300538 acc_train 0.842857 f1_train 0.841803 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:59
acc_train_cw [1.0, 0.8, 0.7, 0.8, 0.9, 0.9, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 257 => epoch 5
line 303 => train data수 74
line 258 => 인스턴스 수 11
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 50 acc_test 0.321063 f1_test 0.311273 acc_val 0.321063 f1_val 0.319141 acc_train 0.932432 f1_train 0.932471 psl_cor 4 psl_totl 4 pslt_global 0.700000  Tim 0:03:49
acc_train_cw [0.923, 1.0, 0.9, 0.909, 0.8, 1.0, 1.0]
cw_psl_eval:  [3, 0, 0, 1, 0, 0, 0] [3, 0, 0, 1, 0, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [1.0, nan, nan, 1.0, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 257 => epoch 6
line 303 => train data수 83
line 258 => 인스턴스 수 12
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 61 acc_test 0.347648 f1_test 0.338624 acc_val 0.337423 f1_val 0.324067 acc_train 0.963855 f1_train 0.967171 psl_cor 9 psl_totl 15 pslt_global 0.700000  Tim 0:04:46
acc_train_cw [1.0, 1.0, 0.9, 0.947, 0.9, 1.0, 1.0]
cw_psl_eval:  [3, 0, 0, 8, 0, 0, 0] [3, 0, 0, 6, 0, 0, 0]
psl_acc:  0.6 cw_psl_acc:  [1.0, nan, nan, 0.75, nan, nan, nan]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 257 => epoch 7
line 303 => train data수 312
line 258 => 인스턴스 수 45
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 73 acc_test 0.333333 f1_test 0.315395 acc_val 0.316973 f1_val 0.299347 acc_train 0.983974 f1_train 0.975290 psl_cor 174 psl_totl 254 pslt_global 0.700000  Tim 0:05:46
acc_train_cw [0.993, 0.85, 1.0, 1.0, 0.923, 1.0, 1.0]
cw_psl_eval:  [137, 10, 5, 68, 3, 10, 6] [115, 9, 4, 39, 0, 4, 3]
psl_acc:  0.685 cw_psl_acc:  [0.8394160866737366, 0.8999999761581421, 0.800000011920929, 0.5735294222831726, 0.0, 0.4000000059604645, 0.5]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 8
line 303 => train data수 1588
line 258 => 인스턴스 수 227
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 118 acc_test 0.347648 f1_test 0.328303 acc_val 0.331288 f1_val 0.307543 acc_train 0.935768 f1_train 0.909619 psl_cor 842 psl_totl 1769 pslt_global 0.700000  Tim 0:06:48
acc_train_cw [0.996, 0.752, 0.766, 1.0, 0.992, 0.979, 0.812]
cw_psl_eval:  [479, 136, 144, 400, 110, 129, 117] [317, 86, 65, 269, 31, 32, 42]
psl_acc:  0.476 cw_psl_acc:  [0.6617953777313232, 0.6323529481887817, 0.4513888955116272, 0.6725000143051147, 0.2818181812763214, 0.24806201457977295, 0.3589743673801422]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 9
line 303 => train data수 3215
line 258 => 인스턴스 수 460
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 345 acc_test 0.361963 f1_test 0.346269 acc_val 0.353783 f1_val 0.352397 acc_train 0.953966 f1_train 0.950059 psl_cor 1275 psl_totl 4891 pslt_global 0.700000  Tim 0:08:29
acc_train_cw [0.996, 0.847, 0.96, 0.993, 0.973, 0.889, 0.97]
cw_psl_eval:  [674, 334, 464, 439, 404, 387, 420] [354, 167, 152, 292, 104, 87, 119]
psl_acc:  0.261 cw_psl_acc:  [0.5252225399017334, 0.5, 0.32758620381355286, 0.6651480793952942, 0.2574257552623749, 0.22480620443820953, 0.28333333134651184]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 10
line 303 => train data수 3673
line 258 => 인스턴스 수 525
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 805 acc_test 0.351738 f1_test 0.347506 acc_val 0.353783 f1_val 0.353984 acc_train 0.975225 f1_train 0.973976 psl_cor 1363 psl_totl 8432 pslt_global 0.700000  Tim 0:10:55
acc_train_cw [0.994, 0.891, 0.978, 0.994, 0.995, 0.97, 0.982]
cw_psl_eval:  [662, 368, 532, 453, 433, 549, 544] [352, 179, 165, 293, 114, 115, 145]
psl_acc:  0.162 cw_psl_acc:  [0.5317220687866211, 0.48641303181648254, 0.3101503849029541, 0.6467990875244141, 0.26327943801879883, 0.20947176218032837, 0.2665441036224365]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 11
line 303 => train data수 3823
line 258 => 인스턴스 수 547
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 1330 acc_test 0.341513 f1_test 0.338926 acc_val 0.351738 f1_val 0.350207 acc_train 0.980643 f1_train 0.980479 psl_cor 1387 psl_totl 12123 pslt_global 0.700000  Tim 0:13:30
acc_train_cw [0.997, 0.943, 0.975, 0.996, 0.991, 0.981, 0.974]
cw_psl_eval:  [672, 423, 535, 454, 435, 622, 550] [349, 198, 159, 294, 116, 127, 144]
psl_acc:  0.114 cw_psl_acc:  [0.519345223903656, 0.4680851101875305, 0.29719626903533936, 0.6475771069526672, 0.2666666805744171, 0.2041800618171692, 0.26181817054748535]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 12
line 303 => train data수 3864
line 258 => 인스턴스 수 552
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 1877 acc_test 0.353783 f1_test 0.350796 acc_val 0.357873 f1_val 0.352326 acc_train 0.982143 f1_train 0.982260 psl_cor 1412 psl_totl 15825 pslt_global 0.700000  Tim 0:16:05
acc_train_cw [0.997, 0.955, 0.972, 0.998, 0.998, 0.969, 0.988]
cw_psl_eval:  [673, 500, 487, 459, 435, 608, 540] [356, 226, 149, 294, 116, 123, 148]
psl_acc:  0.089 cw_psl_acc:  [0.528974711894989, 0.4519999921321869, 0.30595481395721436, 0.6405228972434998, 0.2666666805744171, 0.20230263471603394, 0.27407407760620117]
Save model to ./experiment/few_shot/output/
**bs에 맞지않음!!!!!**


line 257 => epoch 13
line 303 => train data수 3885
line 258 => 인스턴스 수 555
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 2429 acc_test 0.343558 f1_test 0.342689 acc_val 0.347648 f1_val 0.348432 acc_train 0.982239 f1_train 0.982217 psl_cor 1439 psl_totl 19581 pslt_global 0.700000  Tim 0:18:51
acc_train_cw [0.991, 0.944, 0.985, 0.998, 0.994, 0.98, 0.982]
cw_psl_eval:  [650, 473, 533, 456, 455, 644, 545] [351, 222, 167, 294, 121, 131, 153]
psl_acc:  0.073 cw_psl_acc:  [0.5400000214576721, 0.4693446159362793, 0.3133208155632019, 0.6447368264198303, 0.2659340798854828, 0.2034161537885666, 0.28073394298553467]
**bs에 맞지않음!!!!!**


line 257 => epoch 14
line 303 => train data수 3895
line 258 => 인스턴스 수 557
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 2984 acc_test 0.353783 f1_test 0.351891 acc_val 0.347648 f1_val 0.347578 acc_train 0.986650 f1_train 0.986777 psl_cor 1456 psl_totl 23364 pslt_global 0.700000  Tim 0:21:31
acc_train_cw [0.994, 0.957, 0.991, 0.998, 0.996, 0.982, 0.989]
cw_psl_eval:  [646, 489, 526, 462, 461, 642, 557] [353, 237, 166, 295, 123, 128, 154]
psl_acc:  0.062 cw_psl_acc:  [0.5464396476745605, 0.48466256260871887, 0.31558936834335327, 0.6385281682014465, 0.2668112814426422, 0.1993769407272339, 0.27648115158081055]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 15
line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 3541 acc_test 0.341513 f1_test 0.341210 acc_val 0.347648 f1_val 0.345860 acc_train 0.992308 f1_train 0.992285 psl_cor 1450 psl_totl 27185 pslt_global 0.700000  Tim 0:24:13
acc_train_cw [0.999, 0.974, 0.989, 0.998, 0.996, 0.994, 0.995]
cw_psl_eval:  [662, 485, 538, 460, 460, 660, 556] [354, 231, 165, 294, 122, 132, 152]
psl_acc:  0.053 cw_psl_acc:  [0.5347431898117065, 0.47628864645957947, 0.306691437959671, 0.6391304135322571, 0.2652173936367035, 0.20000000298023224, 0.2733812928199768]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 16
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 4099 acc_test 0.343558 f1_test 0.340224 acc_val 0.349693 f1_val 0.345084 acc_train 0.992310 f1_train 0.992345 psl_cor 1462 psl_totl 31005 pslt_global 0.700000  Tim 0:26:55
acc_train_cw [1.0, 0.982, 0.993, 1.0, 0.998, 0.99, 0.983]
cw_psl_eval:  [664, 501, 537, 461, 454, 681, 522] [356, 237, 168, 294, 123, 134, 150]
psl_acc:  0.047 cw_psl_acc:  [0.5361445546150208, 0.473053902387619, 0.31284916400909424, 0.6377440094947815, 0.2709251046180725, 0.19676946103572845, 0.28735631704330444]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 17
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 4657 acc_test 0.357873 f1_test 0.355310 acc_val 0.351738 f1_val 0.352210 acc_train 0.997180 f1_train 0.997191 psl_cor 1455 psl_totl 34835 pslt_global 0.700000  Tim 0:29:28
acc_train_cw [1.0, 0.992, 0.998, 1.0, 0.998, 0.999, 0.993]
cw_psl_eval:  [663, 498, 540, 460, 458, 670, 541] [355, 232, 167, 294, 123, 132, 152]
psl_acc:  0.042 cw_psl_acc:  [0.535444974899292, 0.4658634662628174, 0.3092592656612396, 0.6391304135322571, 0.26855894923210144, 0.1970149278640747, 0.28096118569374084]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 18
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 5215 acc_test 0.345603 f1_test 0.343578 acc_val 0.349693 f1_val 0.340354 acc_train 0.981543 f1_train 0.981164 psl_cor 1444 psl_totl 38607 pslt_global 0.700000  Tim 0:32:13
acc_train_cw [0.999, 0.951, 0.955, 1.0, 1.0, 0.981, 0.986]
cw_psl_eval:  [656, 560, 424, 452, 447, 691, 542] [354, 248, 133, 293, 121, 143, 152]
psl_acc:  0.037 cw_psl_acc:  [0.5396341681480408, 0.44285714626312256, 0.3136792480945587, 0.6482300758361816, 0.27069351077079773, 0.2069464474916458, 0.2804428040981293]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 19
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 5773 acc_test 0.361963 f1_test 0.361029 acc_val 0.353783 f1_val 0.351482 acc_train 0.992822 f1_train 0.992892 psl_cor 1457 psl_totl 42418 pslt_global 0.700000  Tim 0:34:58
acc_train_cw [0.998, 0.975, 0.996, 0.998, 0.998, 0.994, 0.991]
cw_psl_eval:  [639, 550, 478, 455, 446, 690, 553] [348, 244, 153, 294, 122, 141, 155]
psl_acc:  0.034 cw_psl_acc:  [0.5446009635925293, 0.44363635778427124, 0.3200836777687073, 0.6461538672447205, 0.2735426127910614, 0.20434781908988953, 0.28028932213783264]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 20
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 6331 acc_test 0.331288 f1_test 0.329466 acc_val 0.341513 f1_val 0.335773 acc_train 0.993079 f1_train 0.993294 psl_cor 1455 psl_totl 46243 pslt_global 0.700000  Tim 0:37:41
acc_train_cw [0.999, 0.97, 0.992, 1.0, 0.998, 0.996, 0.998]
cw_psl_eval:  [658, 557, 462, 455, 449, 693, 551] [351, 242, 148, 294, 122, 143, 155]
psl_acc:  0.031 cw_psl_acc:  [0.5334346294403076, 0.43447038531303406, 0.32034632563591003, 0.6461538672447205, 0.2717149257659912, 0.2063492089509964, 0.2813067138195038]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 21
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 6889 acc_test 0.361963 f1_test 0.358861 acc_val 0.353783 f1_val 0.352331 acc_train 0.995129 f1_train 0.995207 psl_cor 1456 psl_totl 50064 pslt_global 0.700000  Tim 0:39:57
acc_train_cw [0.998, 0.984, 0.982, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [648, 561, 483, 455, 449, 685, 540] [346, 246, 155, 294, 122, 139, 154]
psl_acc:  0.029 cw_psl_acc:  [0.5339506268501282, 0.4385026693344116, 0.3209109604358673, 0.6461538672447205, 0.2717149257659912, 0.20291970670223236, 0.28518518805503845]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 257 => epoch 22
line 303 => train data수 3901
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 7447 acc_test 0.357873 f1_test 0.355646 acc_val 0.351738 f1_val 0.347395 acc_train 0.996155 f1_train 0.996095 psl_cor 1460 psl_totl 53896 pslt_global 0.700000  Tim 0:41:34
acc_train_cw [0.998, 0.993, 0.998, 1.0, 1.0, 0.994, 0.991]
cw_psl_eval:  [652, 566, 484, 454, 443, 689, 544] [348, 247, 155, 294, 121, 141, 154]
psl_acc:  0.027 cw_psl_acc:  [0.5337423086166382, 0.4363957643508911, 0.32024794816970825, 0.6475771069526672, 0.2731376886367798, 0.20464441180229187, 0.28308823704719543]
Early stopping trigger at step:  7447
Best model at step:  1877
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  23 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:41:53 (h:mm:ss)
Load model from ./experiment/few_shot/output/codecomplex_java_unixcoder-base_10_0.7_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240327-010048/0/training_statistics.csv

Best_step:  1877 
best_test_acc:  0.3537832310838446 
best_test_f1:  0.3507957900447357
Save best record in:  ./experiment/few_shot/log/20240327-010048/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
