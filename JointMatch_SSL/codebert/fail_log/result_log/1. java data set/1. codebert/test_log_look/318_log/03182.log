current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data_split

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090
n_labeled_per_class:  1
train_df samples: 3911
train_labeled_df samples: 7
train_unlabeled_df samples: 3904
Check n_smaples_per_class in the original training set:  {1: 600, 2: 560, 3: 622, 4: 560, 5: 610, 6: 477, 7: 482}
Check n_smaples_per_class in the labeled training set:  {1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1}
Check n_smaples_per_class in the unlabeled training set:  {1: 599, 2: 559, 3: 621, 4: 559, 5: 609, 6: 476, 7: 481}
n_classes:  7
#####모델 microsoft/codebert-base
net_arch:  microsoft/codebert-base lr:  1e-05
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.134969 f1_test 0.057090 acc_val 0.116564 f1_val 0.048973 acc_train 0.142857 f1_train 0.040816 psl_cor 0 psl_totl 0 pslt_global 0.000000 Tim 0:00:45
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 25 acc_test 0.216769 f1_test 0.186174 acc_val 0.196319 f1_val 0.164976 acc_train 1.000000 f1_train 1.000000 psl_cor 20 psl_totl 34 pslt_global 0.980000 Tim 0:02:01
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [22, 2, 0, 1, 2, 1, 6] [18, 0, 0, 1, 0, 0, 1]
psl_acc:  0.588 cw_psl_acc:  [0.8181818127632141, 0.0, nan, 1.0, 0.0, 0.0, 0.1666666716337204]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 50 Step 50 acc_test 0.206544 f1_test 0.179969 acc_val 0.173824 f1_val 0.148390 acc_train 1.000000 f1_train 1.000000 psl_cor 135 psl_totl 389 pslt_global 0.980000 Tim 0:03:24
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [87, 48, 0, 80, 75, 12, 87] [70, 5, 0, 18, 15, 0, 27]
psl_acc:  0.347 cw_psl_acc:  [0.8045976758003235, 0.1041666641831398, nan, 0.22499999403953552, 0.20000000298023224, 0.0, 0.3103448152542114]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 75 Step 75 acc_test 0.222904 f1_test 0.195498 acc_val 0.186094 f1_val 0.157726 acc_train 1.000000 f1_train 1.000000 psl_cor 198 psl_totl 687 pslt_global 0.980000 Tim 0:04:39
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [104, 66, 0, 175, 105, 13, 224] [86, 9, 0, 38, 8, 1, 56]
psl_acc:  0.288 cw_psl_acc:  [0.8269230723381042, 0.13636364042758942, nan, 0.21714285016059875, 0.07619047909975052, 0.07692307978868484, 0.25]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 100 Step 100 acc_test 0.216769 f1_test 0.189878 acc_val 0.190184 f1_val 0.165391 acc_train 1.000000 f1_train 1.000000 psl_cor 201 psl_totl 772 pslt_global 0.980000 Tim 0:05:56
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [106, 43, 0, 237, 121, 6, 259] [85, 7, 0, 31, 24, 0, 54]
psl_acc:  0.26 cw_psl_acc:  [0.801886796951294, 0.1627907007932663, nan, 0.13080169260501862, 0.19834710657596588, 0.0, 0.20849420130252838]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 125 Step 125 acc_test 0.220859 f1_test 0.190905 acc_val 0.182004 f1_val 0.151683 acc_train 1.000000 f1_train 1.000000 psl_cor 226 psl_totl 852 pslt_global 0.980000 Tim 0:07:11
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [108, 62, 0, 252, 129, 10, 291] [83, 14, 0, 40, 15, 0, 74]
psl_acc:  0.265 cw_psl_acc:  [0.7685185074806213, 0.22580644488334656, nan, 0.1587301641702652, 0.11627907305955887, 0.0, 0.2542955279350281]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 150 Step 150 acc_test 0.218814 f1_test 0.190352 acc_val 0.179959 f1_val 0.153004 acc_train 1.000000 f1_train 1.000000 psl_cor 232 psl_totl 847 pslt_global 0.980000 Tim 0:08:27
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [110, 56, 1, 257, 99, 8, 316] [89, 13, 0, 46, 15, 1, 68]
psl_acc:  0.274 cw_psl_acc:  [0.8090909123420715, 0.2321428507566452, 0.0, 0.17898832261562347, 0.1515151560306549, 0.125, 0.2151898741722107]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 175 Step 175 acc_test 0.220859 f1_test 0.191644 acc_val 0.179959 f1_val 0.152108 acc_train 1.000000 f1_train 1.000000 psl_cor 215 psl_totl 850 pslt_global 0.980000 Tim 0:09:43
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [99, 49, 8, 274, 127, 8, 285] [80, 10, 0, 46, 14, 0, 65]
psl_acc:  0.253 cw_psl_acc:  [0.808080792427063, 0.20408163964748383, 0.0, 0.16788321733474731, 0.11023622006177902, 0.0, 0.22807016968727112]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 200 Step 200 acc_test 0.210634 f1_test 0.183705 acc_val 0.188139 f1_val 0.163261 acc_train 1.000000 f1_train 1.000000 psl_cor 215 psl_totl 866 pslt_global 0.980000 Tim 0:10:59
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [94, 69, 5, 275, 108, 8, 307] [79, 15, 0, 41, 15, 0, 65]
psl_acc:  0.248 cw_psl_acc:  [0.8404255509376526, 0.21739129722118378, 0.0, 0.14909091591835022, 0.1388888955116272, 0.0, 0.2117263823747635]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 225 Step 225 acc_test 0.231084 f1_test 0.200295 acc_val 0.186094 f1_val 0.159975 acc_train 1.000000 f1_train 1.000000 psl_cor 242 psl_totl 926 pslt_global 0.980000 Tim 0:12:14
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [117, 62, 4, 272, 137, 9, 325] [94, 15, 1, 32, 21, 1, 78]
psl_acc:  0.261 cw_psl_acc:  [0.8034188151359558, 0.24193547666072845, 0.25, 0.11764705926179886, 0.15328466892242432, 0.1111111119389534, 0.23999999463558197]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 250 Step 250 acc_test 0.222904 f1_test 0.193444 acc_val 0.182004 f1_val 0.154676 acc_train 1.000000 f1_train 1.000000 psl_cor 223 psl_totl 948 pslt_global 0.980000 Tim 0:13:29
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [98, 50, 17, 284, 128, 6, 365] [77, 8, 2, 39, 17, 0, 80]
psl_acc:  0.235 cw_psl_acc:  [0.7857142686843872, 0.1599999964237213, 0.11764705926179886, 0.13732394576072693, 0.1328125, 0.0, 0.21917808055877686]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 275 Step 275 acc_test 0.212679 f1_test 0.185943 acc_val 0.182004 f1_val 0.156475 acc_train 1.000000 f1_train 1.000000 psl_cor 248 psl_totl 964 pslt_global 0.980000 Tim 0:14:44
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [106, 75, 25, 284, 109, 11, 354] [88, 19, 2, 45, 16, 0, 78]
psl_acc:  0.257 cw_psl_acc:  [0.8301886916160583, 0.25333333015441895, 0.07999999821186066, 0.15845070779323578, 0.14678898453712463, 0.0, 0.22033898532390594]
Early stopping trigger at step:  275
Best model at step:  25

Training complete!
Total training took 0:14:44 (h:mm:ss)
Load model from ./experiment/test/output/model_net0.pth
Save training statistics in:  ./experiment/test/log/20240318-144501/0/training_statistics.csv

Best_step:  25 
best_test_acc:  0.2167689161554192 
best_test_f1:  0.18617395536590392
Save best record in:  ./experiment/test/log/20240318-144501/summary.csv
Save best record in:  ./experiment/test/log/summary_avgrun.csv
