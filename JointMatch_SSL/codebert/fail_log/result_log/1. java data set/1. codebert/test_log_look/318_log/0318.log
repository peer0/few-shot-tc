current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data_split

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090
n_labeled_per_class:  1
train_df samples: 3911
train_labeled_df samples: 7
train_unlabeled_df samples: 3904
Check n_smaples_per_class in the original training set:  {1: 600, 2: 560, 3: 622, 4: 560, 5: 610, 6: 477, 7: 482}
Check n_smaples_per_class in the labeled training set:  {1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1}
Check n_smaples_per_class in the unlabeled training set:  {1: 599, 2: 559, 3: 621, 4: 559, 5: 609, 6: 476, 7: 481}
n_classes:  7
#####모델 microsoft/codebert-base
net_arch:  microsoft/codebert-base lr:  1e-05
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.134969 f1_test 0.057090 acc_val 0.116564 f1_val 0.048973 acc_train 0.142857 f1_train 0.040816 psl_cor 0 psl_totl 0 pslt_global 0.000000 Tim 0:00:45
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 25 acc_test 0.216769 f1_test 0.186174 acc_val 0.196319 f1_val 0.164976 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 7.000000 Tim 0:02:02
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 50 Step 50 acc_test 0.206544 f1_test 0.179969 acc_val 0.173824 f1_val 0.148390 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 1 pslt_global 7.000000 Tim 0:03:24
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 1, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 75 Step 75 acc_test 0.222904 f1_test 0.195498 acc_val 0.186094 f1_val 0.157726 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 6 pslt_global 7.000000 Tim 0:04:39
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 6, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 100 Step 100 acc_test 0.216769 f1_test 0.189878 acc_val 0.190184 f1_val 0.165391 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 5 pslt_global 7.000000 Tim 0:05:55
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 5, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 125 Step 125 acc_test 0.220859 f1_test 0.190905 acc_val 0.182004 f1_val 0.151683 acc_train 1.000000 f1_train 1.000000 psl_cor 1 psl_totl 9 pslt_global 7.000000 Tim 0:07:09
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [1, 0, 0, 0, 0, 8, 0] [1, 0, 0, 0, 0, 0, 0]
psl_acc:  0.111 cw_psl_acc:  [1.0, nan, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 150 Step 150 acc_test 0.218814 f1_test 0.190352 acc_val 0.179959 f1_val 0.153004 acc_train 1.000000 f1_train 1.000000 psl_cor 2 psl_totl 10 pslt_global 7.000000 Tim 0:08:25
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [1, 2, 0, 0, 0, 7, 0] [0, 1, 0, 0, 0, 1, 0]
psl_acc:  0.2 cw_psl_acc:  [0.0, 0.5, nan, nan, nan, 0.1428571492433548, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 175 Step 175 acc_test 0.220859 f1_test 0.191644 acc_val 0.179959 f1_val 0.152108 acc_train 1.000000 f1_train 1.000000 psl_cor 4 psl_totl 13 pslt_global 7.000000 Tim 0:09:40
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [4, 2, 0, 0, 0, 7, 0] [4, 0, 0, 0, 0, 0, 0]
psl_acc:  0.308 cw_psl_acc:  [1.0, 0.0, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 200 Step 200 acc_test 0.210634 f1_test 0.183705 acc_val 0.188139 f1_val 0.163261 acc_train 1.000000 f1_train 1.000000 psl_cor 7 psl_totl 20 pslt_global 7.000000 Tim 0:10:56
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [7, 5, 0, 0, 0, 8, 0] [6, 1, 0, 0, 0, 0, 0]
psl_acc:  0.35 cw_psl_acc:  [0.8571428656578064, 0.20000000298023224, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 225 Step 225 acc_test 0.231084 f1_test 0.200295 acc_val 0.186094 f1_val 0.159975 acc_train 1.000000 f1_train 1.000000 psl_cor 2 psl_totl 13 pslt_global 7.000000 Tim 0:12:11
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [1, 4, 0, 0, 0, 8, 0] [1, 0, 0, 0, 0, 1, 0]
psl_acc:  0.154 cw_psl_acc:  [1.0, 0.0, nan, nan, nan, 0.125, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 250 Step 250 acc_test 0.222904 f1_test 0.193444 acc_val 0.182004 f1_val 0.154676 acc_train 1.000000 f1_train 1.000000 psl_cor 9 psl_totl 28 pslt_global 7.000000 Tim 0:13:26
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [8, 14, 0, 0, 0, 6, 0] [7, 2, 0, 0, 0, 0, 0]
psl_acc:  0.321 cw_psl_acc:  [0.875, 0.1428571492433548, nan, nan, nan, 0.0, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 275 Step 275 acc_test 0.212679 f1_test 0.185943 acc_val 0.182004 f1_val 0.156475 acc_train 1.000000 f1_train 1.000000 psl_cor 12 psl_totl 28 pslt_global 7.000000 Tim 0:14:42
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [11, 6, 0, 0, 0, 11, 0] [9, 3, 0, 0, 0, 0, 0]
psl_acc:  0.429 cw_psl_acc:  [0.8181818127632141, 0.5, nan, nan, nan, 0.0, nan]
Early stopping trigger at step:  275
Best model at step:  25

Training complete!
Total training took 0:14:42 (h:mm:ss)
Load model from ./experiment/test/output/model_net0.pth
Save training statistics in:  ./experiment/test/log/20240318-123732/0/training_statistics.csv

Best_step:  25 
best_test_acc:  0.2167689161554192 
best_test_f1:  0.18617395536590392
Save best record in:  ./experiment/test/log/20240318-123732/summary.csv
Save best record in:  ./experiment/test/log/summary_avgrun.csv
