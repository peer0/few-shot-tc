current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data_split

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090
n_classes:  7
semi_SSL
line 147 모델 =>  microsoft/codebert-base
net_arch:  microsoft/codebert-base lr:  1e-05
line 257 => epoch 0
line 258 => batch 갯수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.157464 f1_test 0.038869 acc_val 0.159509 f1_val 0.039305 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11


acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
line 493 => SSL 시작됨
line 257 => epoch 1
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 2
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 3
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 4
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 5
line 258 => batch 갯수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 25 acc_test 0.208589 f1_test 0.147939 acc_val 0.218814 f1_val 0.159397 acc_train 0.371429 f1_train 0.308132 psl_cor 0 psl_totl 0 pslt_global 0.500000  Tim 0:00:28


acc_train_cw [0.2, 1.0, 0.0, 0.2, 0.8, 0.2, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
line 493 => SSL 시작됨
line 257 => epoch 6
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 7
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 8
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 9
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 10
line 258 => batch 갯수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 50 acc_test 0.257669 f1_test 0.187737 acc_val 0.253579 f1_val 0.194742 acc_train 0.514286 f1_train 0.467045 psl_cor 0 psl_totl 0 pslt_global 0.500000  Tim 0:00:48


acc_train_cw [0.2, 1.0, 0.4, 0.0, 1.0, 0.4, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
line 493 => SSL 시작됨
line 257 => epoch 11
line 258 => batch 개수 5
line 493 => SSL 시작됨
line 257 => epoch 12
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 13
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 14
line 258 => batch 갯수 5
line 493 => SSL 시작됨
line 257 => epoch 15
line 258 => batch 갯수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 75 acc_test 0.329243 f1_test 0.322731 acc_val 0.321063 f1_val 0.322918 acc_train 0.828571 f1_train 0.828144 psl_cor 0 psl_totl 0 pslt_global 0.500000  Tim 0:01:09


acc_train_cw [0.8, 1.0, 1.0, 0.6, 1.0, 0.6, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
line 493 => SSL 시작됨
line 257 => epoch 16
line 258 => batch 갯수 5
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 85
line 257 => epoch 17
line 258 => batch 갯수 85
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 100 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.960168 f1_train 0.139954 psl_cor 1 psl_totl 1 pslt_global 0.500000  Tim 0:01:35


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 1, 0, 0] [0, 0, 0, 0, 1, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [nan, nan, nan, nan, 1.0, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 18
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 125 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.992495 f1_train 0.142319 psl_cor 2 psl_totl 7 pslt_global 0.500000  Tim 0:02:28


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 2, 0, 0]
psl_acc:  0.286 cw_psl_acc:  [nan, nan, nan, nan, 0.2857142984867096, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 19
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 150 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.991959 f1_train 0.142280 psl_cor 3 psl_totl 7 pslt_global 0.500000  Tim 0:03:22


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 3, 0, 0]
psl_acc:  0.429 cw_psl_acc:  [nan, nan, nan, nan, 0.4285714328289032, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 20
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 175 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.992495 f1_train 0.142319 psl_cor 1 psl_totl 7 pslt_global 0.500000  Tim 0:04:16


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 1, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [nan, nan, nan, nan, 0.1428571492433548, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 21
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 200 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.991959 f1_train 0.142280 psl_cor 4 psl_totl 7 pslt_global 0.500000  Tim 0:05:09


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 4, 0, 0]
psl_acc:  0.571 cw_psl_acc:  [nan, nan, nan, nan, 0.5714285969734192, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 22
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 225 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.992227 f1_train 0.142300 psl_cor 2 psl_totl 7 pslt_global 0.500000  Tim 0:06:03


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 2, 0, 0]
psl_acc:  0.286 cw_psl_acc:  [nan, nan, nan, nan, 0.2857142984867096, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 23
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 250 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.993031 f1_train 0.142358 psl_cor 1 psl_totl 7 pslt_global 0.500000  Tim 0:06:57


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 1, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [nan, nan, nan, nan, 0.1428571492433548, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 24
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 275 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.992227 f1_train 0.142300 psl_cor 1 psl_totl 7 pslt_global 0.500000  Tim 0:07:50


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 1, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [nan, nan, nan, nan, 0.1428571492433548, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 25
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 300 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.991959 f1_train 0.142280 psl_cor 0 psl_totl 7 pslt_global 0.500000  Tim 0:08:44


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, 0.0, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 26
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 26 Step 325 acc_test 0.155419 f1_test 0.038432 acc_val 0.157464 f1_val 0.038869 acc_train 0.992495 f1_train 0.142319 psl_cor 2 psl_totl 7 pslt_global 0.500000  Tim 0:09:38


acc_train_cw [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 7, 0, 0] [0, 0, 0, 0, 2, 0, 0]
psl_acc:  0.286 cw_psl_acc:  [nan, nan, nan, nan, 0.2857142984867096, nan, nan]
Early stopping trigger at step:  325
Best model at step:  75
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 27
line 258 => batch 갯수 558

Training complete!
Total training took 0:09:38 (h:mm:ss)
Load model from ./experiment/test/output/model_net0.pth
Save training statistics in:  ./experiment/test/log/20240322-101935/0/training_statistics.csv

Best_step:  75 
best_test_acc:  0.3292433537832311 
best_test_f1:  0.3227305594289569
Save best record in:  ./experiment/test/log/20240322-101935/summary.csv
Save best record in:  ./experiment/test/log/summary_avgrun.csv
