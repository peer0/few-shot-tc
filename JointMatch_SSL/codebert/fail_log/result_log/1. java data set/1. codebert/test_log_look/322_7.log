current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data_split

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090
n_classes:  7
semi_SSL
line 147 모델 =>  microsoft/codebert-base
net_arch:  microsoft/codebert-base lr:  1e-05
line 257 => epoch 0
line 258 => batch 갯수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.157464 f1_test 0.038869 acc_val 0.159509 f1_val 0.039305 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000 
 Tim 0:00:11
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 1
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 25 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.424315 f1_train 0.085117 psl_cor 1 psl_totl 7 pslt_global 0.100000 
 Tim 0:01:12
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [1, 0, 2, 3, 0, 0, 1] [0, 0, 0, 1, 0, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [0.0, nan, 0.0, 0.3333333432674408, nan, nan, 0.0]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 2
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 50 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.991959 f1_train 0.142280 psl_cor 0 psl_totl 7 pslt_global 0.100000 
 Tim 0:02:13
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 3
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 75 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992495 f1_train 0.142319 psl_cor 1 psl_totl 7 pslt_global 0.100000 
 Tim 0:03:14
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 1, 0, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [nan, nan, nan, 0.1428571492433548, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 4
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 100 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992495 f1_train 0.142319 psl_cor 2 psl_totl 7 pslt_global 0.100000 
 Tim 0:04:16
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 2, 0, 0, 0]
psl_acc:  0.286 cw_psl_acc:  [nan, nan, nan, 0.2857142984867096, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 5
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 125 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992227 f1_train 0.142300 psl_cor 3 psl_totl 7 pslt_global 0.100000 
 Tim 0:05:17
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 3, 0, 0, 0]
psl_acc:  0.429 cw_psl_acc:  [nan, nan, nan, 0.4285714328289032, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 6
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 150 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992763 f1_train 0.142338 psl_cor 0 psl_totl 7 pslt_global 0.100000 
 Tim 0:06:19
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 7
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 175 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992227 f1_train 0.142300 psl_cor 2 psl_totl 7 pslt_global 0.100000 
 Tim 0:07:21
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 2, 0, 0, 0]
psl_acc:  0.286 cw_psl_acc:  [nan, nan, nan, 0.2857142984867096, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 8
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 200 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.991959 f1_train 0.142280 psl_cor 0 psl_totl 7 pslt_global 0.100000 
 Tim 0:08:23
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 9
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 225 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992227 f1_train 0.142300 psl_cor 1 psl_totl 7 pslt_global 0.100000 
 Tim 0:09:25
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 1, 0, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [nan, nan, nan, 0.1428571492433548, nan, nan, nan]
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 10
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 250 acc_test 0.143149 f1_test 0.035778 acc_val 0.143149 f1_val 0.035778 acc_train 0.992763 f1_train 0.142338 psl_cor 0 psl_totl 7 pslt_global 0.100000 
 Tim 0:10:27
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 7, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
Early stopping trigger at step:  250
Best model at step:  0
line 493 => SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 11
line 258 => batch 갯수 558

Training complete!
Total training took 0:10:27 (h:mm:ss)
Load model from ./experiment/test/output/model_net0.pth
Save training statistics in:  ./experiment/test/log/20240322-085745/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.1574642126789366 
best_test_f1:  0.038869257950530034
Save best record in:  ./experiment/test/log/20240322-085745/summary.csv
Save best record in:  ./experiment/test/log/summary_avgrun.csv
