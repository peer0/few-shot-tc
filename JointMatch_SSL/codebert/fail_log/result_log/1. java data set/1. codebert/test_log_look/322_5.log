current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data_split

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090
n_classes:  7
semi_SSL
line 147 모델 =>  microsoft/codebert-base
net_arch:  microsoft/codebert-base lr:  1e-05
line 257 => epoch 0
line 258 => batch 갯수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.157464 f1_test 0.038869 acc_val 0.159509 f1_val 0.039305 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000 Tim 0:00:11
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 1
line 258 => batch 갯수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 25 acc_test 0.224949 f1_test 0.177417 acc_val 0.212679 f1_val 0.165796 acc_train 0.457245 f1_train 0.387765 psl_cor 1 psl_totl 7 pslt_global 0.100000 Tim 0:01:03
acc_train_cw [0.4, 0.6, 0.0, 0.801, 1.0, 0.4, 0.0]
cw_psl_eval:  [1, 0, 2, 3, 0, 0, 1] [0, 0, 0, 1, 0, 0, 0]
psl_acc:  0.143 cw_psl_acc:  [0.0, nan, 0.0, 0.3333333432674408, nan, nan, 0.0]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 50 acc_test 0.257669 f1_test 0.207383 acc_val 0.247444 f1_val 0.197295 acc_train 0.542755 f1_train 0.496670 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:01:59
acc_train_cw [0.201, 1.0, 0.599, 0.0, 1.0, 0.4, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 75 acc_test 0.319018 f1_test 0.285053 acc_val 0.298569 f1_val 0.280753 acc_train 0.886329 f1_train 0.891133 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:02:55
acc_train_cw [0.801, 1.0, 1.0, 0.801, 1.0, 0.801, 0.801]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 100 acc_test 0.269939 f1_test 0.242562 acc_val 0.267894 f1_val 0.250630 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:03:51
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 125 acc_test 0.325153 f1_test 0.301132 acc_val 0.280164 f1_val 0.255795 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:04:41
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 150 acc_test 0.308793 f1_test 0.276955 acc_val 0.302658 f1_val 0.288983 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:05:30
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 175 acc_test 0.316973 f1_test 0.305095 acc_val 0.300613 f1_val 0.288738 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:06:27
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 200 acc_test 0.306748 f1_test 0.290762 acc_val 0.288344 f1_val 0.276265 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:07:16
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 225 acc_test 0.306748 f1_test 0.293509 acc_val 0.290389 f1_val 0.279983 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:08:05
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 250 acc_test 0.306748 f1_test 0.293318 acc_val 0.286299 f1_val 0.273885 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:08:55
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 275 acc_test 0.300613 f1_test 0.283321 acc_val 0.288344 f1_val 0.277919 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:09:44
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 300 acc_test 0.308793 f1_test 0.292950 acc_val 0.292434 f1_val 0.283126 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:10:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 325 acc_test 0.306748 f1_test 0.289815 acc_val 0.284254 f1_val 0.274065 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:11:23
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 350 acc_test 0.296524 f1_test 0.285649 acc_val 0.280164 f1_val 0.273223 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:12:13
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 375 acc_test 0.290389 f1_test 0.280492 acc_val 0.296524 f1_val 0.288895 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:13:02
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 400 acc_test 0.304703 f1_test 0.289294 acc_val 0.280164 f1_val 0.272428 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.100000 Tim 0:13:52
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  400
Best model at step:  150
SSL 시작됨
결합된 DataLoader의 배치 수: 558
line 257 => epoch 2
line 258 => batch 갯수 558

Training complete!
Total training took 0:13:53 (h:mm:ss)
Load model from ./experiment/test/output/model_net0.pth
Save training statistics in:  ./experiment/test/log/20240322-081255/0/training_statistics.csv

Best_step:  150 
best_test_acc:  0.30879345603271985 
best_test_f1:  0.2769548947041795
Save best record in:  ./experiment/test/log/20240322-081255/summary.csv
Save best record in:  ./experiment/test/log/summary_avgrun.csv







step은 대략 553정도 나올 수 있음.
왜냐하면 ul_data가 3800정도 있기 때문임.

이후 전체 ul_label data를 이용함.



해석 5번의 step이 지나면 train data에 대한 학습이 끝을 의미함.
이후 


조기 종료가 된 이유는 acc_val > best_acc을 충족하지 못해서 모델이 조기 종료를 시킴.