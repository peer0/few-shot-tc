current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code

data_path:  ../data/../data_split

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090
n_labeled_per_class:  1
train_df samples: 3911
train_labeled_df samples: 7
train_unlabeled_df samples: 3904
Check n_smaples_per_class in the original training set:  {1: 600, 2: 560, 3: 622, 4: 560, 5: 610, 6: 477, 7: 482}
Check n_smaples_per_class in the labeled training set:  {1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1}
Check n_smaples_per_class in the unlabeled training set:  {1: 599, 2: 559, 3: 621, 4: 559, 5: 609, 6: 476, 7: 481}
n_classes:  7
#####모델 Salesforce/codet5p-110m-embedding
net_arch:  Salesforce/codet5p-110m-embedding lr:  1e-05
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 0 Step 0 acc_test 0.177914 f1_test 0.089186 acc_val 0.165644 f1_val 0.078346 acc_train 0.285714 f1_train 0.183673 psl_cor 0 psl_totl 0 pslt_global 0.000000 Tim 0:00:44
acc_train_cw [0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 25 acc_test 0.237219 f1_test 0.207447 acc_val 0.233129 f1_val 0.203088 acc_train 1.000000 f1_train 1.000000 psl_cor 321 psl_totl 1750 pslt_global 0.000000 Tim 0:02:00
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [125, 256, 466, 97, 108, 79, 619] [60, 54, 64, 19, 17, 4, 103]
psl_acc:  0.183 cw_psl_acc:  [0.47999998927116394, 0.2109375, 0.1373390555381775, 0.19587628543376923, 0.15740740299224854, 0.050632912665605545, 0.16639742255210876]
Save model to ./experiment/test/output/
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 50 Step 50 acc_test 0.235174 f1_test 0.203235 acc_val 0.214724 f1_val 0.179855 acc_train 1.000000 f1_train 1.000000 psl_cor 399 psl_totl 1750 pslt_global 0.000000 Tim 0:03:20
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [296, 251, 412, 28, 97, 140, 526] [128, 45, 66, 9, 19, 14, 118]
psl_acc:  0.228 cw_psl_acc:  [0.4324324429035187, 0.17928287386894226, 0.16019417345523834, 0.3214285671710968, 0.19587628543376923, 0.10000000149011612, 0.22433459758758545]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 75 Step 75 acc_test 0.231084 f1_test 0.193706 acc_val 0.210634 f1_val 0.167121 acc_train 1.000000 f1_train 1.000000 psl_cor 402 psl_totl 1748 pslt_global 0.000000 Tim 0:04:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [380, 165, 483, 21, 88, 130, 481] [133, 28, 89, 7, 16, 16, 113]
psl_acc:  0.23 cw_psl_acc:  [0.3499999940395355, 0.16969697177410126, 0.18426501750946045, 0.3333333432674408, 0.1818181872367859, 0.1230769231915474, 0.234927237033844]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 100 Step 100 acc_test 0.239264 f1_test 0.195052 acc_val 0.220859 f1_val 0.170317 acc_train 1.000000 f1_train 1.000000 psl_cor 383 psl_totl 1750 pslt_global 0.000000 Tim 0:05:48
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [370, 137, 506, 34, 111, 145, 447] [136, 21, 73, 10, 21, 14, 108]
psl_acc:  0.219 cw_psl_acc:  [0.3675675690174103, 0.15328466892242432, 0.14426878094673157, 0.29411765933036804, 0.18918919563293457, 0.09655172377824783, 0.24161073565483093]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 125 Step 125 acc_test 0.233129 f1_test 0.190334 acc_val 0.222904 f1_val 0.171375 acc_train 1.000000 f1_train 1.000000 psl_cor 372 psl_totl 1748 pslt_global 0.000000 Tim 0:07:02
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [392, 114, 549, 30, 87, 130, 446] [132, 24, 72, 11, 16, 11, 106]
psl_acc:  0.213 cw_psl_acc:  [0.33673468232154846, 0.21052631735801697, 0.13114753365516663, 0.36666667461395264, 0.18390804529190063, 0.08461538702249527, 0.23766815662384033]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 150 Step 150 acc_test 0.241309 f1_test 0.202697 acc_val 0.226994 f1_val 0.176721 acc_train 1.000000 f1_train 1.000000 psl_cor 396 psl_totl 1750 pslt_global 0.000000 Tim 0:08:16
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [406, 122, 529, 26, 114, 148, 405] [131, 21, 89, 5, 20, 20, 110]
psl_acc:  0.226 cw_psl_acc:  [0.32266008853912354, 0.17213115096092224, 0.1682419627904892, 0.19230769574642181, 0.17543859779834747, 0.13513512909412384, 0.2716049253940582]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 175 Step 175 acc_test 0.237219 f1_test 0.191985 acc_val 0.222904 f1_val 0.174337 acc_train 1.000000 f1_train 1.000000 psl_cor 397 psl_totl 1748 pslt_global 0.000000 Tim 0:09:30
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [447, 96, 541, 27, 92, 164, 381] [152, 14, 92, 8, 20, 18, 93]
psl_acc:  0.227 cw_psl_acc:  [0.3400447368621826, 0.1458333283662796, 0.17005544900894165, 0.29629629850387573, 0.21739129722118378, 0.10975609719753265, 0.24409449100494385]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 200 Step 200 acc_test 0.239264 f1_test 0.196214 acc_val 0.222904 f1_val 0.174135 acc_train 1.000000 f1_train 1.000000 psl_cor 380 psl_totl 1750 pslt_global 0.000000 Tim 0:10:44
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [436, 103, 530, 31, 124, 143, 383] [131, 16, 78, 9, 23, 18, 105]
psl_acc:  0.217 cw_psl_acc:  [0.30045872926712036, 0.1553398072719574, 0.1471698135137558, 0.29032257199287415, 0.1854838728904724, 0.1258741319179535, 0.27415144443511963]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 225 Step 225 acc_test 0.237219 f1_test 0.195722 acc_val 0.224949 f1_val 0.176704 acc_train 1.000000 f1_train 1.000000 psl_cor 420 psl_totl 1748 pslt_global 0.000000 Tim 0:11:58
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [482, 73, 554, 29, 95, 135, 380] [153, 12, 88, 10, 20, 18, 119]
psl_acc:  0.24 cw_psl_acc:  [0.317427396774292, 0.16438356041908264, 0.15884476900100708, 0.3448275923728943, 0.21052631735801697, 0.13333334028720856, 0.3131578862667084]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 250 Step 250 acc_test 0.241309 f1_test 0.200901 acc_val 0.222904 f1_val 0.173749 acc_train 1.000000 f1_train 1.000000 psl_cor 396 psl_totl 1750 pslt_global 0.000000 Tim 0:13:12
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [485, 82, 560, 33, 92, 162, 336] [146, 10, 97, 8, 21, 20, 94]
psl_acc:  0.226 cw_psl_acc:  [0.3010309338569641, 0.12195122241973877, 0.17321428656578064, 0.24242424964904785, 0.22826087474822998, 0.12345679104328156, 0.2797619104385376]
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 275 Step 275 acc_test 0.235174 f1_test 0.194481 acc_val 0.231084 f1_val 0.178991 acc_train 1.000000 f1_train 1.000000 psl_cor 396 psl_totl 1750 pslt_global 0.000000 Tim 0:14:26
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [465, 72, 578, 25, 106, 138, 366] [134, 16, 93, 9, 16, 21, 107]
psl_acc:  0.226 cw_psl_acc:  [0.28817203640937805, 0.2222222238779068, 0.16089965403079987, 0.36000001430511475, 0.15094339847564697, 0.15217390656471252, 0.2923497259616852]
Early stopping trigger at step:  275
Best model at step:  25

Training complete!
Total training took 0:14:26 (h:mm:ss)
Load model from ./experiment/test/output/model_net0.pth
Save training statistics in:  ./experiment/test/log/20240314-175631/0/training_statistics.csv

Best_step:  25 
best_test_acc:  0.23721881390593047 
best_test_f1:  0.20744660836763046
Save best record in:  ./experiment/test/log/20240314-175631/summary.csv
Save best record in:  ./experiment/test/log/summary_avgrun.csv
