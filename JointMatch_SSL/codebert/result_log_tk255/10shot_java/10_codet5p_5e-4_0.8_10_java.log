current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codet5p-110m-embedding_0.0005_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0005

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.223714 f1_test 0.107895 acc_val 0.255499 f1_val 0.096385 acc_train 0.200000 f1_train 0.139276 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:12
acc_train_cw [0.0, 0.1, 0.1, 0.0, 0.7, 0.5, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.161074 f1_test 0.113901 acc_val 0.123519 f1_val 0.094288 acc_train 0.342857 f1_train 0.227543 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:42
acc_train_cw [0.9, 0.0, 0.5, 0.0, 0.1, 0.0, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.210291 f1_test 0.174474 acc_val 0.208122 f1_val 0.133592 acc_train 0.500000 f1_train 0.455170 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:12
acc_train_cw [0.9, 0.0, 0.6, 0.7, 0.4, 0.2, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.125280 f1_test 0.138446 acc_val 0.150592 f1_val 0.133246 acc_train 0.557143 f1_train 0.544162 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:42
acc_train_cw [0.9, 0.1, 0.6, 0.7, 0.4, 0.3, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 40 acc_test 0.201342 f1_test 0.178916 acc_val 0.223350 f1_val 0.125473 acc_train 0.728571 f1_train 0.693585 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:12
acc_train_cw [1.0, 0.1, 1.0, 0.8, 0.8, 0.5, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 50 acc_test 0.268456 f1_test 0.206679 acc_val 0.223350 f1_val 0.145656 acc_train 0.785714 f1_train 0.752341 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:42
acc_train_cw [1.0, 0.1, 1.0, 0.7, 0.9, 0.9, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 60 acc_test 0.230425 f1_test 0.193177 acc_val 0.235195 f1_val 0.165480 acc_train 0.900000 f1_train 0.898421 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:12
acc_train_cw [1.0, 0.7, 1.0, 0.8, 1.0, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 70 acc_test 0.183445 f1_test 0.155705 acc_val 0.231810 f1_val 0.152850 acc_train 0.814286 f1_train 0.809828 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:42
acc_train_cw [1.0, 0.5, 0.9, 1.0, 0.7, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 80 acc_test 0.208054 f1_test 0.195181 acc_val 0.253807 f1_val 0.173879 acc_train 0.842857 f1_train 0.844589 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:12
acc_train_cw [0.8, 0.5, 1.0, 0.8, 0.9, 1.0, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 90 acc_test 0.248322 f1_test 0.193820 acc_val 0.226734 f1_val 0.160966 acc_train 0.871429 f1_train 0.859608 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:41
acc_train_cw [1.0, 0.4, 1.0, 0.8, 0.9, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 100 acc_test 0.174497 f1_test 0.152493 acc_val 0.248731 f1_val 0.176296 acc_train 0.928571 f1_train 0.929108 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:11
acc_train_cw [1.0, 0.8, 1.0, 1.0, 0.8, 1.0, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  100
Best model at step:  0
**조기종료됨**
종료된 epoch시점 :  12 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:05:29 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codet5p-110m-embedding_0.0005_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-170813/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.22371364653243847 
best_test_f1:  0.10789523423357834
Save best record in:  ./experiment/few_shot/log/20240401-170813/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
