current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_codebert-base_0.0001_0.7_20_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.192623 f1_test 0.098918 acc_val 0.228013 f1_val 0.075525 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.043033 f1_test 0.023768 acc_val 0.110749 f1_val 0.030263 acc_train 0.285714 f1_train 0.142857 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:32
acc_train_cw [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.307377 f1_test 0.118506 acc_val 0.026059 f1_val 0.034555 acc_train 0.571429 f1_train 0.452381 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:56
acc_train_cw [0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.225410 f1_test 0.135937 acc_val 0.133550 f1_val 0.088550 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:20
acc_train_cw [0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.100410 f1_test 0.073924 acc_val 0.136808 f1_val 0.073524 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:44
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.096311 f1_test 0.079041 acc_val 0.175896 f1_val 0.118815 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:08
acc_train_cw [1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.133197 f1_test 0.108993 acc_val 0.156352 f1_val 0.097945 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:32
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 85
line 258 => 인스턴스 수 13
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.149590 f1_test 0.123675 acc_val 0.166124 f1_val 0.122483 acc_train 0.988235 f1_train 0.941392 psl_cor 17 psl_totl 80 pslt_global 0.700000  Tim 0:02:57
acc_train_cw [1.0, 0.857, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [1, 7, 0, 0, 0, 0, 72] [1, 2, 0, 0, 0, 0, 14]
psl_acc:  0.212 cw_psl_acc:  [1.0, 0.2857142984867096, nan, nan, nan, nan, 0.1944444477558136]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2835
line 258 => 인스턴스 수 405
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 20 acc_test 0.122951 f1_test 0.099806 acc_val 0.208469 f1_val 0.188700 acc_train 0.869841 f1_train 0.741458 psl_cor 714 psl_totl 2882 pslt_global 0.700000  Tim 0:03:34
acc_train_cw [0.911, 0.699, 0.821, 0.31, 0.534, 0.687, 1.0]
cw_psl_eval:  [597, 341, 285, 29, 175, 213, 1242] [265, 118, 57, 7, 49, 46, 172]
psl_acc:  0.248 cw_psl_acc:  [0.4438861012458801, 0.3460410535335541, 0.20000000298023224, 0.24137930572032928, 0.2800000011920929, 0.21596243977546692, 0.13848631083965302]
**bs에 맞지않음!!!!!**


line 303 => train data수 3808
line 258 => 인스턴스 수 544
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 425 acc_test 0.202869 f1_test 0.142308 acc_val 0.166124 f1_val 0.128010 acc_train 0.918855 f1_train 0.900959 psl_cor 866 psl_totl 3783 pslt_global 0.700000  Tim 0:04:52
acc_train_cw [0.882, 0.823, 0.934, nan, 0.86, 0.932, 0.979]
cw_psl_eval:  [551, 484, 372, 0, 452, 630, 1294] [232, 154, 55, 0, 115, 124, 186]
psl_acc:  0.229 cw_psl_acc:  [0.42105263471603394, 0.3181818127632141, 0.1478494554758072, nan, 0.2544247806072235, 0.19682539999485016, 0.14374034106731415]
**bs에 맞지않음!!!!!**


line 303 => train data수 3889
line 258 => 인스턴스 수 556
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 969 acc_test 0.237705 f1_test 0.163838 acc_val 0.143322 f1_val 0.108657 acc_train 0.956544 f1_train 0.947653 psl_cor 807 psl_totl 3855 pslt_global 0.700000  Tim 0:06:24
acc_train_cw [0.926, 0.934, 0.964, nan, 0.867, 0.984, 0.988]
cw_psl_eval:  [385, 524, 403, 0, 471, 727, 1345] [167, 148, 56, 0, 111, 128, 197]
psl_acc:  0.209 cw_psl_acc:  [0.43376624584198, 0.28244274854660034, 0.13895781338214874, nan, 0.23566879332065582, 0.17606602609157562, 0.1464684009552002]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3897
line 258 => 인스턴스 수 557
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 1525 acc_test 0.239754 f1_test 0.160497 acc_val 0.120521 f1_val 0.096326 acc_train 0.972030 f1_train 0.965207 psl_cor 857 psl_totl 3885 pslt_global 0.700000  Tim 0:07:56
acc_train_cw [0.95, 0.961, 0.947, nan, 0.94, 0.987, 0.997]
cw_psl_eval:  [436, 621, 301, 0, 589, 706, 1232] [195, 165, 38, 0, 139, 132, 188]
psl_acc:  0.221 cw_psl_acc:  [0.447247713804245, 0.26570048928260803, 0.12624584138393402, nan, 0.23599320650100708, 0.1869688332080841, 0.15259739756584167]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 2082 acc_test 0.252049 f1_test 0.166251 acc_val 0.127036 f1_val 0.099231 acc_train 0.972578 f1_train 0.968462 psl_cor 863 psl_totl 3926 pslt_global 0.700000  Tim 0:09:29
acc_train_cw [0.94, 0.97, 0.982, nan, 0.923, 0.991, 0.994]
cw_psl_eval:  [433, 583, 341, 0, 564, 739, 1266] [198, 156, 46, 0, 141, 132, 190]
psl_acc:  0.22 cw_psl_acc:  [0.45727482438087463, 0.2675814628601074, 0.1348973661661148, nan, 0.25, 0.17861975729465485, 0.15007898211479187]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 2640 acc_test 0.213115 f1_test 0.148862 acc_val 0.140065 f1_val 0.115163 acc_train 0.946438 f1_train 0.941987 psl_cor 860 psl_totl 3710 pslt_global 0.700000  Tim 0:11:02
acc_train_cw [0.945, 0.834, 0.951, nan, 0.963, 0.96, 0.968]
cw_psl_eval:  [529, 367, 411, 0, 828, 557, 1018] [218, 122, 58, 0, 192, 113, 157]
psl_acc:  0.232 cw_psl_acc:  [0.4120982885360718, 0.332425057888031, 0.14111922681331635, nan, 0.23188406229019165, 0.20287252962589264, 0.1542239636182785]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 3198 acc_test 0.196721 f1_test 0.144330 acc_val 0.136808 f1_val 0.112306 acc_train 0.966684 f1_train 0.965590 psl_cor 873 psl_totl 3895 pslt_global 0.700000  Tim 0:12:35
acc_train_cw [0.969, 0.961, 0.981, nan, 0.911, 0.971, 0.997]
cw_psl_eval:  [506, 471, 382, 0, 758, 542, 1236] [214, 124, 53, 0, 186, 109, 187]
psl_acc:  0.224 cw_psl_acc:  [0.4229249060153961, 0.2632696330547333, 0.13874346017837524, nan, 0.24538259208202362, 0.20110701024532318, 0.1512944996356964]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 3756 acc_test 0.188525 f1_test 0.140597 acc_val 0.149837 f1_val 0.126737 acc_train 0.968734 f1_train 0.966040 psl_cor 861 psl_totl 3941 pslt_global 0.700000  Tim 0:14:09
acc_train_cw [0.974, 0.935, 0.99, nan, 0.92, 0.985, 0.996]
cw_psl_eval:  [468, 620, 393, 0, 679, 533, 1248] [216, 147, 49, 0, 167, 95, 187]
psl_acc:  0.218 cw_psl_acc:  [0.4615384638309479, 0.23709677159786224, 0.12468193471431732, nan, 0.24594992399215698, 0.17823639512062073, 0.14983974397182465]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 4314 acc_test 0.221311 f1_test 0.156654 acc_val 0.133550 f1_val 0.107902 acc_train 0.968990 f1_train 0.964155 psl_cor 847 psl_totl 3901 pslt_global 0.700000  Tim 0:15:42
acc_train_cw [0.953, 0.938, 0.966, nan, 0.938, 0.989, 0.997]
cw_psl_eval:  [394, 601, 487, 0, 642, 563, 1214] [193, 138, 73, 0, 157, 104, 182]
psl_acc:  0.217 cw_psl_acc:  [0.48984771966934204, 0.22961729764938354, 0.14989733695983887, nan, 0.24454829096794128, 0.18472468852996826, 0.1499176323413849]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 4872 acc_test 0.192623 f1_test 0.062024 acc_val 0.081433 f1_val 0.048719 acc_train 0.808303 f1_train 0.300272 psl_cor 359 psl_totl 2982 pslt_global 0.700000  Tim 0:17:15
acc_train_cw [0.0, 0.999, 0.0, nan, 0.0, 0.0, 0.944]
cw_psl_eval:  [0, 1577, 0, 0, 0, 1, 1404] [0, 148, 0, 0, 0, 0, 211]
psl_acc:  0.12 cw_psl_acc:  [nan, 0.0938490778207779, nan, nan, nan, 0.0, 0.15028490126132965]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 5430 acc_test 0.174180 f1_test 0.059847 acc_val 0.081433 f1_val 0.045743 acc_train 0.994618 f1_train 0.331640 psl_cor 518 psl_totl 3965 pslt_global 0.700000  Tim 0:18:48
acc_train_cw [0.0, 0.995, 0.0, nan, 0.0, 0.0, 0.997]
cw_psl_eval:  [0, 2502, 0, 0, 0, 0, 1463] [0, 292, 0, 0, 0, 0, 226]
psl_acc:  0.131 cw_psl_acc:  [nan, 0.11670663207769394, nan, nan, nan, nan, 0.1544771045446396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 5988 acc_test 0.280738 f1_test 0.076767 acc_val 0.022801 f1_val 0.026211 acc_train 0.963608 f1_train 0.293866 psl_cor 559 psl_totl 3967 pslt_global 0.700000  Tim 0:20:20
acc_train_cw [0.0, 0.999, 0.0, nan, 0.0, 0.0, 0.647]
cw_psl_eval:  [0, 3580, 0, 0, 0, 0, 387] [0, 489, 0, 0, 0, 0, 70]
psl_acc:  0.141 cw_psl_acc:  [nan, 0.13659217953681946, nan, nan, nan, nan, 0.18087854981422424]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3902
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 6546 acc_test 0.278689 f1_test 0.062271 acc_val 0.006515 f1_val 0.001849 acc_train 0.998719 f1_train 0.166560 psl_cor 513 psl_totl 3967 pslt_global 0.700000  Tim 0:21:53
acc_train_cw [0.0, 1.0, 0.0, nan, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 3967, 0, 0, 0, 0, 0] [0, 513, 0, 0, 0, 0, 0]
psl_acc:  0.129 cw_psl_acc:  [nan, 0.12931686639785767, nan, nan, nan, nan, nan]
Early stopping trigger at step:  6546
Best model at step:  0
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  22 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:22:11 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codebert-base_0.0001_0.7_20_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240329-130807/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.19262295081967212 
best_test_f1:  0.09891822583616645
Save best record in:  ./experiment/few_shot/log/20240329-130807/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
