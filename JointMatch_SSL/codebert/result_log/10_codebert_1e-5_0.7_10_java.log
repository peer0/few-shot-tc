current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codebert-base_1e-05_0.7_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  1e-05

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.096197 f1_test 0.031173 acc_val 0.089679 f1_val 0.033271 acc_train 0.114286 f1_train 0.032653 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.131991 f1_test 0.036566 acc_val 0.096447 f1_val 0.031301 acc_train 0.171429 f1_train 0.081062 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:43
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.127517 f1_test 0.106530 acc_val 0.181049 f1_val 0.110079 acc_train 0.300000 f1_train 0.186783 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:17
acc_train_cw [0.9, 0.0, 0.0, 0.0, 0.4, 0.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.183445 f1_test 0.096925 acc_val 0.194585 f1_val 0.100962 acc_train 0.400000 f1_train 0.322235 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:52
acc_train_cw [0.6, 0.0, 0.0, 0.0, 0.9, 0.6, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 40 acc_test 0.172260 f1_test 0.063558 acc_val 0.240271 f1_val 0.120658 acc_train 0.300000 f1_train 0.215745 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:26
acc_train_cw [0.5, 0.0, 0.0, 0.0, 0.9, 0.0, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 50 acc_test 0.093960 f1_test 0.106647 acc_val 0.160745 f1_val 0.128342 acc_train 0.428571 f1_train 0.417017 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:02
acc_train_cw [0.5, 0.1, 0.2, 0.4, 0.6, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 60 acc_test 0.082774 f1_test 0.084010 acc_val 0.214890 f1_val 0.160284 acc_train 0.414286 f1_train 0.368561 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:31
acc_train_cw [0.7, 0.1, 0.3, 0.7, 0.4, 0.0, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 70 acc_test 0.102908 f1_test 0.108233 acc_val 0.208122 f1_val 0.162182 acc_train 0.471429 f1_train 0.418312 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:00
acc_train_cw [0.7, 0.4, 0.0, 0.7, 0.5, 0.1, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 80 acc_test 0.093960 f1_test 0.119450 acc_val 0.135364 f1_val 0.121581 acc_train 0.457143 f1_train 0.434379 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:29
acc_train_cw [0.8, 0.1, 0.6, 0.5, 0.3, 0.1, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 90 acc_test 0.161074 f1_test 0.172250 acc_val 0.211506 f1_val 0.165587 acc_train 0.642857 f1_train 0.626846 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:04:59
acc_train_cw [0.9, 0.3, 0.9, 0.7, 0.7, 0.3, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 100 acc_test 0.183445 f1_test 0.183040 acc_val 0.179357 f1_val 0.150372 acc_train 0.628571 f1_train 0.627512 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:05:28
acc_train_cw [0.9, 0.6, 0.5, 0.7, 0.6, 0.4, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 71
line 258 => 인스턴스 수 11
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 110 acc_test 0.147651 f1_test 0.166935 acc_val 0.167513 f1_val 0.145097 acc_train 0.704225 f1_train 0.688968 psl_cor 1 psl_totl 1 pslt_global 0.700000  Tim 0:05:57
acc_train_cw [0.909, 0.4, 0.8, 0.8, 0.6, 0.4, 1.0]
cw_psl_eval:  [1, 0, 0, 0, 0, 0, 0] [1, 0, 0, 0, 0, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [1.0, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 85
line 258 => 인스턴스 수 13
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 121 acc_test 0.123043 f1_test 0.139365 acc_val 0.148900 f1_val 0.119969 acc_train 0.705882 f1_train 0.653314 psl_cor 7 psl_totl 14 pslt_global 0.700000  Tim 0:06:27
acc_train_cw [0.929, 0.4, 0.8, 0.7, 0.2, 0.6, 0.952]
cw_psl_eval:  [3, 0, 0, 0, 0, 0, 11] [3, 0, 0, 0, 0, 0, 4]
psl_acc:  0.5 cw_psl_acc:  [1.0, nan, nan, nan, nan, nan, 0.3636363744735718]
train batch instace수가 7안됨 pass

line 303 => train data수 294
line 258 => 인스턴스 수 42
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 134 acc_test 0.174497 f1_test 0.173987 acc_val 0.201354 f1_val 0.140481 acc_train 0.874150 f1_train 0.691008 psl_cor 124 psl_totl 213 pslt_global 0.700000  Tim 0:06:57
acc_train_cw [0.983, 0.2, 0.8, 0.667, 0.6, 0.684, 1.0]
cw_psl_eval:  [164, 0, 0, 14, 0, 28, 7] [115, 0, 0, 2, 0, 5, 2]
psl_acc:  0.582 cw_psl_acc:  [0.7012194991111755, nan, nan, 0.1428571492433548, nan, 0.1785714328289032, 0.2857142984867096]

line 303 => train data수 1682
line 258 => 인스턴스 수 241
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 176 acc_test 0.208054 f1_test 0.188695 acc_val 0.155668 f1_val 0.122994 acc_train 0.890606 f1_train 0.765327 psl_cor 501 psl_totl 1603 pslt_global 0.700000  Tim 0:07:37
acc_train_cw [0.997, 0.526, 0.56, 0.644, 0.872, 0.718, 1.0]
cw_psl_eval:  [639, 9, 74, 132, 38, 262, 449] [327, 2, 12, 22, 0, 41, 97]
psl_acc:  0.313 cw_psl_acc:  [0.5117371082305908, 0.2222222238779068, 0.1621621549129486, 0.1666666716337204, 0.0, 0.1564885526895523, 0.2160356342792511]
Early stopping trigger at step:  176
Best model at step:  40
**조기종료됨**
종료된 epoch시점 :  16 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:07:55 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codebert-base_1e-05_0.7_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240331-185631/0/training_statistics.csv

Best_step:  40 
best_test_acc:  0.17225950782997762 
best_test_f1:  0.06355803752750526
Save best record in:  ./experiment/few_shot/log/20240331-185631/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
