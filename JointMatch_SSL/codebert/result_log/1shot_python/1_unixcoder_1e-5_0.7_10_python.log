current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_unixcoder-base_1e-05_0.7_10_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  1e-05

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.168033 f1_test 0.111264 acc_val 0.179153 f1_val 0.119752 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.170082 f1_test 0.117167 acc_val 0.182410 f1_val 0.113396 acc_train 0.285714 f1_train 0.190476 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:31
acc_train_cw [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.151639 f1_test 0.103481 acc_val 0.214984 f1_val 0.129263 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:03
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.139344 f1_test 0.096358 acc_val 0.208469 f1_val 0.128695 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:35
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.122951 f1_test 0.083924 acc_val 0.208469 f1_val 0.132397 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:59
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.135246 f1_test 0.096721 acc_val 0.221498 f1_val 0.152082 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:23
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.143443 f1_test 0.105696 acc_val 0.237785 f1_val 0.177562 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:54
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.157787 f1_test 0.115817 acc_val 0.224756 f1_val 0.176654 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:26
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 8 acc_test 0.163934 f1_test 0.142628 acc_val 0.195440 f1_val 0.172773 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:50
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 10
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 9 acc_test 0.159836 f1_test 0.147181 acc_val 0.182410 f1_val 0.162581 acc_train 1.000000 f1_train 1.000000 psl_cor 1 psl_totl 3 pslt_global 0.700000  Tim 0:04:14
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3] [0, 0, 0, 0, 0, 0, 1]
psl_acc:  0.333 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.3333333432674408]
train batch instace수가 7안됨 pass

line 303 => train data수 13
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 11 acc_test 0.161885 f1_test 0.147071 acc_val 0.185668 f1_val 0.168771 acc_train 1.000000 f1_train 1.000000 psl_cor 2 psl_totl 4 pslt_global 0.700000  Tim 0:04:38
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 4] [0, 0, 0, 0, 0, 0, 2]
psl_acc:  0.5 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.5]
train batch instace수가 7안됨 pass

line 303 => train data수 28
line 258 => 인스턴스 수 4
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 13 acc_test 0.155738 f1_test 0.144385 acc_val 0.198697 f1_val 0.179563 acc_train 1.000000 f1_train 1.000000 psl_cor 4 psl_totl 15 pslt_global 0.700000  Tim 0:05:02
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 15] [0, 0, 0, 0, 0, 0, 4]
psl_acc:  0.267 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.2666666805744171]

line 303 => train data수 103
line 258 => 인스턴스 수 15
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 17 acc_test 0.079918 f1_test 0.082742 acc_val 0.159609 f1_val 0.139524 acc_train 1.000000 f1_train 1.000000 psl_cor 30 psl_totl 94 pslt_global 0.700000  Tim 0:05:26
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [14, 1, 0, 0, 0, 0, 79] [11, 0, 0, 0, 0, 0, 19]
psl_acc:  0.319 cw_psl_acc:  [0.7857142686843872, 0.0, nan, nan, nan, nan, 0.2405063360929489]
train batch instace수가 7안됨 pass

line 303 => train data수 574
line 258 => 인스턴스 수 82
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 32 acc_test 0.069672 f1_test 0.037644 acc_val 0.140065 f1_val 0.068844 acc_train 0.820557 f1_train 0.630656 psl_cor 173 psl_totl 577 pslt_global 0.700000  Tim 0:05:54
acc_train_cw [1.0, 0.549, 0.267, 0.4, 0.231, 0.486, 1.0]
cw_psl_eval:  [165, 139, 14, 5, 12, 36, 206] [85, 29, 4, 2, 2, 12, 39]
psl_acc:  0.3 cw_psl_acc:  [0.5151515007019043, 0.20863309502601624, 0.2857142984867096, 0.4000000059604645, 0.1666666716337204, 0.3333333432674408, 0.1893203854560852]
**bs에 맞지않음!!!!!**


line 303 => train data수 2736
line 258 => 인스턴스 수 391
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 114 acc_test 0.149590 f1_test 0.079070 acc_val 0.107492 f1_val 0.088273 acc_train 0.947368 f1_train 0.755635 psl_cor 655 psl_totl 2728 pslt_global 0.700000  Tim 0:06:37
acc_train_cw [0.957, 0.987, 0.542, 0.667, 0.2, 0.523, 0.932]
cw_psl_eval:  [868, 1137, 16, 2, 0, 44, 661] [317, 200, 5, 1, 0, 19, 113]
psl_acc:  0.24 cw_psl_acc:  [0.36520737409591675, 0.17590150237083435, 0.3125, 0.5, nan, 0.4318181872367859, 0.17095309495925903]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3702
line 258 => 인스턴스 수 529
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 505 acc_test 0.135246 f1_test 0.072812 acc_val 0.100977 f1_val 0.080376 acc_train 0.975689 f1_train 0.626682 psl_cor 830 psl_totl 3696 pslt_global 0.700000  Tim 0:07:53
acc_train_cw [0.979, 0.982, 0.6, 0.0, 0.0, 0.882, 0.972]
cw_psl_eval:  [1184, 1743, 0, 1, 0, 34, 734] [399, 278, 0, 0, 0, 23, 130]
psl_acc:  0.225 cw_psl_acc:  [0.3369932472705841, 0.15949513018131256, nan, 0.0, nan, 0.6764705777168274, 0.17711171507835388]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3867
line 258 => 인스턴스 수 553
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 1034 acc_test 0.141393 f1_test 0.077880 acc_val 0.104235 f1_val 0.082070 acc_train 0.973623 f1_train 0.789620 psl_cor 848 psl_totl 3851 pslt_global 0.700000  Tim 0:09:23
acc_train_cw [0.976, 0.97, 0.8, 1.0, 0.0, 0.941, 0.985]
cw_psl_eval:  [1147, 1875, 3, 1, 0, 40, 785] [388, 300, 3, 0, 0, 26, 131]
psl_acc:  0.22 cw_psl_acc:  [0.3382737636566162, 0.1599999964237213, 1.0, 0.0, nan, 0.6499999761581421, 0.16687898337841034]
Early stopping trigger at step:  1034
Best model at step:  6
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  18 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:09:41 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_1e-05_0.7_10_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240329-152655/0/training_statistics.csv

Best_step:  6 
best_test_acc:  0.14344262295081966 
best_test_f1:  0.10569630351768737
Save best record in:  ./experiment/few_shot/log/20240329-152655/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
