current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_unixcoder-base_0.0001_0.8_10_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.168033 f1_test 0.111264 acc_val 0.179153 f1_val 0.119752 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.069672 f1_test 0.072829 acc_val 0.172638 f1_val 0.115141 acc_train 0.571429 f1_train 0.452381 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:32
acc_train_cw [1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.206967 f1_test 0.161286 acc_val 0.159609 f1_val 0.142145 acc_train 1.000000 f1_train 1.000000 psl_cor 9 psl_totl 28 pslt_global 0.800000  Tim 0:00:56
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 28] [0, 0, 0, 0, 0, 0, 9]
psl_acc:  0.321 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.3214285671710968]
**bs에 맞지않음!!!!!**


line 303 => train data수 1112
line 258 => 인스턴스 수 159
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 7 acc_test 0.028689 f1_test 0.021183 acc_val 0.175896 f1_val 0.136743 acc_train 0.780576 f1_train 0.601518 psl_cor 319 psl_totl 1119 pslt_global 0.800000  Tim 0:01:25
acc_train_cw [0.869, 0.453, 0.494, 0.537, 0.357, 0.224, 1.0]
cw_psl_eval:  [245, 174, 80, 54, 13, 57, 496] [154, 38, 13, 11, 2, 11, 90]
psl_acc:  0.285 cw_psl_acc:  [0.6285714507102966, 0.2183908075094223, 0.16249999403953552, 0.20370370149612427, 0.1538461595773697, 0.19298245012760162, 0.18145161867141724]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2525
line 258 => 인스턴스 수 361
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 166 acc_test 0.147541 f1_test 0.091731 acc_val 0.156352 f1_val 0.119187 acc_train 0.942574 f1_train 0.695494 psl_cor 624 psl_totl 2364 pslt_global 0.800000  Tim 0:02:14
acc_train_cw [0.979, 0.976, 0.345, 0.896, 0.0, 0.456, 0.996]
cw_psl_eval:  [628, 282, 11, 235, 0, 83, 1125] [306, 76, 3, 32, 0, 14, 193]
psl_acc:  0.264 cw_psl_acc:  [0.4872611463069916, 0.26950353384017944, 0.27272728085517883, 0.13617020845413208, nan, 0.16867469251155853, 0.1715555489063263]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3650
line 258 => 인스턴스 수 522
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 527 acc_test 0.145492 f1_test 0.098926 acc_val 0.162866 f1_val 0.119411 acc_train 0.972603 f1_train 0.672044 psl_cor 801 psl_totl 3627 pslt_global 0.800000  Tim 0:03:27
acc_train_cw [0.977, 0.978, 0.364, 0.979, 0.0, 0.17, 0.997]
cw_psl_eval:  [718, 1060, 3, 375, 0, 12, 1459] [329, 180, 1, 49, 0, 2, 240]
psl_acc:  0.221 cw_psl_acc:  [0.4582172632217407, 0.16981132328510284, 0.3333333432674408, 0.13066667318344116, nan, 0.1666666716337204, 0.16449622809886932]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3845
line 258 => 인스턴스 수 550
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 1049 acc_test 0.149590 f1_test 0.100722 acc_val 0.156352 f1_val 0.112937 acc_train 0.986736 f1_train 0.647322 psl_cor 814 psl_totl 3776 pslt_global 0.800000  Tim 0:04:56
acc_train_cw [0.988, 0.992, 0.4, 0.998, 0.0, 0.0, 0.988]
cw_psl_eval:  [766, 1195, 1, 463, 0, 0, 1351] [343, 184, 0, 55, 0, 0, 232]
psl_acc:  0.216 cw_psl_acc:  [0.44778066873550415, 0.15397489070892334, 0.0, 0.11879049986600876, nan, nan, 0.17172464728355408]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3883
line 258 => 인스턴스 수 555
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 1599 acc_test 0.153689 f1_test 0.104702 acc_val 0.156352 f1_val 0.115305 acc_train 0.989184 f1_train 0.566184 psl_cor 831 psl_totl 3884 pslt_global 0.800000  Tim 0:06:27
acc_train_cw [0.985, 0.988, 0.0, 0.993, 0.0, 0.0, 0.999]
cw_psl_eval:  [785, 1214, 0, 452, 0, 0, 1433] [348, 189, 0, 53, 0, 0, 241]
psl_acc:  0.214 cw_psl_acc:  [0.4433121085166931, 0.155683696269989, nan, 0.11725663393735886, nan, nan, 0.16817864775657654]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3899
line 258 => 인스턴스 수 557
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 2154 acc_test 0.122951 f1_test 0.085645 acc_val 0.169381 f1_val 0.131851 acc_train 0.959220 f1_train 0.544688 psl_cor 806 psl_totl 3838 pslt_global 0.800000  Tim 0:08:00
acc_train_cw [0.947, 0.954, 0.0, 0.909, 0.0, 0.0, 0.986]
cw_psl_eval:  [621, 1194, 0, 463, 0, 0, 1560] [321, 186, 0, 57, 0, 0, 242]
psl_acc:  0.21 cw_psl_acc:  [0.5169082283973694, 0.1557788997888565, nan, 0.12311015278100967, nan, nan, 0.15512821078300476]
**bs에 맞지않음!!!!!**


line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 2711 acc_test 0.221311 f1_test 0.094256 acc_val 0.078176 f1_val 0.084991 acc_train 0.752308 f1_train 0.322429 psl_cor 442 psl_totl 1840 pslt_global 0.800000  Tim 0:09:31
acc_train_cw [0.419, 0.991, 0.0, 0.0, 0.0, 0.0, 0.901]
cw_psl_eval:  [260, 227, 0, 0, 0, 0, 1353] [195, 28, 0, 0, 0, 0, 219]
psl_acc:  0.24 cw_psl_acc:  [0.75, 0.12334802001714706, nan, nan, nan, nan, 0.16186252236366272]
train batch instace수가 7안됨 pass

line 303 => train data수 3900
line 258 => 인스턴스 수 558
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 3269 acc_test 0.030738 f1_test 0.016688 acc_val 0.117264 f1_val 0.031075 acc_train 0.407436 f1_train 0.094538 psl_cor 28 psl_totl 186 pslt_global 0.800000  Tim 0:11:03
acc_train_cw [0.0, 0.047, 0.0, 0.0, 0.0, 0.0, 0.995]
cw_psl_eval:  [0, 48, 0, 0, 0, 0, 138] [0, 11, 0, 0, 0, 0, 17]
psl_acc:  0.151 cw_psl_acc:  [nan, 0.2291666716337204, nan, nan, nan, nan, 0.12318840622901917]
Early stopping trigger at step:  3269
Best model at step:  0
**조기종료됨**
종료된 epoch시점 :  12 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:11:21 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0001_0.8_10_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-020954/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.1680327868852459 
best_test_f1:  0.11126401329587658
Save best record in:  ./experiment/few_shot/log/20240330-020954/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
