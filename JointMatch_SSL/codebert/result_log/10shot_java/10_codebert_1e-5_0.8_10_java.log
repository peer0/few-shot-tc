current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codebert-base_1e-05_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  1e-05

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.096197 f1_test 0.031173 acc_val 0.089679 f1_val 0.033271 acc_train 0.114286 f1_train 0.032653 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.131991 f1_test 0.036566 acc_val 0.096447 f1_val 0.031301 acc_train 0.171429 f1_train 0.081062 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:41
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.127517 f1_test 0.106530 acc_val 0.181049 f1_val 0.110079 acc_train 0.300000 f1_train 0.186783 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:15
acc_train_cw [0.9, 0.0, 0.0, 0.0, 0.4, 0.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.183445 f1_test 0.096925 acc_val 0.194585 f1_val 0.100962 acc_train 0.400000 f1_train 0.322235 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:49
acc_train_cw [0.6, 0.0, 0.0, 0.0, 0.9, 0.6, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 40 acc_test 0.172260 f1_test 0.063558 acc_val 0.240271 f1_val 0.120658 acc_train 0.300000 f1_train 0.215745 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:24
acc_train_cw [0.5, 0.0, 0.0, 0.0, 0.9, 0.0, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 50 acc_test 0.093960 f1_test 0.106647 acc_val 0.160745 f1_val 0.128342 acc_train 0.428571 f1_train 0.417017 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:59
acc_train_cw [0.5, 0.1, 0.2, 0.4, 0.6, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 60 acc_test 0.082774 f1_test 0.084010 acc_val 0.214890 f1_val 0.160284 acc_train 0.414286 f1_train 0.368561 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:28
acc_train_cw [0.7, 0.1, 0.3, 0.7, 0.4, 0.0, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 70 acc_test 0.102908 f1_test 0.108233 acc_val 0.208122 f1_val 0.162182 acc_train 0.471429 f1_train 0.418312 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:57
acc_train_cw [0.7, 0.4, 0.0, 0.7, 0.5, 0.1, 0.9]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 80 acc_test 0.093960 f1_test 0.119450 acc_val 0.135364 f1_val 0.121581 acc_train 0.457143 f1_train 0.434379 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:26
acc_train_cw [0.8, 0.1, 0.6, 0.5, 0.3, 0.1, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 90 acc_test 0.161074 f1_test 0.172250 acc_val 0.211506 f1_val 0.165587 acc_train 0.642857 f1_train 0.626846 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:55
acc_train_cw [0.9, 0.3, 0.9, 0.7, 0.7, 0.3, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 100 acc_test 0.183445 f1_test 0.183040 acc_val 0.179357 f1_val 0.150372 acc_train 0.628571 f1_train 0.627512 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:24
acc_train_cw [0.9, 0.6, 0.5, 0.7, 0.6, 0.4, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 110 acc_test 0.147651 f1_test 0.166935 acc_val 0.167513 f1_val 0.145097 acc_train 0.700000 f1_train 0.686803 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:53
acc_train_cw [0.9, 0.4, 0.8, 0.8, 0.6, 0.4, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 71
line 258 => 인스턴스 수 11
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 120 acc_test 0.165548 f1_test 0.164286 acc_val 0.175973 f1_val 0.134451 acc_train 0.661972 f1_train 0.647901 psl_cor 0 psl_totl 1 pslt_global 0.800000  Tim 0:06:22
acc_train_cw [0.9, 0.3, 0.8, 0.7, 0.3, 0.6, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 104
line 258 => 인스턴스 수 15
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 131 acc_test 0.161074 f1_test 0.178951 acc_val 0.226734 f1_val 0.174988 acc_train 0.875000 f1_train 0.842155 psl_cor 25 psl_totl 33 pslt_global 0.800000  Tim 0:06:51
acc_train_cw [0.974, 0.7, 1.0, 0.7, 0.8, 0.714, 1.0]
cw_psl_eval:  [29, 0, 0, 0, 0, 4, 0] [23, 0, 0, 0, 0, 2, 0]
psl_acc:  0.758 cw_psl_acc:  [0.7931034564971924, nan, nan, nan, nan, 0.5, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 302
line 258 => 인스턴스 수 44
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 146 acc_test 0.183445 f1_test 0.194902 acc_val 0.241963 f1_val 0.177255 acc_train 0.907285 f1_train 0.711024 psl_cor 166 psl_totl 227 pslt_global 0.800000  Tim 0:07:22
acc_train_cw [0.991, 0.3, 0.9, 0.7, 0.9, 0.417, 1.0]
cw_psl_eval:  [212, 0, 0, 0, 0, 11, 4] [163, 0, 0, 0, 0, 2, 1]
psl_acc:  0.731 cw_psl_acc:  [0.7688679099082947, nan, nan, nan, nan, 0.1818181872367859, 0.25]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass

line 303 => train data수 554
line 258 => 인스턴스 수 80
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 190 acc_test 0.246085 f1_test 0.220329 acc_val 0.206430 f1_val 0.145210 acc_train 0.956679 f1_train 0.785916 psl_cor 265 psl_totl 472 pslt_global 0.800000  Tim 0:08:01
acc_train_cw [1.0, 0.6, 0.7, 0.167, 0.8, 0.93, 1.0]
cw_psl_eval:  [377, 0, 0, 2, 0, 58, 35] [247, 0, 0, 1, 0, 10, 7]
psl_acc:  0.561 cw_psl_acc:  [0.6551724076271057, nan, nan, 0.5, nan, 0.17241379618644714, 0.20000000298023224]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2439
line 258 => 인스턴스 수 349
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 270 acc_test 0.277405 f1_test 0.161553 acc_val 0.118443 f1_val 0.089148 acc_train 0.913079 f1_train 0.675644 psl_cor 640 psl_totl 2364 pslt_global 0.800000  Tim 0:08:48
acc_train_cw [0.998, 0.368, 0.716, 0.0, 0.607, 0.975, 1.0]
cw_psl_eval:  [869, 28, 173, 0, 278, 413, 603] [374, 11, 27, 0, 46, 60, 122]
psl_acc:  0.271 cw_psl_acc:  [0.4303797483444214, 0.3928571343421936, 0.15606936812400818, nan, 0.16546761989593506, 0.1452784538269043, 0.20232172310352325]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3535
line 258 => 인스턴스 수 505
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 619 acc_test 0.284116 f1_test 0.183943 acc_val 0.089679 f1_val 0.064850 acc_train 0.932956 f1_train 0.664693 psl_cor 806 psl_totl 3396 pslt_global 0.800000  Tim 0:10:05
acc_train_cw [0.989, 0.071, 0.81, 0.0, 0.736, 0.944, 0.997]
cw_psl_eval:  [982, 0, 224, 0, 326, 992, 872] [397, 0, 32, 0, 54, 139, 184]
psl_acc:  0.237 cw_psl_acc:  [0.4042769968509674, nan, 0.1428571492433548, nan, 0.16564416885375977, 0.1401209682226181, 0.2110091745853424]
**bs에 맞지않음!!!!!**


line 303 => train data수 3739
line 258 => 인스턴스 수 535
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 1124 acc_test 0.290828 f1_test 0.182797 acc_val 0.098139 f1_val 0.070095 acc_train 0.939823 f1_train 0.653701 psl_cor 832 psl_totl 3569 pslt_global 0.800000  Tim 0:11:38
acc_train_cw [0.996, 0.0, 0.866, 0.0, 0.752, 0.946, 0.997]
cw_psl_eval:  [1037, 0, 220, 0, 391, 1057, 864] [409, 0, 38, 0, 63, 141, 181]
psl_acc:  0.233 cw_psl_acc:  [0.3944069445133209, nan, 0.17272727191448212, nan, 0.1611253172159195, 0.13339640200138092, 0.20949074625968933]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3816
line 258 => 인스턴스 수 546
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 1659 acc_test 0.275168 f1_test 0.186349 acc_val 0.118443 f1_val 0.089753 acc_train 0.939203 f1_train 0.661088 psl_cor 835 psl_totl 3533 pslt_global 0.800000  Tim 0:13:14
acc_train_cw [0.981, 0.0, 0.854, 0.0, 0.823, 0.966, 0.997]
cw_psl_eval:  [883, 0, 360, 0, 568, 868, 854] [380, 0, 57, 0, 101, 123, 174]
psl_acc:  0.236 cw_psl_acc:  [0.4303510785102844, nan, 0.15833333134651184, nan, 0.17781689763069153, 0.14170506596565247, 0.20374707877635956]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3829
line 258 => 인스턴스 수 547
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 2205 acc_test 0.252796 f1_test 0.172511 acc_val 0.116751 f1_val 0.085107 acc_train 0.938365 f1_train 0.663669 psl_cor 870 psl_totl 3579 pslt_global 0.800000  Tim 0:14:51
acc_train_cw [0.994, 0.0, 0.837, 0.0, 0.856, 0.937, 0.997]
cw_psl_eval:  [986, 0, 294, 0, 624, 799, 876] [407, 0, 49, 0, 122, 114, 178]
psl_acc:  0.243 cw_psl_acc:  [0.41277891397476196, nan, 0.1666666716337204, nan, 0.1955128163099289, 0.14267835021018982, 0.20319634675979614]
**bs에 맞지않음!!!!!**


line 303 => train data수 3836
line 258 => 인스턴스 수 548
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 2752 acc_test 0.288591 f1_test 0.188061 acc_val 0.121827 f1_val 0.093136 acc_train 0.953076 f1_train 0.674687 psl_cor 871 psl_totl 3614 pslt_global 0.800000  Tim 0:16:28
acc_train_cw [0.987, 0.0, 0.886, 0.0, 0.851, 0.987, 0.995]
cw_psl_eval:  [965, 0, 270, 0, 574, 975, 830] [408, 0, 48, 0, 108, 141, 166]
psl_acc:  0.241 cw_psl_acc:  [0.42279791831970215, nan, 0.17777778208255768, nan, 0.18815331161022186, 0.14461538195610046, 0.20000000298023224]
**bs에 맞지않음!!!!!**


line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 3300 acc_test 0.304251 f1_test 0.201510 acc_val 0.120135 f1_val 0.089341 acc_train 0.966119 f1_train 0.686883 psl_cor 889 psl_totl 3698 pslt_global 0.800000  Tim 0:18:06
acc_train_cw [0.997, 0.0, 0.922, 0.0, 0.901, 0.982, 0.997]
cw_psl_eval:  [991, 0, 256, 0, 612, 978, 861] [413, 0, 45, 0, 115, 141, 175]
psl_acc:  0.24 cw_psl_acc:  [0.4167507588863373, nan, 0.17578125, nan, 0.18790850043296814, 0.14417177438735962, 0.20325203239917755]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 3849 acc_test 0.272931 f1_test 0.186645 acc_val 0.128596 f1_val 0.093000 acc_train 0.978369 f1_train 0.697894 psl_cor 888 psl_totl 3674 pslt_global 0.800000  Tim 0:19:44
acc_train_cw [0.995, 0.0, 0.958, 0.0, 0.959, 0.985, 0.997]
cw_psl_eval:  [973, 0, 270, 0, 663, 904, 864] [412, 0, 47, 0, 125, 128, 176]
psl_acc:  0.242 cw_psl_acc:  [0.42343267798423767, nan, 0.17407406866550446, nan, 0.18853695690631866, 0.14159291982650757, 0.20370370149612427]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3838
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 4398 acc_test 0.275168 f1_test 0.190258 acc_val 0.133672 f1_val 0.095847 acc_train 0.980198 f1_train 0.725694 psl_cor 900 psl_totl 3720 pslt_global 0.800000  Tim 0:21:21
acc_train_cw [0.997, 0.0, 0.976, 0.1, 0.967, 0.977, 0.997]
cw_psl_eval:  [992, 0, 280, 0, 646, 923, 879] [411, 0, 48, 0, 127, 138, 176]
psl_acc:  0.242 cw_psl_acc:  [0.41431450843811035, nan, 0.17142857611179352, nan, 0.19659443199634552, 0.14951245486736298, 0.2002275288105011]
Early stopping trigger at step:  4398
Best model at step:  146
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  26 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:21:40 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codebert-base_1e-05_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-062959/0/training_statistics.csv

Best_step:  146 
best_test_acc:  0.18344519015659955 
best_test_f1:  0.19490158465158794
Save best record in:  ./experiment/few_shot/log/20240401-062959/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
