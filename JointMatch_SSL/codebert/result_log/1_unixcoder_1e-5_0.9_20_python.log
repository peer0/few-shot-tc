current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
python_extended_data
save_name: 1_unixcoder-base_1e-05_0.9_20_python_extended_data

data_path:  ../data/../data/problem_based_split/python_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3974
train_labeled_df samples: 7
train_unlabeled_df samples: 3967
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  1e-05

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.168033 f1_test 0.111264 acc_val 0.179153 f1_val 0.119752 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:07
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.170082 f1_test 0.117167 acc_val 0.182410 f1_val 0.113396 acc_train 0.285714 f1_train 0.190476 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:31
acc_train_cw [1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.151639 f1_test 0.103481 acc_val 0.214984 f1_val 0.129263 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:02
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.139344 f1_test 0.096358 acc_val 0.208469 f1_val 0.128695 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:33
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.122951 f1_test 0.083924 acc_val 0.208469 f1_val 0.132397 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:57
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.135246 f1_test 0.096721 acc_val 0.221498 f1_val 0.152082 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:21
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.143443 f1_test 0.105696 acc_val 0.237785 f1_val 0.177562 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:52
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.157787 f1_test 0.115817 acc_val 0.224756 f1_val 0.176654 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:03:22
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 8 acc_test 0.163934 f1_test 0.142628 acc_val 0.195440 f1_val 0.172773 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:03:46
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 9 acc_test 0.159836 f1_test 0.147181 acc_val 0.182410 f1_val 0.162581 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:04:10
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 10 acc_test 0.165984 f1_test 0.152850 acc_val 0.188925 f1_val 0.171501 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:04:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 11 acc_test 0.161885 f1_test 0.155002 acc_val 0.192182 f1_val 0.180738 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:04:58
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 12 acc_test 0.155738 f1_test 0.152027 acc_val 0.201954 f1_val 0.188202 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:05:22
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 13 acc_test 0.145492 f1_test 0.132711 acc_val 0.214984 f1_val 0.199614 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:05:46
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 10
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 14 acc_test 0.141393 f1_test 0.133292 acc_val 0.205212 f1_val 0.192798 acc_train 1.000000 f1_train 1.000000 psl_cor 1 psl_totl 3 pslt_global 0.900000  Tim 0:06:10
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3] [0, 0, 0, 0, 0, 0, 1]
psl_acc:  0.333 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.3333333432674408]
train batch instace수가 7안됨 pass

line 303 => train data수 11
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 16 acc_test 0.125000 f1_test 0.118721 acc_val 0.214984 f1_val 0.196323 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 2 pslt_global 0.900000  Tim 0:06:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 2] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 12
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 18 acc_test 0.114754 f1_test 0.111727 acc_val 0.221498 f1_val 0.196151 acc_train 1.000000 f1_train 1.000000 psl_cor 1 psl_totl 3 pslt_global 0.900000  Tim 0:06:58
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3] [0, 0, 0, 0, 0, 0, 1]
psl_acc:  0.333 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.3333333432674408]
train batch instace수가 7안됨 pass

line 303 => train data수 13
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 20 acc_test 0.112705 f1_test 0.112539 acc_val 0.211726 f1_val 0.195182 acc_train 1.000000 f1_train 1.000000 psl_cor 1 psl_totl 2 pslt_global 0.900000  Tim 0:07:22
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 2] [0, 0, 0, 0, 0, 0, 1]
psl_acc:  0.5 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.5]
train batch instace수가 7안됨 pass

line 303 => train data수 13
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 22 acc_test 0.100410 f1_test 0.101280 acc_val 0.224756 f1_val 0.203457 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:07:46
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 1, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, 0.0, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 13
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 24 acc_test 0.108607 f1_test 0.106405 acc_val 0.218241 f1_val 0.194135 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:08:10
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 1, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, 0.0, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 23
line 258 => 인스턴스 수 4
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 26 acc_test 0.104508 f1_test 0.103070 acc_val 0.198697 f1_val 0.174658 acc_train 1.000000 f1_train 1.000000 psl_cor 9 psl_totl 12 pslt_global 0.900000  Tim 0:08:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [6, 1, 0, 1, 0, 0, 4] [6, 0, 0, 1, 0, 0, 2]
psl_acc:  0.75 cw_psl_acc:  [1.0, 0.0, nan, 1.0, nan, nan, 0.5]
train batch instace수가 7안됨 pass

line 303 => train data수 76
line 258 => 인스턴스 수 11
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 30 acc_test 0.094262 f1_test 0.097977 acc_val 0.185668 f1_val 0.150175 acc_train 1.000000 f1_train 1.000000 psl_cor 36 psl_totl 63 pslt_global 0.900000  Tim 0:08:58
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [26, 4, 2, 2, 0, 2, 27] [23, 0, 2, 2, 0, 2, 7]
psl_acc:  0.571 cw_psl_acc:  [0.8846153616905212, 0.0, 1.0, 1.0, nan, 1.0, 0.25925925374031067]
train batch instace수가 7안됨 pass

line 303 => train data수 281
line 258 => 인스턴스 수 41
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 41 acc_test 0.086066 f1_test 0.054181 acc_val 0.123779 f1_val 0.072746 acc_train 0.964413 f1_train 0.931649 psl_cor 70 psl_totl 252 pslt_global 0.900000  Tim 0:09:24
acc_train_cw [1.0, 0.903, 0.824, 0.875, 0.923, 0.875, 1.0]
cw_psl_eval:  [11, 30, 16, 8, 12, 15, 160] [11, 6, 5, 2, 6, 10, 30]
psl_acc:  0.278 cw_psl_acc:  [1.0, 0.20000000298023224, 0.3125, 0.25, 0.5, 0.6666666865348816, 0.1875]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 809
line 258 => 인스턴스 수 116
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 82 acc_test 0.186475 f1_test 0.159444 acc_val 0.156352 f1_val 0.153686 acc_train 0.983931 f1_train 0.966401 psl_cor 232 psl_totl 759 pslt_global 0.900000  Tim 0:09:55
acc_train_cw [0.986, 1.0, 0.953, 1.0, 1.0, 0.889, 1.0]
cw_psl_eval:  [276, 4, 150, 13, 16, 10, 290] [129, 1, 32, 2, 11, 9, 48]
psl_acc:  0.306 cw_psl_acc:  [0.46739131212234497, 0.25, 0.2133333384990692, 0.1538461595773697, 0.6875, 0.8999999761581421, 0.16551724076271057]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2649
line 258 => 인스턴스 수 379
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 198 acc_test 0.129098 f1_test 0.121209 acc_val 0.224756 f1_val 0.169648 acc_train 0.929785 f1_train 0.862023 psl_cor 602 psl_totl 2672 pslt_global 0.900000  Tim 0:10:41
acc_train_cw [0.984, 0.722, 0.991, 0.667, 0.866, 0.617, 1.0]
cw_psl_eval:  [697, 413, 595, 29, 223, 44, 671] [210, 57, 140, 5, 48, 21, 121]
psl_acc:  0.225 cw_psl_acc:  [0.30129125714302063, 0.1380145251750946, 0.23529411852359772, 0.17241379618644714, 0.21524663269519806, 0.47727271914482117, 0.1803278625011444]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3239
line 258 => 인스턴스 수 463
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 26 Step 577 acc_test 0.170082 f1_test 0.151160 acc_val 0.159609 f1_val 0.143255 acc_train 0.935474 f1_train 0.864986 psl_cor 644 psl_totl 2922 pslt_global 0.900000  Tim 0:11:54
acc_train_cw [0.952, 0.994, 0.986, 0.565, 0.684, 0.576, 0.978]
cw_psl_eval:  [665, 545, 726, 28, 213, 39, 706] [209, 83, 173, 3, 31, 19, 126]
psl_acc:  0.22 cw_psl_acc:  [0.3142857253551483, 0.15229357779026031, 0.23829200863838196, 0.1071428582072258, 0.14553990960121155, 0.4871794879436493, 0.17847025394439697]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3537
line 258 => 인스턴스 수 506
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 27 Step 1040 acc_test 0.151639 f1_test 0.143292 acc_val 0.188925 f1_val 0.157776 acc_train 0.975120 f1_train 0.955476 psl_cor 695 psl_totl 3300 pslt_global 0.900000  Tim 0:13:16
acc_train_cw [0.992, 0.954, 0.992, 0.925, 0.965, 0.806, 0.987]
cw_psl_eval:  [726, 563, 734, 62, 437, 64, 714] [214, 92, 167, 6, 68, 24, 124]
psl_acc:  0.211 cw_psl_acc:  [0.294765830039978, 0.16341030597686768, 0.2275204360485077, 0.09677419066429138, 0.15560640394687653, 0.375, 0.1736694723367691]
Early stopping trigger at step:  1040
Best model at step:  6
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  28 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:13:33 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_1e-05_0.9_20_python_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240330-095501/0/training_statistics.csv

Best_step:  6 
best_test_acc:  0.14344262295081966 
best_test_f1:  0.10569630351768737
Save best record in:  ./experiment/few_shot/log/20240330-095501/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
