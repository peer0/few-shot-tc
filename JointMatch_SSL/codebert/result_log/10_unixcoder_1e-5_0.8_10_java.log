current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_unixcoder-base_1e-05_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  1e-05

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.100671 f1_test 0.069870 acc_val 0.297800 f1_val 0.187759 acc_train 0.128571 f1_train 0.099647 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.0, 0.2, 0.4, 0.1, 0.1, 0.0, 0.1]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.140940 f1_test 0.086473 acc_val 0.253807 f1_val 0.194548 acc_train 0.300000 f1_train 0.275181 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:40
acc_train_cw [0.4, 0.2, 0.1, 0.6, 0.4, 0.0, 0.4]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 20 acc_test 0.167785 f1_test 0.101704 acc_val 0.262267 f1_val 0.207775 acc_train 0.542857 f1_train 0.521654 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:08
acc_train_cw [0.6, 0.2, 0.8, 0.5, 0.8, 0.2, 0.7]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 30 acc_test 0.196868 f1_test 0.179587 acc_val 0.324873 f1_val 0.260859 acc_train 0.585714 f1_train 0.552873 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:36
acc_train_cw [0.7, 0.1, 0.8, 0.4, 0.9, 0.4, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 40 acc_test 0.194631 f1_test 0.192847 acc_val 0.431472 f1_val 0.327900 acc_train 0.714286 f1_train 0.715712 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:10
acc_train_cw [0.7, 0.7, 0.9, 0.7, 0.7, 0.5, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 78
line 258 => 인스턴스 수 12
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 50 acc_test 0.201342 f1_test 0.208451 acc_val 0.370558 f1_val 0.302885 acc_train 0.769231 f1_train 0.749238 psl_cor 6 psl_totl 8 pslt_global 0.800000  Tim 0:02:44
acc_train_cw [0.833, 0.4, 1.0, 0.8, 0.8, 0.5, 1.0]
cw_psl_eval:  [8, 0, 0, 0, 0, 0, 0] [6, 0, 0, 0, 0, 0, 0]
psl_acc:  0.75 cw_psl_acc:  [0.75, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 81
line 258 => 인스턴스 수 12
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 62 acc_test 0.230425 f1_test 0.223006 acc_val 0.385787 f1_val 0.271150 acc_train 0.888889 f1_train 0.875789 psl_cor 3 psl_totl 4 pslt_global 0.800000  Tim 0:03:13
acc_train_cw [1.0, 0.5, 1.0, 0.9, 0.8, 0.9, 1.0]
cw_psl_eval:  [3, 0, 1, 0, 0, 0, 0] [2, 0, 1, 0, 0, 0, 0]
psl_acc:  0.75 cw_psl_acc:  [0.6666666865348816, nan, 1.0, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 178
line 258 => 인스턴스 수 26
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 74 acc_test 0.250559 f1_test 0.232629 acc_val 0.411168 f1_val 0.315582 acc_train 0.960674 f1_train 0.922674 psl_cor 84 psl_totl 106 pslt_global 0.800000  Tim 0:03:42
acc_train_cw [1.0, 0.7, 1.0, 0.909, 0.9, 0.9, 0.938]
cw_psl_eval:  [99, 0, 0, 1, 0, 0, 6] [81, 0, 0, 1, 0, 0, 2]
psl_acc:  0.792 cw_psl_acc:  [0.8181818127632141, nan, nan, 1.0, nan, nan, 0.3333333432674408]
train batch instace수가 7안됨 pass

line 303 => train data수 415
line 258 => 인스턴스 수 60
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 100 acc_test 0.252796 f1_test 0.243455 acc_val 0.372250 f1_val 0.278561 acc_train 0.959036 f1_train 0.882472 psl_cor 231 psl_totl 336 pslt_global 0.800000  Tim 0:04:13
acc_train_cw [1.0, 0.48, 0.976, 0.958, 0.9, 0.917, 1.0]
cw_psl_eval:  [273, 15, 31, 14, 0, 2, 1] [201, 4, 14, 11, 0, 1, 0]
psl_acc:  0.688 cw_psl_acc:  [0.7362637519836426, 0.2666666805744171, 0.4516128897666931, 0.7857142686843872, nan, 0.5, 0.0]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2564
line 258 => 인스턴스 수 367
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 160 acc_test 0.212528 f1_test 0.168173 acc_val 0.331641 f1_val 0.218137 acc_train 0.882215 f1_train 0.824277 psl_cor 1014 psl_totl 2488 pslt_global 0.800000  Tim 0:04:57
acc_train_cw [0.999, 0.904, 0.956, 0.885, 0.587, 0.613, 0.787]
cw_psl_eval:  [742, 231, 439, 435, 36, 305, 300] [380, 52, 125, 240, 17, 62, 138]
psl_acc:  0.408 cw_psl_acc:  [0.5121293663978577, 0.22510822117328644, 0.28473803400993347, 0.5517241358757019, 0.4722222089767456, 0.20327869057655334, 0.46000000834465027]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3422
line 258 => 인스턴스 수 489
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 527 acc_test 0.232662 f1_test 0.207831 acc_val 0.390863 f1_val 0.250681 acc_train 0.912332 f1_train 0.868781 psl_cor 1198 psl_totl 3198 pslt_global 0.800000  Tim 0:06:15
acc_train_cw [0.991, 0.968, 0.996, 0.916, 0.606, 0.678, 0.842]
cw_psl_eval:  [892, 267, 690, 526, 44, 371, 408] [418, 56, 183, 277, 19, 74, 171]
psl_acc:  0.375 cw_psl_acc:  [0.46860986948013306, 0.20973782241344452, 0.2652173936367035, 0.5266159772872925, 0.4318181872367859, 0.1994609236717224, 0.41911765933036804]
train batch instace수가 7안됨 pass

line 303 => train data수 3713
line 258 => 인스턴스 수 531
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 1016 acc_test 0.230425 f1_test 0.182271 acc_val 0.328257 f1_val 0.220505 acc_train 0.933477 f1_train 0.905792 psl_cor 1287 psl_totl 3546 pslt_global 0.800000  Tim 0:07:45
acc_train_cw [0.997, 0.964, 0.965, 0.925, 0.758, 0.79, 0.921]
cw_psl_eval:  [1062, 241, 658, 569, 42, 520, 454] [465, 52, 178, 282, 21, 104, 185]
psl_acc:  0.363 cw_psl_acc:  [0.4378530979156494, 0.21576763689517975, 0.2705167233943939, 0.49560633301734924, 0.5, 0.20000000298023224, 0.40748897194862366]
train batch instace수가 7안됨 pass

line 303 => train data수 3778
line 258 => 인스턴스 수 540
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 1547 acc_test 0.272931 f1_test 0.224190 acc_val 0.340102 f1_val 0.232161 acc_train 0.961091 f1_train 0.947361 psl_cor 1281 psl_totl 3604 pslt_global 0.800000  Tim 0:09:19
acc_train_cw [0.998, 0.977, 0.99, 0.95, 0.875, 0.872, 0.973]
cw_psl_eval:  [1046, 255, 654, 521, 61, 632, 435] [457, 53, 176, 280, 26, 113, 176]
psl_acc:  0.355 cw_psl_acc:  [0.4369024932384491, 0.2078431397676468, 0.269113153219223, 0.5374280214309692, 0.4262295067310333, 0.17879746854305267, 0.4045976996421814]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3817
line 258 => 인스턴스 수 546
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 2087 acc_test 0.246085 f1_test 0.225986 acc_val 0.372250 f1_val 0.246394 acc_train 0.960440 f1_train 0.944828 psl_cor 1319 psl_totl 3654 pslt_global 0.800000  Tim 0:10:55
acc_train_cw [0.98, 0.981, 0.989, 0.96, 0.921, 0.878, 0.971]
cw_psl_eval:  [972, 252, 745, 562, 51, 591, 481] [450, 53, 205, 298, 20, 110, 183]
psl_acc:  0.361 cw_psl_acc:  [0.46296295523643494, 0.210317462682724, 0.2751677930355072, 0.5302491188049316, 0.3921568691730499, 0.18612521886825562, 0.3804573714733124]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3828
line 258 => 인스턴스 수 547
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 2633 acc_test 0.246085 f1_test 0.214176 acc_val 0.392555 f1_val 0.257682 acc_train 0.965256 f1_train 0.950232 psl_cor 1348 psl_totl 3676 pslt_global 0.800000  Tim 0:12:31
acc_train_cw [0.996, 0.984, 0.995, 0.97, 0.919, 0.849, 0.981]
cw_psl_eval:  [995, 251, 731, 578, 52, 552, 517] [456, 53, 209, 302, 23, 106, 199]
psl_acc:  0.367 cw_psl_acc:  [0.4582914710044861, 0.21115538477897644, 0.2859097123146057, 0.5224913358688354, 0.4423076808452606, 0.1920289844274521, 0.38491296768188477]
Early stopping trigger at step:  2633
Best model at step:  40
**조기종료됨**
종료된 epoch시점 :  16 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:12:49 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_unixcoder-base_1e-05_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-101051/0/training_statistics.csv

Best_step:  40 
best_test_acc:  0.19463087248322147 
best_test_f1:  0.19284720692054144
Save best record in:  ./experiment/few_shot/log/20240401-101051/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
