current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_unixcoder-base_0.0001_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.181208 f1_test 0.091400 acc_val 0.131980 f1_val 0.074635 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:10
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.176734 f1_test 0.120045 acc_val 0.079526 f1_val 0.066211 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:38
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.203579 f1_test 0.135949 acc_val 0.118443 f1_val 0.093103 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:06
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.190157 f1_test 0.136626 acc_val 0.221658 f1_val 0.162144 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.187919 f1_test 0.150641 acc_val 0.245347 f1_val 0.146563 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:09
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 40
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.230425 f1_test 0.180263 acc_val 0.219966 f1_val 0.148154 acc_train 1.000000 f1_train 1.000000 psl_cor 9 psl_totl 33 pslt_global 0.800000  Tim 0:02:45
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 33] [0, 0, 0, 0, 0, 0, 9]
psl_acc:  0.273 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.27272728085517883]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3165
line 258 => 인스턴스 수 453
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 11 acc_test 0.013423 f1_test 0.003810 acc_val 0.000000 f1_val 0.000000 acc_train 0.995893 f1_train 0.521834 psl_cor 446 psl_totl 3166 pslt_global 0.800000  Tim 0:03:27
acc_train_cw [0.417, 0.0, 0.5, 0.0, 0.25, 1.0, 1.0]
cw_psl_eval:  [11, 0, 1, 0, 3, 0, 3151] [2, 0, 0, 0, 0, 0, 444]
psl_acc:  0.141 cw_psl_acc:  [0.1818181872367859, nan, 0.0, nan, 0.0, nan, 0.1409076452255249]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 464 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:04:55
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 1013 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:06:32
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 1562 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:08:09
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 2111 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:09:46
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 2660 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:11:23
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 3209 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:13:00
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 3758 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:14:37
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 4307 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.998437 f1_train 0.142745 psl_cor 596 psl_totl 3844 pslt_global 0.800000  Tim 0:16:13
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 3844] [0, 0, 0, 0, 0, 0, 596]
psl_acc:  0.155 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.15504682064056396]
Early stopping trigger at step:  4307
Best model at step:  4
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  16 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:16:32 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0001_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240328-172356/0/training_statistics.csv

Best_step:  4 
best_test_acc:  0.18791946308724833 
best_test_f1:  0.1506413057626593
Save best record in:  ./experiment/few_shot/log/20240328-172356/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
