current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_unixcoder-base_0.0001_0.9_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/unixcoder-base
**tokenizer type =  microsoft/unixcoder-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/unixcoder-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.181208 f1_test 0.091400 acc_val 0.131980 f1_val 0.074635 acc_train 0.000000 f1_train 0.000000 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:10
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.176734 f1_test 0.120045 acc_val 0.079526 f1_val 0.066211 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:38
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.203579 f1_test 0.135949 acc_val 0.118443 f1_val 0.093103 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:06
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.190157 f1_test 0.136626 acc_val 0.221658 f1_val 0.162144 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:34
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.187919 f1_test 0.150641 acc_val 0.245347 f1_val 0.146563 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:10
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 15
line 258 => 인스턴스 수 3
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.230425 f1_test 0.180263 acc_val 0.219966 f1_val 0.148154 acc_train 1.000000 f1_train 1.000000 psl_cor 2 psl_totl 8 pslt_global 0.900000  Tim 0:02:45
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 8] [0, 0, 0, 0, 0, 0, 2]
psl_acc:  0.25 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.25]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 1256
line 258 => 인스턴스 수 180
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 8 acc_test 0.134228 f1_test 0.101114 acc_val 0.052453 f1_val 0.047679 acc_train 0.878185 f1_train 0.730837 psl_cor 267 psl_totl 1254 pslt_global 0.900000  Tim 0:03:19
acc_train_cw [0.911, 0.265, 0.4, 0.75, 0.894, 0.75, 1.0]
cw_psl_eval:  [403, 82, 14, 3, 400, 15, 337] [107, 10, 2, 1, 77, 0, 70]
psl_acc:  0.213 cw_psl_acc:  [0.2655086815357208, 0.12195122241973877, 0.1428571492433548, 0.3333333432674408, 0.19249999523162842, 0.0, 0.20771513879299164]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 2865
line 258 => 인스턴스 수 410
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 188 acc_test 0.266219 f1_test 0.183682 acc_val 0.216582 f1_val 0.143780 acc_train 0.960908 f1_train 0.751012 psl_cor 642 psl_totl 2712 pslt_global 0.900000  Tim 0:04:16
acc_train_cw [0.987, 0.75, 0.364, 0.0, 0.989, 0.947, 0.984]
cw_psl_eval:  [848, 236, 3, 0, 799, 35, 791] [318, 43, 0, 0, 146, 0, 135]
psl_acc:  0.237 cw_psl_acc:  [0.375, 0.18220339715480804, 0.0, nan, 0.18272840976715088, 0.0, 0.1706700325012207]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3083
line 258 => 인스턴스 수 441
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 598 acc_test 0.286353 f1_test 0.209472 acc_val 0.241963 f1_val 0.148408 acc_train 0.956536 f1_train 0.702809 psl_cor 611 psl_totl 2399 pslt_global 0.900000  Tim 0:05:37
acc_train_cw [0.968, 0.957, 0.091, 0.0, 0.93, 0.951, 0.985]
cw_psl_eval:  [698, 269, 0, 0, 616, 38, 778] [291, 61, 0, 0, 124, 0, 135]
psl_acc:  0.255 cw_psl_acc:  [0.4169054329395294, 0.22676579654216766, nan, nan, 0.20129869878292084, 0.0, 0.17352184653282166]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3545
line 258 => 인스턴스 수 507
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 1039 acc_test 0.286353 f1_test 0.196693 acc_val 0.240271 f1_val 0.150005 acc_train 0.971791 f1_train 0.832202 psl_cor 784 psl_totl 3350 pslt_global 0.900000  Tim 0:07:03
acc_train_cw [0.992, 0.879, 0.947, 0.0, 0.992, 1.0, 0.99]
cw_psl_eval:  [979, 555, 18, 0, 942, 50, 806] [350, 111, 2, 0, 182, 0, 139]
psl_acc:  0.234 cw_psl_acc:  [0.3575076460838318, 0.20000000298023224, 0.1111111119389534, nan, 0.19320593774318695, 0.0, 0.17245657742023468]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3742
line 258 => 인스턴스 수 535
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 1546 acc_test 0.286353 f1_test 0.199058 acc_val 0.192893 f1_val 0.118104 acc_train 0.954837 f1_train 0.801964 psl_cor 780 psl_totl 3515 pslt_global 0.900000  Tim 0:08:36
acc_train_cw [0.997, 0.811, 0.75, 0.0, 0.979, 0.961, 0.988]
cw_psl_eval:  [1104, 578, 17, 0, 918, 50, 848] [382, 90, 2, 0, 168, 1, 137]
psl_acc:  0.222 cw_psl_acc:  [0.34601449966430664, 0.15570934116840363, 0.11764705926179886, nan, 0.18300653994083405, 0.019999999552965164, 0.16155660152435303]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3797
line 258 => 인스턴스 수 543
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 2081 acc_test 0.272931 f1_test 0.182161 acc_val 0.230118 f1_val 0.140952 acc_train 0.963129 f1_train 0.829292 psl_cor 796 psl_totl 3575 pslt_global 0.900000  Tim 0:10:12
acc_train_cw [0.995, 0.835, 1.0, 0.0, 0.992, 1.0, 0.977]
cw_psl_eval:  [1165, 528, 21, 0, 1030, 49, 782] [379, 102, 2, 0, 182, 1, 130]
psl_acc:  0.223 cw_psl_acc:  [0.32532188296318054, 0.1931818127632141, 0.095238097012043, nan, 0.17669902741909027, 0.020408162847161293, 0.1662404090166092]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3810
line 258 => 인스턴스 수 545
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 2624 acc_test 0.286353 f1_test 0.196547 acc_val 0.248731 f1_val 0.148166 acc_train 0.956693 f1_train 0.814745 psl_cor 808 psl_totl 3589 pslt_global 0.900000  Tim 0:11:49
acc_train_cw [0.994, 0.759, 0.909, 0.0, 0.999, 0.961, 0.988]
cw_psl_eval:  [1149, 463, 19, 0, 1068, 48, 842] [385, 86, 2, 0, 195, 1, 139]
psl_acc:  0.225 cw_psl_acc:  [0.33507397770881653, 0.18574513494968414, 0.10526315867900848, nan, 0.1825842708349228, 0.02083333395421505, 0.1650831401348114]
Save model to ./experiment/few_shot/output/
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3829
line 258 => 인스턴스 수 547
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 3169 acc_test 0.255034 f1_test 0.182227 acc_val 0.221658 f1_val 0.137094 acc_train 0.987464 f1_train 0.983273 psl_cor 812 psl_totl 3669 pslt_global 0.900000  Tim 0:13:34
acc_train_cw [0.997, 0.949, 0.889, 1.0, 0.993, 1.0, 0.995]
cw_psl_eval:  [1146, 578, 12, 0, 1025, 50, 858] [374, 101, 2, 0, 191, 1, 143]
psl_acc:  0.221 cw_psl_acc:  [0.3263525366783142, 0.1747404783964157, 0.1666666716337204, nan, 0.18634146451950073, 0.019999999552965164, 0.1666666716337204]
**bs에 맞지않음!!!!!**


line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 3716 acc_test 0.212528 f1_test 0.156088 acc_val 0.164129 f1_val 0.099492 acc_train 0.965859 f1_train 0.973452 psl_cor 752 psl_totl 3530 pslt_global 0.900000  Tim 0:15:12
acc_train_cw [0.995, 0.955, 1.0, 1.0, 0.898, 0.98, 0.995]
cw_psl_eval:  [1156, 833, 18, 0, 616, 50, 857] [378, 115, 2, 0, 113, 1, 143]
psl_acc:  0.213 cw_psl_acc:  [0.32698962092399597, 0.138055220246315, 0.1111111119389534, nan, 0.18344156444072723, 0.019999999552965164, 0.1668611466884613]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 4265 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:16:49
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 4814 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:18:26
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 5363 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:20:05
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 5912 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:21:42
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 6461 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:23:18
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 7010 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:24:55
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 7559 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:26:32
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3837
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 8108 acc_test 0.134228 f1_test 0.033812 acc_val 0.098139 f1_val 0.035747 acc_train 0.323430 f1_train 0.070128 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:28:08
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 1] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, nan, nan, nan, 0.0]
Early stopping trigger at step:  8108
Best model at step:  2624
**조기종료됨**
종료된 epoch시점 :  24 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:28:26 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_unixcoder-base_0.0001_0.9_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240329-050738/0/training_statistics.csv

Best_step:  2624 
best_test_acc:  0.28635346756152125 
best_test_f1:  0.19654738647661515
Save best record in:  ./experiment/few_shot/log/20240329-050738/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
