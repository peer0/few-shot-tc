current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 5_codebert-base_1e-05_0.9_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  5
train_df samples: 3851
train_labeled_df samples: 35
train_unlabeled_df samples: 3816
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  1e-05

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.042506 f1_test 0.011649 acc_val 0.206430 f1_val 0.068443 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 5 acc_test 0.042506 f1_test 0.011750 acc_val 0.206430 f1_val 0.068539 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:00:40
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 10 acc_test 0.042506 f1_test 0.014679 acc_val 0.209814 f1_val 0.088413 acc_train 0.142857 f1_train 0.038610 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:08
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 15 acc_test 0.042506 f1_test 0.011776 acc_val 0.201354 f1_val 0.067614 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:01:42
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 20 acc_test 0.069351 f1_test 0.043364 acc_val 0.243655 f1_val 0.127158 acc_train 0.171429 f1_train 0.087302 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:11
acc_train_cw [0.0, 0.0, 0.0, 1.0, 0.2, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 25 acc_test 0.073826 f1_test 0.048160 acc_val 0.209814 f1_val 0.114528 acc_train 0.285714 f1_train 0.179107 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:02:45
acc_train_cw [0.0, 0.0, 0.0, 0.8, 0.6, 0.0, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 30 acc_test 0.031320 f1_test 0.040103 acc_val 0.020305 f1_val 0.021309 acc_train 0.228571 f1_train 0.171269 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:03:14
acc_train_cw [0.0, 0.0, 0.0, 0.2, 0.2, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 35 acc_test 0.055928 f1_test 0.047421 acc_val 0.054146 f1_val 0.046891 acc_train 0.285714 f1_train 0.224490 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:03:43
acc_train_cw [0.4, 0.0, 0.0, 0.0, 0.4, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 40 acc_test 0.062640 f1_test 0.065079 acc_val 0.108291 f1_val 0.112439 acc_train 0.428571 f1_train 0.415835 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:04:11
acc_train_cw [0.6, 0.4, 0.2, 0.0, 0.6, 0.2, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 45 acc_test 0.100671 f1_test 0.077873 acc_val 0.162437 f1_val 0.141588 acc_train 0.571429 f1_train 0.586495 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:04:40
acc_train_cw [0.6, 0.6, 0.6, 0.4, 0.8, 0.2, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 50 acc_test 0.109620 f1_test 0.102145 acc_val 0.111675 f1_val 0.102863 acc_train 0.628571 f1_train 0.637260 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:05:09
acc_train_cw [0.8, 0.6, 0.8, 0.4, 0.6, 0.4, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 55 acc_test 0.098434 f1_test 0.096681 acc_val 0.143824 f1_val 0.120620 acc_train 0.685714 f1_train 0.688095 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:05:37
acc_train_cw [0.8, 0.8, 0.6, 0.8, 0.8, 0.4, 0.6]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 60 acc_test 0.114094 f1_test 0.099162 acc_val 0.137056 f1_val 0.113099 acc_train 0.571429 f1_train 0.570212 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:06:06
acc_train_cw [0.8, 0.6, 0.4, 0.8, 0.8, 0.4, 0.2]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 65 acc_test 0.107383 f1_test 0.089855 acc_val 0.118443 f1_val 0.095991 acc_train 0.657143 f1_train 0.665463 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:06:35
acc_train_cw [0.8, 0.8, 0.4, 0.6, 0.6, 0.6, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 70 acc_test 0.102908 f1_test 0.092098 acc_val 0.103215 f1_val 0.083723 acc_train 0.742857 f1_train 0.747364 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:07:03
acc_train_cw [0.8, 1.0, 0.6, 0.6, 0.8, 0.6, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 75 acc_test 0.111857 f1_test 0.097475 acc_val 0.125212 f1_val 0.101984 acc_train 0.800000 f1_train 0.803469 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:07:32
acc_train_cw [0.8, 1.0, 0.8, 0.6, 0.8, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 80 acc_test 0.125280 f1_test 0.110476 acc_val 0.152284 f1_val 0.131676 acc_train 0.885714 f1_train 0.885426 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:08:01
acc_train_cw [1.0, 0.8, 1.0, 1.0, 0.8, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 85 acc_test 0.125280 f1_test 0.111778 acc_val 0.179357 f1_val 0.146612 acc_train 0.885714 f1_train 0.890842 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:08:30
acc_train_cw [1.0, 0.8, 1.0, 1.0, 0.8, 0.8, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 90 acc_test 0.129754 f1_test 0.119114 acc_val 0.167513 f1_val 0.133952 acc_train 0.942857 f1_train 0.942569 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:08:58
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 95 acc_test 0.129754 f1_test 0.118085 acc_val 0.196277 f1_val 0.155930 acc_train 0.942857 f1_train 0.942569 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:09:27
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 100 acc_test 0.172260 f1_test 0.143203 acc_val 0.218274 f1_val 0.169538 acc_train 0.914286 f1_train 0.913997 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:09:56
acc_train_cw [1.0, 1.0, 0.8, 1.0, 0.8, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 35
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 105 acc_test 0.149888 f1_test 0.132664 acc_val 0.199662 f1_val 0.161935 acc_train 0.914286 f1_train 0.913997 psl_cor 0 psl_totl 0 pslt_global 0.900000  Tim 0:10:25
acc_train_cw [1.0, 1.0, 0.8, 1.0, 0.8, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 36
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 110 acc_test 0.143177 f1_test 0.118106 acc_val 0.197970 f1_val 0.163139 acc_train 0.944444 f1_train 0.942569 psl_cor 1 psl_totl 1 pslt_global 0.900000  Tim 0:10:53
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 0.8]
cw_psl_eval:  [1, 0, 0, 0, 0, 0, 0] [1, 0, 0, 0, 0, 0, 0]
psl_acc:  1.0 cw_psl_acc:  [1.0, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 38
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 116 acc_test 0.158837 f1_test 0.142400 acc_val 0.209814 f1_val 0.166299 acc_train 0.973684 f1_train 0.971140 psl_cor 0 psl_totl 2 pslt_global 0.900000  Tim 0:11:22
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 2, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 38
line 258 => 인스턴스 수 6
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 122 acc_test 0.161074 f1_test 0.143423 acc_val 0.197970 f1_val 0.157729 acc_train 0.947368 f1_train 0.946032 psl_cor 0 psl_totl 1 pslt_global 0.900000  Tim 0:11:51
acc_train_cw [1.0, 1.0, 1.0, 1.0, 0.8, 1.0, 0.8]
cw_psl_eval:  [0, 0, 0, 1, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, nan, 0.0, nan, nan, nan]
Early stopping trigger at step:  122
Best model at step:  20
**조기종료됨**
종료된 epoch시점 :  26 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:12:09 (h:mm:ss)
Load model from ./experiment/few_shot/output/5_codebert-base_1e-05_0.9_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240403-105651/0/training_statistics.csv

Best_step:  20 
best_test_acc:  0.06935123042505593 
best_test_f1:  0.04336400747249706
Save best record in:  ./experiment/few_shot/log/20240403-105651/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
