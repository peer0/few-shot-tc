current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_codet5p-110m-embedding_0.0001_0.8_10_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  Salesforce/codet5p-110m-embedding
**tokenizer type =  Salesforce/codet5p-110m-embedding 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  Salesforce/codet5p-110m-embedding lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.013423 f1_test 0.003801 acc_val 0.001692 f1_val 0.002688 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:12
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.026846 f1_test 0.025156 acc_val 0.065990 f1_val 0.045481 acc_train 0.857143 f1_train 0.809524 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:00:41
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.058166 f1_test 0.064365 acc_val 0.049069 f1_val 0.056261 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:17
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.102908 f1_test 0.103396 acc_val 0.138748 f1_val 0.098785 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:01:46
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.123043 f1_test 0.120250 acc_val 0.167513 f1_val 0.103653 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:22
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.125280 f1_test 0.113683 acc_val 0.167513 f1_val 0.107726 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:57
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.123043 f1_test 0.115161 acc_val 0.162437 f1_val 0.109721 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:26
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.120805 f1_test 0.109766 acc_val 0.155668 f1_val 0.108952 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:03:56
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 8 acc_test 0.123043 f1_test 0.108800 acc_val 0.150592 f1_val 0.109833 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:25
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 9 acc_test 0.143177 f1_test 0.123322 acc_val 0.147208 f1_val 0.108024 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:04:54
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 10 acc_test 0.143177 f1_test 0.122359 acc_val 0.155668 f1_val 0.114059 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:23
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 11 acc_test 0.154362 f1_test 0.130534 acc_val 0.157360 f1_val 0.116035 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:05:52
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 12 acc_test 0.152125 f1_test 0.128552 acc_val 0.155668 f1_val 0.115346 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:06:21
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 13 acc_test 0.158837 f1_test 0.136679 acc_val 0.165821 f1_val 0.124240 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:06:50
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 14 acc_test 0.161074 f1_test 0.137388 acc_val 0.174281 f1_val 0.130326 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:07:19
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 15 acc_test 0.154362 f1_test 0.129206 acc_val 0.170897 f1_val 0.126920 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:07:55
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 16 acc_test 0.154362 f1_test 0.128947 acc_val 0.167513 f1_val 0.121950 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:08:24
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 17 acc_test 0.154362 f1_test 0.129164 acc_val 0.165821 f1_val 0.119896 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:08:53
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 18 acc_test 0.152125 f1_test 0.127312 acc_val 0.169205 f1_val 0.121370 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:09:22
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 19 acc_test 0.154362 f1_test 0.128792 acc_val 0.164129 f1_val 0.117482 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:09:51
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 20 acc_test 0.152125 f1_test 0.127748 acc_val 0.165821 f1_val 0.118996 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:10:21
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 21 acc_test 0.149888 f1_test 0.126199 acc_val 0.165821 f1_val 0.119800 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:10:50
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 22 acc_test 0.152125 f1_test 0.128431 acc_val 0.167513 f1_val 0.120272 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:11:19
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 24 Step 23 acc_test 0.154362 f1_test 0.130943 acc_val 0.162437 f1_val 0.115690 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:11:48
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 25 Step 24 acc_test 0.154362 f1_test 0.132051 acc_val 0.164129 f1_val 0.116489 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:12:17
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Early stopping trigger at step:  24
Best model at step:  14
**조기종료됨**
종료된 epoch시점 :  26 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:12:35 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codet5p-110m-embedding_0.0001_0.8_10_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240328-214837/0/training_statistics.csv

Best_step:  14 
best_test_acc:  0.1610738255033557 
best_test_f1:  0.1373878376365097
Save best record in:  ./experiment/few_shot/log/20240328-214837/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
