current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 1_codebert-base_0.0001_0.7_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  1
train_df samples: 3851
train_labeled_df samples: 7
train_unlabeled_df samples: 3844
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0001

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.136465 f1_test 0.040425 acc_val 0.098139 f1_val 0.038512 acc_train 0.142857 f1_train 0.035714 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 1 acc_test 0.194631 f1_test 0.055116 acc_val 0.250423 f1_val 0.077817 acc_train 0.428571 f1_train 0.333333 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:00:39
acc_train_cw [0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 2 acc_test 0.225951 f1_test 0.075210 acc_val 0.260575 f1_val 0.067987 acc_train 0.428571 f1_train 0.333333 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:15
acc_train_cw [0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 3 acc_test 0.172260 f1_test 0.113943 acc_val 0.203046 f1_val 0.159603 acc_train 0.428571 f1_train 0.285714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:01:51
acc_train_cw [0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 4 acc_test 0.060403 f1_test 0.049614 acc_val 0.213198 f1_val 0.087477 acc_train 0.571429 f1_train 0.485714 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:19
acc_train_cw [0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 5 acc_test 0.131991 f1_test 0.114880 acc_val 0.203046 f1_val 0.143542 acc_train 0.714286 f1_train 0.642857 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:02:49
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 6 acc_test 0.098434 f1_test 0.091475 acc_val 0.123519 f1_val 0.097635 acc_train 0.714286 f1_train 0.642857 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:17
acc_train_cw [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 7
line 258 => 인스턴스 수 1
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 7 acc_test 0.085011 f1_test 0.093688 acc_val 0.184433 f1_val 0.133488 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:03:46
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]

line 303 => train data수 8
line 258 => 인스턴스 수 2
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 8 acc_test 0.140940 f1_test 0.119721 acc_val 0.153976 f1_val 0.117591 acc_train 1.000000 f1_train 1.000000 psl_cor 0 psl_totl 1 pslt_global 0.700000  Tim 0:04:14
acc_train_cw [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 1, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc:  0.0 cw_psl_acc:  [nan, nan, 0.0, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 31
line 258 => 인스턴스 수 5
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 10 acc_test 0.140940 f1_test 0.114944 acc_val 0.150592 f1_val 0.110134 acc_train 0.967742 f1_train 0.904762 psl_cor 1 psl_totl 23 pslt_global 0.700000  Tim 0:04:43
acc_train_cw [1.0, 1.0, 1.0, 0.5, 1.0, 1.0, 1.0]
cw_psl_eval:  [0, 0, 5, 1, 0, 0, 17] [0, 0, 0, 0, 0, 0, 1]
psl_acc:  0.043 cw_psl_acc:  [nan, nan, 0.0, 0.0, nan, nan, 0.05882352963089943]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 1520
line 258 => 인스턴스 수 218
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 15 acc_test 0.098434 f1_test 0.103491 acc_val 0.191201 f1_val 0.146593 acc_train 0.860526 f1_train 0.726064 psl_cor 320 psl_totl 1518 pslt_global 0.700000  Tim 0:05:19
acc_train_cw [0.842, 0.607, 0.789, 0.862, 0.84, 0.288, 1.0]
cw_psl_eval:  [220, 27, 270, 85, 378, 51, 487] [78, 11, 35, 14, 82, 11, 89]
psl_acc:  0.211 cw_psl_acc:  [0.3545454442501068, 0.40740740299224854, 0.12962962687015533, 0.16470588743686676, 0.21693122386932373, 0.21568627655506134, 0.18275153636932373]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3710
line 258 => 인스턴스 수 530
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 233 acc_test 0.170022 f1_test 0.145559 acc_val 0.182741 f1_val 0.129904 acc_train 0.970889 f1_train 0.777688 psl_cor 766 psl_totl 3700 pslt_global 0.700000  Tim 0:06:25
acc_train_cw [0.963, 0.0, 0.972, 0.896, 0.992, 0.625, 0.995]
cw_psl_eval:  [457, 0, 1366, 297, 798, 21, 761] [213, 0, 228, 40, 144, 2, 139]
psl_acc:  0.207 cw_psl_acc:  [0.4660831391811371, nan, 0.16691069304943085, 0.1346801370382309, 0.18045112490653992, 0.095238097012043, 0.18265439569950104]
**bs에 맞지않음!!!!!**


line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 763 acc_test 0.194631 f1_test 0.131985 acc_val 0.189509 f1_val 0.129584 acc_train 0.807229 f1_train 0.487027 psl_cor 447 psl_totl 1822 pslt_global 0.700000  Tim 0:08:01
acc_train_cw [0.97, 0.0, 1.0, 0.0, 0.976, 0.0, 0.478]
cw_psl_eval:  [452, 0, 245, 0, 743, 0, 382] [210, 0, 40, 0, 136, 0, 61]
psl_acc:  0.245 cw_psl_acc:  [0.4646017551422119, nan, 0.16326530277729034, nan, 0.18304172158241272, nan, 0.1596858650445938]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 1297 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.391968 f1_train 0.080455 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:09:37
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 1831 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.391968 f1_train 0.080455 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:11:13
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 2365 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.391968 f1_train 0.080455 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:12:49
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 2899 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.394110 f1_train 0.080770 psl_cor 3 psl_totl 12 pslt_global 0.700000  Tim 0:14:25
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 12, 0, 0, 0, 0] [0, 0, 3, 0, 0, 0, 0]
psl_acc:  0.25 cw_psl_acc:  [nan, nan, 0.25, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 3433 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.394110 f1_train 0.080770 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:16:01
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 3967 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.394110 f1_train 0.080770 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:17:37
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 4501 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.394110 f1_train 0.080770 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:19:13
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 5035 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.394110 f1_train 0.080770 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:20:49
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 22 Step 5569 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.394110 f1_train 0.080770 psl_cor 0 psl_totl 0 pslt_global 0.700000  Tim 0:22:25
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 3735
line 258 => 인스턴스 수 534
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 23 Step 6103 acc_test 0.154362 f1_test 0.038206 acc_val 0.211506 f1_val 0.069832 acc_train 0.393842 f1_train 0.080731 psl_cor 2 psl_totl 5 pslt_global 0.700000  Tim 0:24:01
acc_train_cw [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 5, 0, 0] [0, 0, 0, 0, 2, 0, 0]
psl_acc:  0.4 cw_psl_acc:  [nan, nan, nan, nan, 0.4000000059604645, nan, nan]
Early stopping trigger at step:  6103
Best model at step:  2
**조기종료됨**
종료된 epoch시점 :  24 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:24:19 (h:mm:ss)
Load model from ./experiment/few_shot/output/1_codebert-base_0.0001_0.7_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240327-233311/0/training_statistics.csv

Best_step:  2 
best_test_acc:  0.22595078299776286 
best_test_f1:  0.07520986831029607
Save best record in:  ./experiment/few_shot/log/20240327-233311/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
