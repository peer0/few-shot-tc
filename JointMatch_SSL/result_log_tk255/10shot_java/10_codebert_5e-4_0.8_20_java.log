current work directory:  /home/imsuhan22/few-shot-tc/JointMatch_SSL/codebert/code
java_extended_data
save_name: 10_codebert-base_0.0005_0.8_20_java_extended_data

data_path:  ../data/../data/problem_based_split/java_extended_data

There are 1 GPU(s) available.
We will use the GPU- 0 NVIDIA GeForce RTX 3090

**line 147 모델 =>  microsoft/codebert-base
**tokenizer type =  microsoft/codebert-base 

n_labeled_per_class:  10
train_df samples: 3851
train_labeled_df samples: 70
train_unlabeled_df samples: 3781
n_classes:  7 

net_arch:  microsoft/codebert-base lr:  0.0005

line 303 => train data수 70
line 258 => 인스턴스 수 10
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 1 Step 0 acc_test 0.096197 f1_test 0.031173 acc_val 0.089679 f1_val 0.033271 acc_train 0.114286 f1_train 0.032653 psl_cor 0 psl_totl 0 pslt_global 0.000000  Tim 0:00:11
acc_train_cw [0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
Save model to ./experiment/few_shot/output/

line 303 => train data수 100
line 258 => 인스턴스 수 15
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 2 Step 10 acc_test 0.013423 f1_test 0.003784 acc_val 0.000000 f1_val 0.000000 acc_train 0.100000 f1_train 0.025974 psl_cor 2 psl_totl 30 pslt_global 0.800000  Tim 0:00:40
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 30, 0] [0, 0, 0, 0, 0, 2, 0]
psl_acc:  0.067 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.06666667014360428, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 106
line 258 => 인스턴스 수 16
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 3 Step 25 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.433962 f1_train 0.086466 psl_cor 1 psl_totl 6 pslt_global 0.800000  Tim 0:01:10
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 6, 0] [0, 0, 0, 0, 0, 1, 0]
psl_acc:  0.167 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.1666666716337204, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 141
line 258 => 인스턴스 수 21
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 4 Step 41 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.574468 f1_train 0.104247 psl_cor 5 psl_totl 36 pslt_global 0.800000  Tim 0:01:40
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 36, 0] [0, 0, 0, 0, 0, 5, 0]
psl_acc:  0.139 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.1388888955116272, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 141
line 258 => 인스턴스 수 21
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 5 Step 62 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.574468 f1_train 0.104247 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:10
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 141
line 258 => 인스턴스 수 21
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 6 Step 83 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.574468 f1_train 0.104247 psl_cor 0 psl_totl 0 pslt_global 0.800000  Tim 0:02:40
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 0, 0] [0, 0, 0, 0, 0, 0, 0]
psl_acc: None cw_psl_acc:  [nan, nan, nan, nan, nan, nan, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 183
line 258 => 인스턴스 수 27
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 7 Step 104 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.672131 f1_train 0.114846 psl_cor 4 psl_totl 43 pslt_global 0.800000  Tim 0:03:11
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 43, 0] [0, 0, 0, 0, 0, 4, 0]
psl_acc:  0.093 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.09302325546741486, nan]
train batch instace수가 7안됨 pass

line 303 => train data수 476
line 258 => 인스턴스 수 68
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 8 Step 131 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.873950 f1_train 0.133248 psl_cor 43 psl_totl 308 pslt_global 0.800000  Tim 0:03:44
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 308, 0] [0, 0, 0, 0, 0, 43, 0]
psl_acc:  0.14 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.1396103948354721, nan]
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 9 Step 199 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:04:35
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 10 Step 748 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:06:13
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 11 Step 1297 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:07:50
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 12 Step 1846 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:09:28
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 13 Step 2395 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:11:05
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 14 Step 2944 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:12:42
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 15 Step 3493 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:14:20
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 16 Step 4042 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:15:57
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 17 Step 4591 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:17:34
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 18 Step 5140 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:19:12
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 19 Step 5689 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:20:49
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 20 Step 6238 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:22:26
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
train batch instace수가 7안됨 pass
**bs에 맞지않음!!!!!**


line 303 => train data수 3839
line 258 => 인스턴스 수 549
=======test_loader=======
=======dev_loader=======
=======train_labeled_loader=======
=======finish=======
>>Epoch 21 Step 6787 acc_test 0.366890 f1_test 0.076689 acc_val 0.000000 f1_val 0.000000 acc_train 0.984371 f1_train 0.141732 psl_cor 422 psl_totl 3781 pslt_global 0.800000  Tim 0:24:03
acc_train_cw [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
cw_psl_eval:  [0, 0, 0, 0, 0, 3781, 0] [0, 0, 0, 0, 0, 422, 0]
psl_acc:  0.112 cw_psl_acc:  [nan, nan, nan, nan, nan, 0.11161068826913834, nan]
Early stopping trigger at step:  6787
Best model at step:  0
**조기종료됨**
**bs에 맞지않음!!!!!**

종료된 epoch시점 :  22 (epoch - 11에서부터 acc_val증가 안됨.)
조기종료 early_stop_flag 

Training complete!
Total training took 0:24:22 (h:mm:ss)
Load model from ./experiment/few_shot/output/10_codebert-base_0.0005_0.8_20_java_extended_data_net0.pth
Save training statistics in:  ./experiment/few_shot/log/20240401-090532/0/training_statistics.csv

Best_step:  0 
best_test_acc:  0.09619686800894854 
best_test_f1:  0.031173466136183613
Save best record in:  ./experiment/few_shot/log/20240401-090532/summary.csv
Save best record in:  ./experiment/few_shot/log/summary_avgrun.csv
